import{_ as e}from"./V-Avatar.vue_vue&type=script&setup=true&lang.d100ee36.js";import{_ as s}from"./V-Card.vue_vue&type=script&setup=true&lang.e9e64dc2.js";import{_ as t}from"./inputsLayaut.vue_vue&type=style&index=0&lang.fe67fad1.js";import{_ as l}from"./V-Button.vue_vue&type=script&setup=true&lang.cc6d2b95.js";import{_ as a}from"./V-Loader.vue_vue&type=script&setup=true&lang.069747cb.js";import{g as n,a as i,p as o,m as u,n as c,b as r}from"./index.87399e1f.js";import{g as d}from"./Discounts.6e06db82.js";import{g as m}from"./Staffs.2ee44a7d.js";import{a as p,f as v}from"./Companies.9594921e.js";import{g as b}from"./Diciplines.e995ff10.js";import{u as _,c as f,p as y,a as h,h as g,b as x,d as k,i as Y,e as D,s as C,f as j,j as M,r as O,k as z,l as A,m as P,n as L,o as V,g as w}from"./Subscriptions.509ffd29.js";import{d as R,r as q,o as N,h as S,i as E,B as I,k as T,l as H,G as U,b as $,F as B,W as G,X,H as F,K,R as W,_ as J,w as Q,P as Z,S as ee,A as se,L as te}from"./vendor.4454b83d.js";import{_ as le}from"./V-SwitchBlock.vue_vue&type=script&setup=true&lang.32bcd9b0.js";import{_ as ae}from"./V-Control.63a8a239.js";import{_ as ne}from"./V-Field.vue_vue&type=script&setup=true&lang.b3ed284d.js";import{_ as ie,a as oe,b as ue,c as ce}from"./subscription-method-payment-posnet.vue_vue&type=script&setup=true&lang.da6c57bc.js";import{_ as re}from"./V-Modal.vue_vue&type=script&setup=true&lang.ef7028a7.js";import{_ as de}from"./Presupuesto.vue_vue&type=script&setup=true&lang.90cab0e0.js";import{a as me,g as pe}from"./MemberCards.2191dcb7.js";import{e as ve}from"./Members.0df3f64c.js";const be=U("Save");var _e=R({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:u}){const c=e,r=q(!1),f=q(!1),y=q([{typeInput:"checkboxGroupSimpleEventInput",name:"locations",placeholder:"Locations access",text:"Locations access",required:!0,values:[],model:"",disabled:!1,class:"is-12",isLabel:!0,change:function(e,s){b(this.model).then((e=>{e.data.length&&i(s,"diciplines",e.data)}))},click:function(){}},{typeInput:"DropdownCheckbox",name:"diciplines",text:"Disciplines",placeholder:"Disciplines",required:!1,model:[],values:[],disabled:!1,class:"is-12",isLabel:!0,drop:!1},{typeInput:"selectDataActionChangeInput",name:"discount",placeholder:"Discount",values:[],data:null,model:"",disabled:!1,class:"is-12",isLabel:!0},{typeInput:"DropdownCheckbox",name:"staff_id",placeholder:"Trainer",values:[],model:[],disabled:!1,required:!1,class:"is-12",isLabel:!0,drop:!1},{typeInput:"date",typeInputDefault:"date",name:"fecha_vencimiento",placeholder:"Next payment date",model:"",class:"is-6",isLabel:!0,required:!0},{name:"payment_type_id",typeInput:"selectData",placeholder:"Payment Type",model:"",required:!0,values:[{id:1,name:"Cash"},{id:3,name:"Debit automatic"}],class:"is-6",isLabel:!0,filterOptionText:function(e){return e.name}}]);N((()=>{(async()=>{f.value=!0,n(y.value,"fecha_vencimiento").model=I(c.suscripcion.estado.fecha_vencimiento,"YYYY-MM-DD").format("YYYY-MM-DD"),n(y.value,"payment_type_id").model=c.suscripcion.payment_type_id,c.suscripcion.memberships_members&&c.suscripcion.memberships_members.diciplines.length&&(n(y.value,"diciplines").model=c.suscripcion.memberships_members.diciplines.map((e=>e.diciplines_id))),c.suscripcion.member&&c.suscripcion.member.trainers.length&&(n(y.value,"staff_id").model=c.suscripcion.member.trainers.map((e=>e.staffs_id))),c.suscripcion.discount&&(n(y.value,"discount").model=c.suscripcion.discount.id),await p().then((e=>{if(i(y,"locations",v.value),c.suscripcion&&c.suscripcion.memberships_members&&c.suscripcion.memberships_members.locaciones.length){const e=c.suscripcion.memberships_members.locaciones.map((e=>e.companies_locations_id));n(y.value,"locations").model=e,b(e).then((e=>{e.data.length&&i(y,"diciplines",e.data)}))}})),await d().then((e=>{i(y,"discount",e.data.discounts)})),await m().then((e=>{i(y,"staff_id",e.data)})),f.value=!1})()}));const h=async()=>{const e=o(y.value);r.value=!0,await _(c.suscripcion.id,e).then((e=>{r.value=!1,u("reload")}))};return(e,n)=>{const i=t,o=l,u=a,c=s;return S(),E(u,{class:"h-100",size:"small",active:f.value},{default:T((()=>[H(c,{class:""},{default:T((()=>[H(i,{"inputs-step":y.value},null,8,["inputs-step"]),H(u,{class:"h-100",size:"small",active:r.value},{default:T((()=>[H(o,{color:"primary",onClick:h,size:"small"},{default:T((()=>[be])),_:1})])),_:1},8,["active"])])),_:1})])),_:1},8,["active"])}}});const fe=H("p",null,[H("b",null,"Cancel Suscription")],-1);var ye=R({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const l=e,n=q(!1),i=()=>{n.value=!0,f(l.suscripcion.id,{}).then((e=>{n.value=!1,t("reload")})).catch((e=>{n.value=!1}))};return N((()=>{})),(e,t)=>{const l=s,o=a;return S(),E(o,{class:"h-100",size:"small",active:n.value},{default:T((()=>[H(l,{color:"danger",outlined:"",onClick:i,class:"\r\n        mr-4\r\n        btn-card\r\n        text-center\r\n        px-2\r\n        h-100\r\n        d-flex\r\n        align-items-center\r\n        justify-content-center\r\n      ",style:{"font-size":"14px"}},{default:T((()=>[fe])),_:1})])),_:1},8,["active"])}}});const he={key:0},ge={key:1},xe=H("small",null,"by default it will be scheduled for the next payment",-1),ke={class:"columns is-multiline"},Ye={class:"column is-4"},De=H("p",{class:"title is-6 mb-1"},[H("b",null,"Total")],-1),Ce={class:"title is-3 mb-0"},je={class:"is-4 column mx-auto"},Me={class:"is-4 column mx-auto"};var Oe=R({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const l=e,n=q(!0),i=q(!1),o=(e=null)=>{i.value=!0,e&&(e.isProrrateo=n.value),y(l.suscripcion.id,e).then((e=>{i.value=!1,r.value=!1,c.success("Success"),t("reload")})).catch((e=>{console.log(e),c.error("Error"),i.value=!1,r.value=!1}))},r=q(!1),d=()=>{r.value=!1},m=$((()=>l.suscripcion.memberships_members.multigym));$((()=>l.suscripcion.presupuesto));const p=$((()=>l.suscripcion.user)),v=q(0),b=()=>{m.value?(n.value=!1,o()):(h(l.suscripcion.id,{}).then((e=>{v.value=e.data})),n.value=!0,r.value=!0)};return(e,t)=>{const l=s,c=le,_=ae,f=ne,y=a,h=ie,g=oe,x=re;return S(),E(y,{class:"h-100",size:"small",active:i.value},{default:T((()=>[H(l,{color:"info",outlined:!B(m),onClick:b,class:"\n        mr-4\n        btn-card\n        text-center\n        px-2\n        h-100\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:T((()=>[H("p",null,[B(m)?(S(),E("b",ge,"Disable MultiGym ")):(S(),E("b",he,"Activate MultiGym "))])])),_:1},8,["outlined"]),H(x,{open:r.value,size:"big",actions:"center",onClose:d},{content:T((()=>[H(f,null,{default:T((()=>[H(_,null,{default:T((()=>[H(c,{modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=e=>n.value=e),label:"Make the prorated charge",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1}),G(H("p",null,[xe],512),[[X,!n.value]]),n.value?(S(),E(l,{key:0,style:{"margin-bottom":"24px"}},{default:T((()=>[H("div",ke,[H("div",Ye,[H(y,{size:"small",class:"h-100",active:i.value},{default:T((()=>[H(l,{class:"mb-4 h-100"},{default:T((()=>[H("div",null,[De,H("p",Ce,F(B(u)(v.value)),1)])])),_:1})])),_:1},8,["active"])]),H("div",je,[H(y,{size:"small",active:i.value},{default:T((()=>[H(h,{total:v.value,user:B(p),onOnPayment:o},null,8,["total","user"])])),_:1},8,["active"])]),H("div",Me,[H(y,{size:"small",active:i.value},{default:T((()=>[H(g,{total:v.value,onOnPayment:o},null,8,["total"])])),_:1},8,["active"])])])])),_:1})):K("",!0)])),action:T((()=>[])),_:1},8,["open"])])),_:1},8,["active"])}}});const ze=H("p",null,[H("b",null,"HOLD Membership")],-1),Ae={key:0},Pe=U("Active until: "),Le=H("br",null,null,-1),Ve=H("label",{for:"hold_date_start"},[H("p",null,"Hold date start")],-1),we=H("label",{for:"hold_date_end"},[H("p",null,"Hold date end")],-1),Re=U("Confirm");var qe=R({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const n=e,i=q(!1),o=q(!1),u=q(I(n.suscripcion.hold_date_start).format("YYYY-MM-DD")),r=q(I(n.suscripcion.hold_date_end).format("YYYY-MM-DD")),d=()=>{g(n.suscripcion.id,{hold_date_start:u.value,hold_date_end:r.value}).then((e=>{o.value=!1,c.success("success"),t("reload")})).catch((e=>{o.value=!1}))},m=$((()=>n.suscripcion.isHold));return N((()=>{})),(e,t)=>{const c=s,p=a,v=l,b=re;return S(),E(W,null,[H(p,{size:"small",class:"h-100",active:i.value},{default:T((()=>[H(c,{color:"warning",outlined:null==n.suscripcion.hold_date_end,onClick:t[1]||(t[1]=e=>B(m)?d():o.value=!0),class:"\r\n        mr-4\r\n        btn-card\r\n        text-center\r\n        h-100\r\n        px-2\r\n        d-flex\r\n        align-items-center\r\n        justify-content-center\r\n      ",style:{"font-size":"14px"}},{default:T((()=>[ze,H("p",null,[null!=n.suscripcion.hold_date_end?(S(),E("span",Ae,[Pe,Le,U(" "+F(B(I)(n.suscripcion.hold_date_start).format("MM/DD/YYYY"))+" - "+F(B(I)(n.suscripcion.hold_date_end).format("MM/DD/YYYY")),1)])):K("",!0)])])),_:1},8,["outlined"])])),_:1},8,["active"]),H(b,{open:o.value,actions:"center",onClose:t[4]||(t[4]=e=>o.value=!1)},{content:T((()=>[Ve,G(H("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=e=>u.value=e),class:"input mt-2 mb-4"},null,512),[[J,u.value]]),we,G(H("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=e=>r.value=e),class:"input mt-2 mb-4"},null,512),[[J,r.value]])])),action:T((()=>[H(v,{onClick:d,color:"primary",raised:""},{default:T((()=>[Re])),_:1})])),_:1},8,["open"])],64)}}});const Ne={class:"columns is-multiline"},Se={class:"title is-4"},Ee={class:"title is-5 text-left mt-2"},Ie={class:"d-flex justify-content-end mb-4"},Te={key:0},He={key:1},Ue=U("Accept and continue ");var $e=R({expose:[],props:{suscripcion:{type:Object,default:{}},is_config:{type:Boolean,default:!0},is_recurrence:{type:Boolean,default:!0},restar:{type:Number,default:{text:"",amount:""}},amounts_not_ids:{type:Array,default:[]}},emits:["update:modelValue","reload","onReady","changeMembership"],setup(e,{emit:o}){const r=e;Z();const d=q([]),m=q(!0),p=q(!1),v=q(!1);N((()=>{y.value=!0,x().then((e=>{d.value=e.data})),k(1,"membership").then((e=>{i(Y,"discount",e.data.discounts)}))}));const b=$((()=>{const e=d.value.find((e=>e.id==C.memberships_id));return null==e?void 0:e.amounts.filter((e=>e.is_recurrence==m.value&&null!=e.recurrencia))})),_=$((()=>{for(var e in C)null!=n(Y.value,e)&&(C[e]=n(Y.value,e).model);return C})),f=()=>{D.value=null,v.value=!1,p.value=!0,y.value=!0,j(_.value).then((e=>{D.value=e.data,o("update:modelValue",D.value),y.value=!0,setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight||document.documentElement.scrollHeight),p.value=!1}),300)})).catch((e=>{const s=e.response.data;for(var t in p.value=!1,s)if("object"==typeof s[t]&&"object"==typeof s[t])for(var l in s[t])c.error(s[t][l])}))},y=q(!0),h=()=>{v.value=!0;let e=_.value;o("onReady",e),y.value=!1};return Q((()=>C.memberships_id),(()=>{D.value=null,o("changeMembership")})),(e,n)=>{const i=s,o=a,v=le,_=ae,g=ne,x=t,k=l,j=de;return S(),E(W,null,[H(i,{class:"mb-4"},{default:T((()=>[H(o,{size:"large",active:!d.value.length},{default:T((()=>[H("div",Ne,[(S(!0),E(W,null,ee(d.value,((e,s)=>(S(),E("div",{key:`membership-${s}`,class:"column is-4 btn btn-card",onClick:s=>B(C).memberships_id=e.id},[H(i,{color:B(C).memberships_id==e.id?"primary":void 0,class:"h-100"},{default:T((()=>[H("div",null,[H("h1",Se,F(e.name),1)])])),_:2},1032,["color"])],8,["onClick"])))),128))])])),_:1},8,["active"])])),_:1}),H(i,{class:"mb-4"},{default:T((()=>[H("div",null,[r.is_recurrence?(S(),E(g,{key:0},{default:T((()=>[H(_,null,{default:T((()=>[H(v,{modelValue:m.value,"onUpdate:modelValue":n[1]||(n[1]=e=>m.value=e),label:"Recurring Subscription",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1})):K("",!0),(S(!0),E(W,null,ee(B(b),((e,s)=>(S(),E("div",{key:`membership-precios-${s}`,class:"btn btn-card",onClick:s=>(e=>{r.amounts_not_ids.includes(e.id)?c.error("Select a membership with a higher price than the current one"):C.recurrences_id=e.id})(e)},[H(i,{color:B(C).recurrences_id==e.id?"primary":void 0,class:"mb-3 py-4"},{default:T((()=>[H("p",null,F(e.recurrencia.descriptions),1),H("p",Ee,F(B(u)(e.amount)),1)])),_:2},1032,["color"])],8,["onClick"])))),128))])])),_:1}),r.is_config?(S(),E(i,{key:0,class:""},{default:T((()=>[H(x,{"inputs-step":B(Y)},null,8,["inputs-step"])])),_:1})):K("",!0),H("div",Ie,[H(o,{size:"large",active:p.value},{default:T((()=>[H(k,{onClick:f,color:B(D)?void 0:"primary",class:"d-flex justify-content-center mt-6 py-5 w-100",style:{"text-align":"center","text-transform":"uppercase","font-size":"20px","font-weight":"900"}},{default:T((()=>[B(D)?(S(),E("span",He," restart")):(S(),E("span",Te,"start subscription"))])),_:1},8,["color"])])),_:1},8,["active"])]),B(D)?(S(),E(i,{key:1,class:"mb-4"},{default:T((()=>[H(j,{presupuesto:B(D),restar:r.restar},null,8,["presupuesto","restar"])])),_:1})):K("",!0),B(D)&&y.value?(S(),E(k,{key:2,onClick:h,color:"primary",class:"d-flex justify-content-center py-5 px-6 ml-auto",style:{"text-align":"center","text-transform":"uppercase","font-size":"20px","font-weight":"900"}},{default:T((()=>[Ue])),_:1})):K("",!0)],64)}}});const Be={class:"columns is-multiline"},Ge={class:"column is-4"},Xe=H("p",{class:"title is-6 mb-1"},[H("b",null,"Total")],-1),Fe={class:"title is-3 mb-0"},Ke={key:0,class:"is-4 column mx-auto"},We={key:1,class:"is-4 column mx-auto"};var Je=R({expose:[],props:{suscripcion:{type:Object,required:!0},amount:{type:Number,default:0},methods:{type:Array,default:[]},isLoaderActive:{type:Boolean,default:!1}},emits:["onPayment"],setup(e,{emit:t}){const l=e,n=$((()=>l.suscripcion.user)),i=(e=null)=>{t("onPayment",e)};return(t,o)=>{const c=s,r=a,d=ie,m=oe;return S(),E(c,{style:{"margin-bottom":"24px"}},{default:T((()=>[H("div",Be,[H("div",Ge,[H(r,{size:"small",class:"h-100",active:e.isLoaderActive},{default:T((()=>[H(c,{class:"mb-4 h-100"},{default:T((()=>[H("div",null,[Xe,H("p",Fe,F(B(u)(l.amount)),1)])])),_:1})])),_:1},8,["active"])]),l.methods.includes("debit_automatic")?(S(),E("div",Ke,[H(r,{size:"small",active:e.isLoaderActive},{default:T((()=>[H(d,{total:e.amount,user:B(n),onOnPayment:i},null,8,["total","user"])])),_:1},8,["active"])])):K("",!0),l.methods.includes("cash")?(S(),E("div",We,[H(r,{size:"small",active:e.isLoaderActive},{default:T((()=>[H(m,{total:e.amount,onOnPayment:i},null,8,["total"])])),_:1},8,["active"])])):K("",!0)])])),_:1})}}});const Qe=H("p",null,[H("b",null,"Upgrade Subscription")],-1),Ze={class:"title is-7 mb-2"},es=H("p",{class:"title is-7 mb-2"},"Remaining Amount",-1),ss={class:"title is-3"};var ts=R({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const l=e,a=q(!1),n=se({next_payment_date:"",amount:0,amounts_not_ids:[]}),i=()=>{o.value=!0,M(l.suscripcion.id).then((e=>{n.next_payment_date=e.data.next_payment_date,n.amount=e.data.amount,n.amounts_not_ids=e.data.amounts_not_ids})).catch((e=>{}))};N((()=>{}));const o=q(!1),c=()=>{o.value=!1},r=q(null),d=e=>{r.value=e,console.log("ready",e),p.value=!0},m=q(null),p=q(!1),v=$((()=>{let e=m.value.total;return e-=n.amount,e<-0&&(e=0),e}));Q((()=>m.value),(e=>{p.value=!1})),Q(o,(e=>{console.log("cambia",e),O()}));const b=()=>{p.value=!1},_=e=>{const s=Object.assign({},e,r.value);a.value=!0,z(l.suscripcion.id,s).then((e=>{a.value=!1,c(),t("reload")})).catch((e=>{a.value=!1}))};return(e,t)=>{const r=s,f=$e,y=Je,h=re;return S(),E(W,null,[H(r,{color:"primary",outlined:"",onClick:i,class:"\n      mr-4\n      btn-card\n      text-center\n      px-2\n      h-100\n      d-flex\n      align-items-center\n      justify-content-center\n    ",style:{"font-size":"14px"}},{default:T((()=>[Qe])),_:1}),H(h,{open:o.value,size:"big",actions:"center",onClose:c},{content:T((()=>[H("div",null,[H(r,{class:"mb-4"},{default:T((()=>[H("p",Ze," Next payment date: "+F(B(I)(B(n).next_payment_date,"MM-DD-YYYY").format("MM-DD-YYYY")),1),es,H("p",ss,F(B(u)(B(n).amount)),1)])),_:1}),H(f,{onOnReady:d,modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),onChangeMembership:b,is_config:!1,is_recurrence:!1,restar:{text:"Remaining Amount",amount:B(n).amount},amounts_not_ids:B(n).amounts_not_ids,class:"mb-4"},null,8,["modelValue","restar","amounts_not_ids"]),p.value?(S(),E(y,{key:0,methods:["debit_automatic","cash","terminal"],suscripcion:l.suscripcion,amount:B(v),"is-loader-active":a.value,onOnPayment:_,class:"mt-4"},null,8,["suscripcion","amount","is-loader-active"])):K("",!0)])])),action:T((()=>[])),_:1},8,["open"])],64)}}});const ls=H("p",null,[H("b",null," Balances ")],-1),as={class:"columns"},ns={class:"column is-4"},is=H("p",{class:"title is-6 mb-1"},[H("b",null,"Total")],-1),os={class:"title is-3 mb-0"},us=H("label",{for:""},[H("p",null,"Amount")],-1),cs={class:"columns is-multiline"},rs={class:"column is-4"},ds=H("p",{class:"title is-6 mb-1"},[H("b",null,"Total")],-1),ms={class:"title is-3 mb-0"},ps={class:"is-4 column mx-auto"},vs={class:"is-4 column mx-auto"},bs={class:"table is-hoverable is-fullwidth"},_s=H("thead",null,[H("tr",null,[H("th",{scope:"col"},"Amount"),H("th",{scope:"col"},"Date")])],-1);var fs=R({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const l=e,n=q(null),i=q(!1),o=(e=null)=>{i.value=!0,e.amount=n.value,console.log(e),me(m.value.id,e).then((e=>{i.value=!1,r.value=!1,c.success("Success"),t("reload")})).catch((e=>{e=e.response.data,i.value=!1,r.value=!1}))},r=q(!1),d=()=>{r.value=!1},m=$((()=>l.suscripcion.user)),p=q(0),v=q([]),b=()=>{pe(m.value.id).then((e=>{p.value=e.data.saldo,v.value=e.data.saldos,r.value=!0}))};return(e,t)=>{const l=s,c=a,_=ae,f=ne,y=ie,h=oe,g=re;return S(),E(c,{class:"h-100",size:"small",active:i.value},{default:T((()=>[H(l,{color:"info",outlined:!0,onClick:b,class:"\n        mr-4\n        btn-card\n        text-center\n        px-2\n        h-100\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:T((()=>[ls])),_:1}),H(g,{open:r.value,size:"big",actions:"center",onClose:d},{content:T((()=>[H("div",as,[H("div",ns,[H(c,{size:"small",class:"h-100",active:i.value},{default:T((()=>[H(l,{class:"mb-4 h-100"},{default:T((()=>[H("div",null,[is,H("p",os,F(B(u)(p.value)),1)])])),_:1})])),_:1},8,["active"])]),H(f,{class:"is-8 column"},{default:T((()=>[H(_,{style:{height:"100%"}},{default:T((()=>[us,G(H("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=e=>n.value=e),class:"input mt-4",placeholder:"0.00",style:{height:"60%","font-size":"20px"}},null,512),[[J,n.value]])])),_:1})])),_:1})]),H(l,{style:{"margin-bottom":"24px"}},{default:T((()=>[H("div",cs,[H("div",rs,[H(c,{size:"small",class:"h-100",active:i.value},{default:T((()=>[H(l,{class:"mb-4 h-100"},{default:T((()=>[H("div",null,[ds,H("p",ms,F(B(u)(n.value)),1)])])),_:1})])),_:1},8,["active"])]),H("div",ps,[H(c,{size:"small",active:i.value},{default:T((()=>[H(y,{total:n.value,user:B(m),onOnPayment:o},null,8,["total","user"])])),_:1},8,["active"])]),H("div",vs,[H(c,{size:"small",active:i.value},{default:T((()=>[H(h,{total:n.value,onOnPayment:o},null,8,["total"])])),_:1},8,["active"])])])])),_:1}),H(l,null,{default:T((()=>[H("table",bs,[_s,H("tbody",null,[(S(!0),E(W,null,ee(v.value,((e,s)=>(S(),E("tr",{key:`saldo-${s}`},[H("td",null,F(B(u)(e.monto)),1),H("td",null,F(B(I)(e.created_at).format("MM-DD-YYYY")),1)])))),128))])])])),_:1})])),action:T((()=>[])),_:1},8,["open"])])),_:1},8,["active"])}}});const ys=H("p",null,[H("b",null," Invoices ")],-1),hs=H("p",{class:"title is-5"},"Invoices",-1),gs={class:"table is-hoverable is-fullwidth"},xs=H("thead",null,[H("tr",{class:"has-background-grey-dark"},[H("th",{scope:"col"},"ID"),H("th",{scope:"col"},"Amount"),H("th",{scope:"col"},"Date"),H("th",{scope:"col"},"Payment Type")])],-1);var ks=R({expose:[],props:{suscripcion:{type:Object,required:!0}},setup(e){const t=e,l=q(!1),n=q(!1),i=()=>{l.value=!1},o=$((()=>t.suscripcion.memberships_members&&t.suscripcion.memberships_members.payments?t.suscripcion.memberships_members.payments:[]));return q(null),(e,t)=>{const u=s,c=re,r=a;return S(),E(r,{class:"h-100",size:"small",active:n.value},{default:T((()=>[H(u,{color:"orange",outlined:!0,onClick:t[1]||(t[1]=e=>l.value=!0),class:"\n        mr-4\n        btn-card\n        text-center\n        px-2\n        h-100\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:T((()=>[ys])),_:1}),H(c,{open:l.value,size:"big",actions:"center",onClose:i},{content:T((()=>[H("div",null,[hs,H("table",gs,[xs,(S(!0),E(W,null,ee(B(o),((e,s)=>(S(),E("tbody",{key:`incoide-${s}`},[H("tr",null,[H("td",null,[H("p",null,F(e.id),1)]),H("td",null,[H("p",null,F(e.amount),1)]),H("td",null,[H("p",null,F(e.created_ad),1)]),H("td",null,[H("p",null,F(e.payment_type.name),1)])]),(S(!0),E(W,null,ee(e.items,((e,s)=>(S(),E("tr",{key:`item-${s}`},[H("td",null,F(e.description)+" "+F(e.type),1),H("td",null,F(e.amount),1)])))),128))])))),128))])])])),action:T((()=>[])),_:1},8,["open"])])),_:1},8,["active"])}}});const Ys=H("p",{class:"title is-4 mt-4"},"New subscription",-1);var Ds=R({expose:[],props:{suscripcion:{type:Object,required:!0},type:{type:String,default:"new"}},emits:["reload"],setup(e,{emit:s}){const t=e,l=q(!1),a=se({next_payment_date:"",amount:0,amounts_not_ids:[]}),n=q(null),i=e=>{n.value=e,console.log("ready",e),u.value=!0},o=q(null),u=q(!1);$((()=>{let e=o.value.total;return e-=a.amount,e<-0&&(e=0),e})),Q((()=>o.value),(e=>{u.value=!1}));const c=()=>{u.value=!1},r=e=>{const a=Object.assign({},e,n.value);l.value=!0,"reprocess"==t.type&&A(t.suscripcion.id,a).then((e=>{l.value=!1,s("reload")})).catch((e=>{}))};return(e,s)=>{const a=$e,n=Je;return S(),E("div",null,[Ys,H(a,{onOnReady:i,modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=e=>o.value=e),onChangeMembership:c,class:"mb-4"},null,8,["modelValue"]),u.value&&o.value?(S(),E(n,{key:0,methods:["debit_automatic","cash","terminal"],suscripcion:t.suscripcion,amount:o.value.total,"is-loader-active":l.value,onOnPayment:r,class:"mt-4"},null,8,["suscripcion","amount","is-loader-active"])):K("",!0)])}}});const Cs={class:"columns is-multiline",style:{"min-height":"350px"}},js={class:"column is-3"},Ms=H("p",{class:"title is-6 mb-1"},[H("b",null,"Total")],-1),Os={key:0,class:"title is-3 mb-0"},zs={key:1,class:"title is-3 mb-0"},As=H("div",{class:"column is-9"},null,-1),Ps=U("] "),Ls={key:0,class:"is-4 column mx-auto"},Vs={key:1,class:"is-4 column mx-auto"},ws={key:2,class:"is-4 column mx-auto"},Rs={key:3,class:"is-4 column mx-auto"},qs=H("div",{class:"mb-4 column is-12"},null,-1);var Ns=R({expose:[],props:{total:{type:Number,default:0,required:!0},user:{type:Object,default:{},required:!0},suscripcion_id:{type:Number,required:!0},metodos:{type:Array,default:["stripe-debit","cash","posnet"]}},emits:["proccessCheckout","reload"],setup(e,{emit:t}){const l=e;Z();const n=q(!1),i=e=>{n.value=!0,P(l.suscripcion_id,e).then((e=>{n.value=!1,t("proccessCheckout")})).catch((e=>{if(n.value=!1,t("reload"),"object"==typeof e.response.data)for(var s in e.response.data)if("object"==typeof e.response.data[s])for(var l in e.response.data[s]){if("object"==typeof e.response.data[s][l])for(var a in e.response.data[s][l])c.error(e.response.data[s][l][a]);"string"==typeof e.response.data[s][l]&&c.error(e.response.data[s][l])}}))};return(t,o)=>{const c=s,r=a,d=ie,m=ue,p=oe,v=ce;return S(),E("div",Cs,[H("div",js,[H(r,{size:"small",active:n.value},{default:T((()=>[H(c,{class:"mb-4"},{default:T((()=>[te(t.$slots,"default"),H("div",null,[Ms,t.order?(S(),E("p",Os,F(B(u)(e.total)),1)):(S(),E("p",zs,F(B(u)(e.total)),1))])])),_:3})])),_:1},8,["active"])]),As,Ps,l.metodos.includes("stripe-debit")?(S(),E("div",Ls,[H(r,{size:"small",active:n.value},{default:T((()=>[H(d,{total:l.total,user:l.user,onOnPayment:i},null,8,["total","user"])])),_:1},8,["active"])])):K("",!0),l.metodos.includes("stripe-checkout")?(S(),E("div",Vs,[H(r,{size:"small",active:n.value},{default:T((()=>[H(m,{total:l.total,onOnPayment:i},null,8,["total"])])),_:1},8,["active"])])):K("",!0),l.metodos.includes("cash")?(S(),E("div",ws,[H(r,{size:"small",active:n.value},{default:T((()=>[H(p,{total:l.total,onOnPayment:i},null,8,["total"])])),_:1},8,["active"])])):K("",!0),l.metodos.includes("posnet")?(S(),E("div",Rs,[H(r,{size:"small",active:n.value},{default:T((()=>[H(v,{total:l.total,onOnPayment:i,define_status:!0},null,8,["total"])])),_:1},8,["active"])])):K("",!0),qs])}}});const Ss={class:"w-100",style:{"min-height":"200px"}},Es={key:0,class:"h-100 w-100"},Is={key:0},Ts={key:0,class:""},Hs={style:{"font-size":"12px"}},Us={style:{"font-size":"12px"}},$s={key:1,class:""},Bs={style:{"font-size":"12px"}},Gs={style:{"font-size":"12px"}},Xs={class:"d-flex justify-content-between"},Fs={class:"title is-5 mb-0"},Ks=U("Membership: "),Ws=U(" Current billing location: "),Js={class:"title is-4 mb-0"},Qs={key:0},Zs={class:"text-right"},et=H("b",null,"Payment Method:",-1),st={key:0},tt={key:0,class:"title is-4 mb-0"},lt=H("br",null,null,-1),at={key:1,class:"title is-4 mb-0"},nt=H("br",null,null,-1),it={key:2,class:"title is-6"},ot=H("br",null,null,-1),ut={key:1},ct=H("p",null,"no tiene presupuesto",-1),rt={class:"d-flex flex-row mt-4"},dt={class:"mr-3"},mt=H("b",null,"Consultation date: ",-1),pt={class:"mr-3"},vt=H("b",null,"Month: ",-1),bt={key:0,class:"mr-3"},_t=H("b",null,"Start: ",-1),ft={class:"mr-3"},yt=H("b",null,"Next payment date: ",-1),ht={key:1,class:"mr-3"},gt=H("b",null,"Cancellation Date: ",-1),xt={key:2,class:"mr-3"},kt=H("b",null,"Last payment attempt: ",-1),Yt={key:3,class:"mr-3"},Dt=H("b",null,"Status Last payment attempt: ",-1),Ct={key:4,class:"d-flex"},jt={class:"mr-3"},Mt=H("b",null,"Months late: ",-1),Ot={class:"mr-3"},zt=H("b",null,"Days late: ",-1),At={class:"mr-3"},Pt=H("b",null,"Hours late: ",-1),Lt={key:0,class:"columns"},Vt={class:"column is-8 pt-0"},wt={class:"column is-4"},Rt={class:"column is-12"},qt={class:"column is-12"},Nt={class:"column is-12"},St={class:"column is-12"},Et={class:"column is-12"},It={class:"column is-12"},Tt={class:"column is-12"},Ht={key:2};var Ut=R({expose:[],props:{suscripcion:{type:Object,default:null},suscripcion_id:{type:Number,default:null},member_id:{type:Number,default:null},code:{type:String,default:null}},setup(t){const l=t,n=Z(),i=q(null),o=q(!1),c=q(!1),d=()=>{Object.assign(C,L),c.value=!0;let e=null;n.query.id&&(e=n.query.id),l.member_id&&(e=l.member_id),l.suscripcion_id?V(l.suscripcion_id,!1).then((e=>{i.value=e.data.suscripcion,c.value=!1})):null==e&&l.code?w(l.code).then((e=>{i.value=e.data.suscripcion,c.value=!1})):V(e,!0).then((e=>{i.value=e.data.suscripcion,c.value=!1}))},m=$((()=>l.suscripcion?l.suscripcion:i.value));N((()=>{d()})),Q((()=>l.member_id),(()=>{d()}));const p=()=>{d()};return(t,l)=>{const n=e,i=s,v=_e,b=ye,_=Oe,f=qe,y=ts,h=fs,g=ie,x=a,k=ks,Y=Ds,D=Ns,C=de;return S(),E(x,{size:"small",active:c.value},{default:T((()=>[H("div",Ss,[B(m)?(S(),E("div",Es,[H(i,{class:"mb-4 d-flex align-items-center"},{default:T((()=>[B(m).member?(S(),E("div",Is,[H(n,{picture:`${B(r)}storage/${B(m).member.photo}`,color:"primary",initials:B(ve)(B(m).member.name,B(m).member.last_name),size:"medium",class:"mr-4 mb-4"},null,8,["picture","initials"])])):K("",!0),H("div",null,[B(m).member?(S(),E("div",$s,[H("p",Bs,F(B(m).member.name)+" "+F(B(m).member.last_name),1),H("p",Gs,F(B(m).member.email),1)])):(S(),E("div",Ts,[H("p",Hs," Username: "+F(B(m).user.name),1),H("p",Us," Email: "+F(B(m).user.email),1)]))])])),_:1}),H(i,{class:"mb-5",style:{background:B(m).estado.color}},{default:T((()=>[H("div",Xs,[H("span",null,[H("p",Fs," ESTADO : "+F(B(m).estado.estado_pago),1),H("p",null,[H("small",null,[Ks,H("small",null,[Ws,H("b",null,F(B(m).memberships_members.location.name),1)])])]),H("p",Js,F(B(m).membership.name),1),B(m).recurrence?(S(),E("p",Qs,F(B(m).recurrence.recurrencia.descriptions),1)):K("",!0)]),H("span",Zs,[H("p",null,[H("small",null,[et,U(" "+F(B(m).payment_type.name),1)])]),H("p",null,[H("small",null,F(B(m).is_recurrence?"Recurrence":"no recurrence"),1)]),B(m).presupuesto?(S(),E("span",st,[B(m).discount?(S(),E("p",at,[U(F(B(u)(B(m).presupuesto.total)),1),nt])):(S(),E("p",tt,[U(F(B(u)(B(m).presupuesto.recurrente)),1),lt])),B(m).discount?(S(),E("p",it,[H("small",null,F(B(m).discount.name),1),U(" : "+F(B(u)(B(m).presupuesto.total)),1),ot])):K("",!0)])):(S(),E("span",ut,[ct]))])]),H("div",rt,[H("p",dt,[mt,U(" "+F(B(I)(B(m).estado.fecha_validacion,"YYYY-MM-DD").format("MM-DD-YYYY")),1)]),H("p",pt,[vt,U(" "+F(B(m).estado.meses_pagados),1)]),B(m).schedules_start?(S(),E("p",bt,[_t,U(" "+F(B(I)(B(m).schedules_start,"YYYY-MM-DD").format("MM-DD-YYYY")),1)])):K("",!0),H("p",ft,[yt,U(" "+F(B(I)(B(m).estado.fecha_vencimiento,"YYYY-MM-DD").format("MM-DD-YYYY")),1)]),B(m).estado.fecha_suspencion?(S(),E("p",ht,[gt,U(" "+F(B(I)(B(m).estado.fecha_suspencion,"YYYY-MM-DD").format("MM-DD-YYYY")),1)])):K("",!0),B(m).memberships_members.payments.length?(S(),E("p",xt,[kt,U(" "+F(B(I)(B(m).memberships_members.payments[0].created_at).format("MM-DD-YYYY")),1)])):K("",!0),B(m).memberships_members.payments.length?(S(),E("p",Yt,[Dt,U(" "+F(B(m).memberships_members.payments[0].status)+" / "+F(B(m).memberships_members.payments[0].status_description),1)])):K("",!0),"VENCIDO"==B(m).estado.estado_pago?(S(),E("div",Ct,[H("p",jt,[Mt,U(" "+F(B(m).estado.meses_retraso),1)]),H("p",Ot,[zt,U(" "+F(B(m).estado.dias_retraso),1)]),H("p",At,[Pt,U(" "+F(B(m).estado.horas_retraso),1)])])):K("",!0)])])),_:1},8,["style"]),["PROX. CANCELADO","CANCELADO"].includes(B(m).estado.estado_pago)?K("",!0):(S(),E("div",Lt,[H("div",Vt,[H(v,{suscripcion:B(m),onReload:d},null,8,["suscripcion"])]),H("div",wt,["CANCELADO"!=B(m).estado.estado_pago?(S(),E(i,{key:0,class:"columns is-multiline p-1"},{default:T((()=>[H("div",Rt,[H(b,{suscripcion:B(m),onReload:d},null,8,["suscripcion"])]),H("div",qt,[H(_,{suscripcion:B(m),onReload:d},null,8,["suscripcion"])]),H("div",Nt,[H(f,{suscripcion:B(m),onReload:d},null,8,["suscripcion"])]),H("div",St,[H(y,{suscripcion:B(m),onReload:d},null,8,["suscripcion"])]),H("div",Et,[H(h,{suscripcion:B(m),onReload:d},null,8,["suscripcion"])]),H("div",It,[H(x,{size:"small",active:o.value},{default:T((()=>[H(g,{total:0,card:!0,user:B(m).user,onOnPayment:d},null,8,["user"])])),_:1},8,["active"])]),H("div",Tt,[H(k,{suscripcion:B(m)},null,8,["suscripcion"])])])),_:1})):K("",!0)])])),B(m)&&["CANCELADO","PROX. CANCELADO"].includes(B(m).estado.estado_pago)?(S(),E(Y,{key:1,suscripcion:B(m),type:"reprocess",onReload:d},null,8,["suscripcion"])):K("",!0),["CANCELADO","PROX. CANCELADO","HOLD"].includes(B(m).estado.estado_pago)?K("",!0):(S(),E("div",Ht,[B(m)&&B(m).presupuesto&&"PAGADO"!=B(m).estado.estado_pago?(S(),E(D,{key:0,total:B(m).presupuesto.total,user:B(m).user,suscripcion_id:B(m).id,onProccessCheckout:p,onReload:d},null,8,["total","user","suscripcion_id"])):K("",!0),B(m)&&B(m).presupuesto&&"PAGADO"!=B(m).estado.estado_pago?(S(),E(i,{key:1},{default:T((()=>[H(C,{presupuesto:B(m).presupuesto},null,8,["presupuesto"])])),_:1})):K("",!0)]))])):K("",!0)])])),_:1},8,["active"])}}});export{Ut as _};
