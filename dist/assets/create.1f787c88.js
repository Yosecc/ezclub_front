import{_ as e}from"./V-Card.vue_vue&type=script&setup=true&lang.b57414a9.js";import{_ as t}from"./V-Loader.vue_vue&type=script&setup=true&lang.a67ef8b7.js";import{_ as a}from"./inputsLayaut.vue_vue&type=style&index=0&lang.9a5f1b2d.js";import{_ as s}from"./V-SwitchBlock.vue_vue&type=script&setup=true&lang.f9906d24.js";import{_ as l}from"./V-Control.b8a16a92.js";import{_ as i}from"./V-Field.vue_vue&type=script&setup=true&lang.5a5e683f.js";import{_ as n}from"./V-Button.vue_vue&type=script&setup=true&lang.115c9f56.js";import{_ as o}from"./Presupuesto.vue_vue&type=script&setup=true&lang.688333ae.js";import{_ as r}from"./SearchBar.vue_vue&type=style&index=0&lang.a53eb065.js";import{d as u,e as c,i as d,f as p,s as m,j as v,w as f,o as y,_,b}from"./subscription-method-stripe-checkout.vue_vue&type=script&setup=true&lang.f7b264b1.js";import{_ as h}from"./V-Tag.vue_vue&type=script&setup=true&lang.43768b74.js";import{_ as g}from"./V-Modal.vue_vue&type=script&setup=true&lang.f91cc122.js";import{d as j,u as x,r as k,A as w,w as V,b as C,i as S,j as z,l as P,k as T,S as L,L as O,I,W as B,X as N,U as A,F as J,H as M,P as Y,O as D,ad as E,o as U,R as $,G as R}from"./vendor.84e48f7c.js";import{s as H,b as q,p as F,c as G,d as W,e as X,f as K}from"./ManualPayment.8d0982a5.js";import{c as Q}from"./Companies.0f149595.js";import{n as Z,m as ee,a as te,g as ae,e as se,s as le}from"./index.910b1fa7.js";import{_ as ie}from"./SidebarLayout.vue_vue&type=script&setup=true&lang.e44d7d29.js";import{p as ne}from"./sidebarLayoutState.bceb862d.js";import{e as oe,c as re,s as ue,d as ce}from"./config.320df268.js";import{i as de}from"./Members.3d554f80.js";import"./V-SwitchSegment.vue_vue&type=script&setup=true&lang.8a41fb82.js";import"./V-Checkbox.vue_vue&type=script&setup=true&lang.3090aa96.js";import"./V-Placeload.8fe4e440.js";import"./V-Avatar.vue_vue&type=script&setup=true&lang.b74dc949.js";import"./Discounts.f7589428.js";import"./MemberCards.5d5399dd.js";import"./ActivityPanel.vue_vue&type=style&index=0&lang.da407209.js";import"./useDropdown.3858e0aa.js";import"./V-Dropdown.7cdac118.js";import"./V-Icon.vue_vue&type=script&setup=true&lang.1503437d.js";import"./activePanelState.de92bd5f.js";import"./fastpizza.1e58d0ec.js";import"./TaskPanel.vue_vue&type=style&index=0&lang.1c78e14a.js";import"./video.f5cea5d5.js";import"./SearchPanel.vue_vue&type=style&index=0&lang.f7104d79.js";import"./darkModeState.0452d175.js";import"./AnimatedLogo.2dcbd823.js";import"./V-IconBox.vue_vue&type=script&setup=true&lang.051c3ce8.js";import"./V-Block.vue_vue&type=script&setup=true&lang.d16ae397.js";import"./UserPopoverContent.vue_vue&type=script&setup=true&lang.e7d23443.js";import"./userPopovers.f4b9fc60.js";import"./Diciplines.9b7c477d.js";import"./Memberships.f0132fab.js";const pe={class:"d-flex justify-content-between align-items-start"},me=P("div",null,[P("p",{class:"title is-3"},[P("i",{class:"fas fa-mobile","aria-hidden":"true"})]),P("p",{class:"title is-5"},"Terminal")],-1),ve={class:"title is-6"},fe={key:0},ye={key:0,class:"mt-4 mx-2"},_e={class:"column is-8"},be=P("p",{class:"title is-1"},[P("i",{class:"lnir lnir-postcard","aria-hidden":"true"})],-1),he={class:"title is-5 mb-0"},ge={style:{"font-size":"10px"},class:"is-7 mb-0"},je={style:{"font-size":"10px"},class:"is-7 mb-0"},xe={style:{"font-size":"10px"},class:"is-7 mb-0"},ke={style:{"font-size":"10px"},class:"is-7 mb-0"},we={style:{"font-size":"10px"},class:"is-7 mb-0"},Ve={key:0},Ce=P("p",{class:"title is-7 text-capitalize m-0"},"retry",-1),Se=P("p",{class:"title is-6"},[P("i",{class:"lnil lnil-reload"})],-1),ze={class:"column is-4"},Pe=P("div",null,[P("p",{class:"title is-6 mb-0"},"Terminal status")],-1),Te=P("p",{class:"title is-5"},[P("i",{class:"lnil lnil-reload"})],-1),Le=P("div",null,[P("p",{class:"title is-6 mb-0"},"Cancel payment")],-1),Oe=P("p",{class:"title is-5"},[P("i",{class:"lnil lnil-trash-can"})],-1),Ie={key:0,class:"column is-12"},Be=P("div",null,[P("p",{class:"title is-6 mb-0"},"Clean and Close")],-1),Ne={key:0},Ae=P("p",{class:"title is-5"},[P("i",{class:"lnil lnil-checkmark-circle"})],-1);var Je=j({expose:[],props:{total:{type:Number,required:!0},define_status:{type:Boolean,default:!0}},emits:["onPayment"],setup(a,{emit:s}){const l=a,{cookies:i}=x(),n=k(!1),o=k([]),r=()=>{n.value=!0;let e=Q.value.locations;if(e.length&&i.get("locations_id")){let t=e.find((e=>e.id==i.get("locations_id")));if(null!=t){let e=t.terminales;e.length&&(o.value=e)}}0==o.value&&Z.error("No terminals found at this location")},u=w(JSON.parse(JSON.stringify({id:null,label:"",status:!1,amount:0}))),c=k(!1);V((()=>n.value),(e=>{u.id=null,u.label="",u.status=!1,u.amount=0,c.value=!1,y.value=!1,d.value=!1,j.value=0,H.value=JSON.parse(JSON.stringify(q)),F.value=JSON.parse(JSON.stringify(G))}));const d=k(!1),p=k(10);V((()=>H.value.status),(e=>{d.value&&("succeeded"==e?(Z.success("Payment Success"),n.value=!1,j.value<=p.value&&f()):"failed"==e?Z.error(H.value.failure_message):"in_progress"==e&&Z.success("Payment in progress")),d.value||"succeeded"==e&&Y()}));const m=C((()=>{let e={status:"",message:"",color:""};return e.status=H.value.status,"succeeded"==e.status&&(e.color="success"),"failed"==e.status&&(e.color="danger"),"in_progress"==e.status&&(e.color="info"),e})),v=()=>{"in_progress"!=H.value.status?"succeeded"!=H.value.status?null!=u.id?(h(),c.value=!0,W(u).then((e=>{c.value=!1,Z.success(e.data.message)})).catch((e=>{c.value=!1}))):console.log("alert. no selecciono el terminal de pago"):Z.error("Payment processed"):Z.error("Terminal busy")},f=()=>{s("onPayment",{amount:l.total,payment_type_id:5})},y=k(!1),_=C((()=>null!=u.id)),b=()=>{_.value||(n.value=!1)},h=()=>{new Pusher("2cd5b586808b2f41f8e6",{cluster:"us2"}).subscribe("terminal_channel").bind("terminal_event",(function(e){d.value=!0,null==e.terminal?H.value=JSON.parse(JSON.stringify(q)):H.value=e.terminal,null==e.payment_intent?F.value=JSON.parse(JSON.stringify(G)):F.value=e.payment_intent}))},j=k(0),Y=()=>{j.value=0;let e=setInterval((()=>{j.value++,j.value==p.value&&clearInterval(e)}),1e3)};return(a,i)=>{const d=e,f=t,_=g;return S(),z(L,null,[P(d,{onClick:r,color:l.define_status?"info":void 0,class:"btn-card w-100 justify-content-center"},{default:T((()=>[P("div",pe,[me,P("p",ve,[O(a.$slots,"righttop"),I(' <i class="fas fa-check" aria-hidden="true"></i> ')])])])),_:3},8,["color"]),P(_,{title:"",open:n.value,actions:"center",size:"big",noclose:"",onClose:b},{content:T((()=>[B(P("div",null,[O(a.$slots,"modalprev")],512),[[N,!l.define_status]]),0==o.value.length?(S(),z("p",fe,"'No terminals found at this location'")):I("v-if",!0),B(P("div",null,[o.value.length?(S(),z("div",ye,[P(f,{size:"small",active:c.value},{default:T((()=>[(S(!0),z(L,null,A(o.value,((e,t)=>(S(),z(d,{key:`terminal-${t}`,class:"columns is-multiline mb-4"},{default:T((()=>[I(" <p>{{ terminal }}</p> "),P("div",_e,[P(d,{class:"p-4 btn-card d-flex justify-content-between",color:J(u).id==e.id?J(m).color:void 0,onClick:t=>(e=>{u.id=e.id,u.label=e.label,u.status=e.status,u.amount=l.total,v()})(e)},{default:T((()=>[P("div",null,[be,P("p",he,M(e.label),1),P("p",null,"Status: "+M(e.status),1)]),P("div",null,[P("p",ge," ID: "+M(J(F).id),1),P("p",je," Amount: "+M(J(ee)(J(F).amount/100)),1),P("p",xe," Date: "+M(J(F).created),1),P("p",ke," PI. Status: "+M(J(F).status),1),P("p",we," Status: "+M(J(H).status),1),"failed"==J(H).status?(S(),z("div",Ve,[P(d,{class:"\r\n                          d-flex\r\n                          justify-content-between\r\n                          mt-4\r\n                          p-2\r\n                          align-items-center\r\n                        "},{default:T((()=>[Ce,Se])),_:1})])):I("v-if",!0)])])),_:2},1032,["color","onClick"])]),P("div",ze,[P(f,{size:"small",active:y.value},{default:T((()=>[P(d,{color:"warning",outlined:"",onClick:t=>(e=>{"succeeded"!=H.value.status&&(y.value=!0,X({id:e.id}).then((()=>{y.value=!1})).catch((()=>{y.value=!1})))})(e),class:"d-flex justify-content-between mb-4"},{default:T((()=>[Pe,Te])),_:2},1032,["onClick"])])),_:2},1032,["active"]),P(f,{size:"small",active:y.value},{default:T((()=>[P(d,{color:"danger",outlined:"",onClick:t=>(e=>{"succeeded"!=H.value.status&&(y.value=!0,K({id:e.id,payment_type_id:F.value.id}).then((()=>{n.value=!1,y.value=!1})).catch((()=>{y.value=!1})))})(e),class:"d-flex justify-content-between"},{default:T((()=>[Le,Oe])),_:2},1032,["onClick"])])),_:2},1032,["active"])]),"succeeded"==J(H).status?(S(),z("div",Ie,[P(f,{size:"small",active:y.value},{default:T((()=>[P(d,{color:j.value==p.value?"success":void 0,outlined:"",onClick:t=>(e=>{j.value==p.value&&(K({id:e.id,payment_type_id:null}),n.value=!1,y.value=!1,s("onPayment",{amount:l.total,payment_type_id:5}))})(e),class:"d-flex justify-content-between"},{default:T((()=>[Be,j.value<p.value?(S(),z("p",Ne,"Loading ... "+M(j.value),1)):I("v-if",!0),Ae])),_:2},1032,["color","onClick"])])),_:2},1032,["active"])])):I("v-if",!0),I("")])),_:2},1024)))),128))])),_:1},8,["active"])])):I("v-if",!0)],512),[[N,l.define_status]])])),action:T((()=>[I(' <VButton @click="cash = 0" class="d-flex justify-content-center" raised\r\n        >Reset</VButton\r\n      >\r\n      <VButton\r\n        color="success"\r\n        @click="payment"\r\n        :disabled="total > cash"\r\n        class="d-flex justify-content-center"\r\n        raised\r\n        >Confirm</VButton\r\n      > ')])),_:1},8,["open"])],64)}}});const Me={class:"columns is-multiline"},Ye={class:"column is-9"},De=P("h1",{class:"title is-4"},"1. Select a membership",-1),Ee={class:"columns is-multiline"},Ue={class:"title is-4"},$e={class:"column is-3"},Re={class:"title is-5 text-left mt-2"},He={key:0},qe={key:1},Fe={key:0,class:"column is-12"},Ge=P("h1",{class:"title is-4"},"2. Approve the budget",-1),We=R("Accept and continue "),Xe={key:1,class:"column is-12"},Ke=P("h1",{class:"title is-4"},[R(" 3. Enter the member's email. "),I(' <br />\r\n          <small style="font-size: 12px"\r\n            >* Then select a match if possible...otherwise press ENTER</small\r\n          >\r\n          <br />\r\n          <small style="font-size: 12px"\r\n            >* If you want to register a minor, please enter the email of the\r\n            family member to register</small\r\n          > ')],-1),Qe={class:"columns is-multiline"},Ze={class:"column is-3"},et=P("p",{class:"title is-6 mb-1"},[P("b",null,"Total")],-1),tt={class:"title is-3 mb-0"},at={class:"is-3 column"},st=P("p",{class:"title is-6"}," You must load a card to continue. If you do not have a card, define the paymentType option as cash ",-1),lt={class:"column is-3"},it=P("p",{class:"title is-6"}," You must load a card to continue. If you do not have a card, define the paymentType option as cash ",-1);var nt=j({expose:[],setup(g){ne.value="Subscriptions",Y({title:"Subscriptions"}),D(),E();const j=k([]),x=k(!0),O=k(!1),N=k(null),R=k(null);w({number:5,status:!1,time:5e3});const H=C((()=>{const e=j.value.find((e=>e.id==m.memberships_id));return null==e?void 0:e.amounts.filter((e=>e.is_recurrence==x.value&&null!=e.recurrencia))})),q=C((()=>{for(var e in m)null!=ae(d.value,e)&&(m[e]=ae(d.value,e).model);return m}));V((()=>m.memberships_id),(e=>{m.recurrences_id=null,p.value=null,O.value=!1})),U((()=>{Q(),u().then((e=>{j.value=e.data})),c(1,"membership").then((e=>{te(d,"discount",e.data.discounts)})),ae(d,"payment_type_id").model=3,oe().then((e=>{te(de,"city_id",re.value),te(de,"state_id",ue.value),te(de,"country_id",ce.value),ae(de.value,"country_id").model=34}))}));const F=()=>{O.value=!0,setTimeout((()=>{window.scrollTo(0,window.scrollY+500)}),300)},G=()=>{p.value=null,O.value=!1,W.value=!0,v(q.value).then((e=>{p.value=e.data,setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight||document.documentElement.scrollHeight),W.value=!1}),300)})).catch((e=>{W.value=!1}))},W=k(!1),X=async e=>{R.value?(W.value=!0,m.email=R.value,m.subscription_payment_type_id=ae(d,"payment_type_id").model,Object.assign(m,e),console.log("solicitud",m),await f(m).then((e=>{window.location.href=e.data.url})).catch((e=>{Z.error("Error"),W.value=!1}))):Z.error("Email is required")},K=()=>{setTimeout((()=>{if(N.value)for(var e in console.log(N.value),N.value)"photo"!=e&&le(de,e,N.value[e]);else le(de,"email",R.value);let t=window.scrollY+window.scrollY/4;window.scrollTo(0,t)}),300)},Q=async()=>{se(d.value),se(de.value),p.value=null,m.memberships_id=null,m.recurrences_id=null,m.is_initiation_fee=!1,m.is_card_price=!1,m.discount=null,m.is_last_month=!1,m.prorrateo=!0,m.schedules="",m.leo_vet_fr=!1,m.multigym=!1},pe=C((()=>ae(d,"payment_type_id").model));C((()=>!ae(de.value,"category").model));const me=k(!1),ve=C((()=>!(3!=pe.value||!me.value)||1==pe.value)),fe=(e=null)=>{e&&e.payment_method_id&&(me.value=!0)};return(u,c)=>{const v=e,f=t,g=a,k=s,w=l,V=i,C=n,Y=o,D=r,E=y,U=h,q=_,Q=b,Z=Je,te=ie,ae=$("tooltip");return S(),z(te,null,{default:T((()=>[P("div",Me,[P("div",Ye,[De,P(v,{class:"mb-4"},{default:T((()=>[P(f,{size:"large",active:!j.value.length},{default:T((()=>[P("div",Ee,[(S(!0),z(L,null,A(j.value,((e,t)=>(S(),z("div",{key:`membership-${t}`,class:"column is-4 btn btn-card",onClick:t=>J(m).memberships_id=e.id},[P(v,{color:J(m).memberships_id==e.id?"primary":void 0,class:"h-100"},{default:T((()=>[P("div",null,[P("h1",Ue,M(e.name),1),I(" <p>{{ item }}</p> ")])])),_:2},1032,["color"])],8,["onClick"])))),128))])])),_:1},8,["active"])])),_:1}),P(v,{class:""},{default:T((()=>[P(g,{"inputs-step":J(d)},null,8,["inputs-step"])])),_:1})]),P("div",$e,[P(v,{class:"h-100 d-flex flex-column justify-content-between"},{default:T((()=>[P("div",null,[P(V,null,{default:T((()=>[P(w,null,{default:T((()=>[P(k,{modelValue:x.value,"onUpdate:modelValue":c[1]||(c[1]=e=>x.value=e),label:"Recurring Subscription",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1}),(S(!0),z(L,null,A(J(H),((e,t)=>(S(),z("div",{key:`membership-precios-${t}`,class:"btn btn-card",onClick:t=>J(m).recurrences_id=e.id},[P(v,{color:J(m).recurrences_id==e.id?"primary":void 0,class:"mb-3 py-4"},{default:T((()=>[P("p",null,M(e.recurrencia.descriptions),1),P("p",Re,M(J(ee)(e.amount)),1)])),_:2},1032,["color"])],8,["onClick"])))),128))]),P("div",null,[P(f,{size:"large",active:W.value},{default:T((()=>[P(C,{onClick:G,color:J(p)?void 0:"primary",class:"d-flex justify-content-center mt-6 py-5 w-100",style:{"text-align":"center","text-transform":"uppercase","font-size":"20px","font-weight":"900"}},{default:T((()=>[J(p)?(S(),z("span",qe," restart")):(S(),z("span",He,"start subscription"))])),_:1},8,["color"])])),_:1},8,["active"])])])),_:1})]),J(p)?(S(),z("div",Fe,[Ge,P(v,null,{default:T((()=>[P(Y,{presupuesto:J(p)},null,8,["presupuesto"]),O.value?I("v-if",!0):(S(),z(C,{key:0,onClick:F,color:"primary",class:"d-flex justify-content-center py-5 px-6 ml-auto",style:{"text-align":"center","text-transform":"uppercase","font-size":"20px","font-weight":"900"}},{default:T((()=>[We])),_:1}))])),_:1})])):I("v-if",!0),J(p)&&O.value?(S(),z("div",Xe,[Ke,P(v,{style:{"margin-bottom":"24px"}},{default:T((()=>[P(D,{dato:"email",valor:R.value,"onUpdate:valor":c[2]||(c[2]=e=>R.value=e),modelValue:N.value,"onUpdate:modelValue":c[3]||(c[3]=e=>N.value=e),"not-payment-methods":!0,"not-search":!0,onOnSubmit:K},null,8,["valor","modelValue"])])),_:1}),P(v,{style:{"margin-bottom":"24px"}},{default:T((()=>[P("div",Qe,[P("div",Ze,[P(f,{size:"small",class:"h-100",active:W.value},{default:T((()=>[P(v,{class:"mb-4 h-100"},{default:T((()=>[P("div",null,[et,P("p",tt,M(J(ee)(J(p).total)),1)])])),_:1})])),_:1},8,["active"])]),P("div",at,[P(f,{size:"small",active:W.value},{default:T((()=>[P(E,{total:J(p).total,onOnPayment:X},null,8,["total"])])),_:1},8,["active"])]),I(' <div class="column is-2"> '),I(' <VLoader size="small" class="h-100 mr-0" :active="isLoaderActive">\r\n                <subscription-method-payment-debit-automatic\r\n                  :total="20"\r\n                  :card="false"\r\n                  :user="{ email: dato, id: null }"\r\n                  :new-user="true"\r\n                  :text-card="\'Cards\'"\r\n                  :outline="true"\r\n                  @onPayment="onActionCard"\r\n                >\r\n                  <template #righttop>\r\n                    <VTag\r\n                      v-tooltip="\r\n                        \'This option does not generate any charge to the card\'\r\n                      "\r\n                      color="solid"\r\n                      label="?"\r\n                    />\r\n                  </template>\r\n                </subscription-method-payment-debit-automatic>\r\n              </VLoader> '),I(" </div> "),P("div",{class:["column",(J(pe),"is-3")]},[P(f,{size:"small",active:W.value},{default:T((()=>[P(Q,{total:J(p).total,onOnPayment:X,define_status:J(ve)},{righttop:T((()=>[3!=J(pe)||me.value?I("v-if",!0):B((S(),z(U,{key:0,color:"solid",label:"?"},null,512)),[[ae,"You must load a card to continue. If you do not have a card, define the paymentType option as cash "]])])),modalprev:T((()=>[st,P(f,{size:"small",class:"h-100 mr-0",active:W.value},{default:T((()=>[P(q,{total:20,card:!1,user:{email:R.value,id:null},"new-user":!0,"text-card":"Cards (+)",outline:!0,onOnPayment:fe},{righttop:T((()=>[B(P(U,{color:"solid",label:"?"},null,512),[[ae,"This option does not generate any charge to the card"]])])),_:1},8,["user","text-card"])])),_:1},8,["active"])])),_:1},8,["total","define_status"])])),_:1},8,["active"])],2),P("div",lt,[P(f,{size:"small",active:W.value},{default:T((()=>[P(Z,{total:J(p).total,onOnPayment:X,define_status:!(3==J(pe)&&!me.value)},{righttop:T((()=>[me.value?I("v-if",!0):B((S(),z(U,{key:0,color:"solid",label:"?"},null,512)),[[ae,"You must load a card to continue. If you do not have a card, define the paymentType option as cash "]])])),modalprev:T((()=>[it,P(f,{size:"small",class:"h-100 mr-0",active:W.value},{default:T((()=>[P(q,{total:20,card:!1,user:{email:R.value,id:null},"new-user":!0,"text-card":"Cards (+)",outline:!0,onOnPayment:fe},{righttop:T((()=>[B(P(U,{color:"solid",label:"?"},null,512),[[ae,"This option does not generate any charge to the card"]])])),_:1},8,["user","text-card"])])),_:1},8,["active"])])),_:1},8,["total","define_status"])])),_:1},8,["active"])])])])),_:1}),I(' <VLoader :active="isLoaderActive">\r\n          <VButton\r\n            @click="proccessSuscripcion"\r\n            color="info"\r\n            class="d-flex justify-content-center py-5 px-6 ml-auto"\r\n            style="\r\n              text-align: \'center\';\r\n              text-transform: uppercase;\r\n              font-size: 20px;\r\n              font-weight: 900;\r\n            "\r\n          >\r\n            Process\r\n          </VButton>\r\n        </VLoader> '),I(' <VCard v-if="dato">\r\n          <inputsLayaut :inputs-step="inputsInformation" />\r\n          <div v-if="isMinor">\r\n            <VCard>\r\n              <p class="title is-5">Guardian Information</p>\r\n              <inputsLayaut :inputs-step="parentInsputs" />\r\n            </VCard>\r\n          </div>\r\n          <div class="mt-3">\r\n            <p v-if="tiempo.status">\r\n              You will be redirected, please wait a moment ...\r\n              {{ tiempo.number }}\r\n            </p>\r\n            <VLoader size="large" :active="isLoaderActive">\r\n              <VButton\r\n                @click="proccessMember"\r\n                color="info"\r\n                class="d-flex justify-content-center py-5 px-6 ml-auto"\r\n                style="\r\n                  text-align: center;\r\n                  text-transform: uppercase;\r\n                  font-size: 20px;\r\n                  font-weight: 900;\r\n                "\r\n              >\r\n                Continue\r\n              </VButton>\r\n            </VLoader>\r\n          </div>\r\n        </VCard> ')])):I("v-if",!0)])])),_:1})}}});export default nt;
