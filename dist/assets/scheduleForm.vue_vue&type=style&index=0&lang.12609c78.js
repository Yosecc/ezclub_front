import{_ as e}from"./V-Button.vue_vue&type=script&setup=true&lang.1a9fba1b.js";import{_ as a}from"./V-Card.vue_vue&type=script&setup=true&lang.6199c77d.js";import{_ as t}from"./inputsLayaut.vue_vue&type=style&index=0&lang.996de933.js";import{_ as s}from"./formLayaut.vue_vue&type=style&index=0&lang.1dc86fff.js";import{_ as i}from"./V-Avatar.vue_vue&type=script&setup=true&lang.e9f9f5bb.js";import{r as n,d as l,a4 as o,u as d,b as r,w as c,H as u,z as m,o as p,i as f,k as v,j as _,D as h,Q as y,R as g,G as b,F as E,E as I}from"./vendor.0b0c2a98.js";import{A as k,a as D,g as S,f as w,n as L,e as A,p as x,b as q}from"./index.6309fa0f.js";import{g as Y,d as j}from"./Diciplines.db383ad4.js";import{b as M,c as C,l as $,d as H}from"./Companies.8eb8c471.js";import{h as V,t as O}from"./Staffs.aa98a4fb.js";n([]);const N=n([]),T=n([]),J=async e=>{const a=await k.get(`schedule?locations_id=${e}`);return T.value=a.data,a},B=n(),G=n([{typeInput:"selectDataActionChange",name:"discipline_id",placeholder:"Discipline",values:[""],model:"",required:!0,class:"is-6"},{typeInput:"checkboxGroupSimpleEventInput",name:"location_id",text:"Locations",values:[""],model:[],required:!0,class:"is-12"}]),R=n([{typeInput:"switchEventChangeInput",name:"mismoshorariostrainers",values:["","Mismos horarios para todos los trainers seleccionados"],model:!1,required:!0,class:"is-6",click:function(){},change:function(){}}]);n([{typeInput:"switchEventChangeInput",name:"mismoshorariosdias",values:["","Mismos horarios para todos los dias"],model:!0,required:!0,class:"is-6",click:function(){},change:function(){}}]);const F=n([{typeInput:"switchEventChangeInput",name:"mismasfechas",values:["","Mismas fechas para todas las locaciones"],model:!0,required:!0,class:"is-12",click:function(){},change:function(){}}]),K=[{typeInput:"date",name:"start_date",placeholder:"Start Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"start_time",placeholder:"Start Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"date",name:"end_date",placeholder:"end Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"end_time",placeholder:"end Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"number",name:"capacity",placeholder:"Capacity people num",values:null,model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"type_of_member",placeholder:"Type of Member",values:["Adults Only","Kids Only","Adult & Kids"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"level",placeholder:"Level",values:["All Levels","Pro","Expert","Medium","Beginner"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"color",name:"color",placeholder:"Color",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"switchEventChangeInput",name:"is_recurrence",placeholder:"Recurrence",values:["","Recurrence"],model:!1,required:!0,class:"is-3",isLabel:!0,change:function(){}},{typeInput:"checkboxGroupSimpleEventInput",name:"recurrence",text:"Dias de la semana",default:[1,2,3,4,5,6,0],values:[{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"},{id:0,name:"Sunday"},{id:"All",name:"All"}],model:[],required:!0,disabled:!0,class:"is-12",click:function(){},change:function(){}}],W=n([{typeInput:"checkboxGroupSimpleEventInput",name:"trainers_id",text:"Trainers",values:[""],model:[],required:!0,class:"is-12"}]),z=n(null),P={class:"d-flex justify-content-between"},Q=I(" DELETE"),U=v("h3",{class:"title is-5 mb-2"},"Warning Edit",-1),X={class:"d-flex align-items-center"},Z={class:"ml-3 title is-6"};var ee=l({expose:[],props:{type:{type:String,default:"create"},buttons:{type:Array,default:["save"]},step:{type:Number,default:1},selectInfoData:{type:Object,default:null},idEvent:{type:Number,default:null}},emits:["addEvent","deleteEvent"],setup(l,{emit:I}){const T=l;o();const{cookies:J}=d(),ee=r((()=>"create"==T.type?{title:"Add a new schedule",subtitle:"Add information for a new schedule"}:{title:"Edit schedule",subtitle:"Edit information for a schedule"}));c((()=>T.idEvent),(()=>{"edit"==T.type&&(N.value=[],A(G.value),(async e=>{const a=await k.get(`schedule/${e}/edit`);return B.value=a.data,a})(T.idEvent).then((e=>{S(G.value,"location_id").model.push(B.value.locations_id),S(G.value,"discipline_id").model=B.value.class.dicipline_id,se(B.value.locations_id)})).catch((e=>{console.log(e.response.status),404==e.response.status&&console.log(T.idEvent)})))})),c((()=>H.value),(()=>{D(G,"location_id",H.value)})),c((()=>T.selectInfoData),(()=>{N.value=[],A(G.value),null!=J.get("locations_id")&&(S(G.value,"location_id").model.push(parseFloat(J.get("locations_id"))),se(J.get("locations_id")))}));const ae=function(e){"object"==typeof e&&(e=this.model),se(e)};c((()=>S($.value,"locations_id").model),(e=>{se(e)})),u((()=>{M().then((e=>{D($,"locations_id",C.value.locations),S($.value,"locations_id").change=ae,null!=J.get("locations_id")&&(S($.value,"locations_id").model=J.get("locations_id"),ae(J.get("locations_id")))})),Y().then((e=>{D(G,"discipline_id",j.value)})),S(G.value,"location_id").change=se,S(G.value,"location_id").click=function(){},S(F.value,"mismasfechas").change=function(){S(F.value,"mismasfechas").model||ne()},V().then((e=>{D(W,"trainers_id",O.value)}))}));const te=function(e,a){w([this],"trainers_id").forEach((a=>{null==N.value.find((e=>e.locations_id==this.locations_id)).trainers.find((e=>e.staffs_id==a.id))?N.value.find((e=>e.locations_id==this.locations_id)).trainers.push({locations_id:this.locations_id,staffs_id:a.id,name:a.name}):a.id==e.target.value&&N.value.find((e=>e.locations_id==this.locations_id)).trainers.splice(N.value.find((e=>e.locations_id==this.locations_id)).trainers.findIndex((e=>e.staffs_id==a.id)),1)}))};c((()=>S(F.value,"mismasfechas").model),(()=>{S(F.value,"mismasfechas").model&&ne()}));const se=function(e,a){let t=null;t="object"==typeof e?e.target.value:e,w(G.value,"location_id").forEach((e=>{if(null==N.value.find((a=>a.locations_id==e.id))){S(R.value,"mismoshorariostrainers").change=le,S(R.value,"mismoshorariostrainers").locations_id=e.id;let a=n(JSON.parse(JSON.stringify(K))).value;if(T.selectInfoData&&(S(a,"start_date").model=m(T.selectInfoData.start).format("YYYY-MM-DD"),S(a,"start_time").model=m(T.selectInfoData.start).format("HH:mm:ss"),S(a,"end_date").model=m(T.selectInfoData.end).format("YYYY-MM-DD"),S(a,"end_time").model=m(T.selectInfoData.end).format("HH:mm:ss")),"edit"==T.type){if(null==B.value)return L.error("Error Desconocido"),void window.location.reload();S(a,"start_date").model=m(B.value.start_date).format("YYYY-MM-DD"),S(a,"start_time").model=m(B.value.start_date).format("HH:mm:ss"),S(a,"end_date").model=m(B.value.end_date).format("YYYY-MM-DD"),S(a,"end_time").model=m(B.value.end_date).format("HH:mm:ss"),S(a,"capacity").model=B.value.capacity,S(a,"color").model=B.value.color,B.value.recurrence.length>0&&(S(a,"is_recurrence").model=!0,S(a,"recurrence").model=B.value.recurrence,S(a,"recurrence").disabled=!1),S(a,"type_of_member").model=B.value.type_of_member,S(a,"level").model=B.value.level}S(a,"start_date").change=ie,S(a,"end_date").change=ie,S(a,"capacity").change=ie,S(a,"end_time").change=ie,S(a,"start_time").change=ie,S(a,"is_recurrence").change=function(){S(a,"recurrence").disabled=this.model},S(a,"recurrence").click=function(){},S(a,"recurrence").change=function(){this.model.includes("All")&&(this.model=this.default)};let t=n(JSON.parse(JSON.stringify(W.value[0]))).value;t.change=te,t.click=function(){},t.locations_id=e.id,"edit"==T.type&&B.value.trainers.forEach((e=>{t.model.push(e.staffs_id)})),a.push(t),N.value.push({locations_id:e.id,name:e.name,start_date:S(a,"start_date"),start_time:S(a,"start_time"),end_date:S(a,"end_date"),end_time:S(a,"end_time"),capacity:S(a,"capacity"),recurrence:S(a,"recurrence"),inputsfechas:a,type_of_member:S(a,"type_of_member"),level:S(a,"level"),color:S(a,"color"),trainers:[]})}else e.id==t&&N.value.splice(N.value.findIndex((a=>a.locations_id==e.id)),1)}))},ie=function(){S(F.value,"mismasfechas").model&&ne()},ne=function(){let e=N.value.find((e=>e.locations_id==w(G.value,"location_id")[0].id));N.value.filter((e=>e.locations_id!=w(G.value,"location_id")[0].id)).forEach((a=>{S(a.inputsfechas,"start_date").model=S(e.inputsfechas,"start_date").model,S(a.inputsfechas,"end_date").model=S(e.inputsfechas,"end_date").model,S(a.inputsfechas,"end_time").model=S(e.inputsfechas,"end_time").model,S(a.inputsfechas,"start_time").model=S(e.inputsfechas,"start_time").model,S(a.inputsfechas,"capacity").model=S(e.inputsfechas,"capacity").model,S(a.inputsfechas,"color").model=S(e.inputsfechas,"color").model,S(a.inputsfechas,"type_of_member").model=S(e.inputsfechas,"type_of_member").model,S(a.inputsfechas,"level").model=S(e.inputsfechas,"level").model,S(a.inputsfechas,"recurrence").model=S(e.inputsfechas,"recurrence").model}))},le=function(e){let a=null,t=null;"number"==typeof e?(t=e,a=S(R.value,"mismoshorariostrainers").model):(t=this.locations_id,a=!S(R.value,"mismoshorariostrainers").model);let s=N.value.find((e=>e.locations_id==t)),i=s.trainers[0],l=S(i.inputsDias,"semana").model,o=s.trainers.filter((e=>e.staffs_id!=i.staffs_id)),d=null;o.forEach((e=>{d=n(JSON.parse(JSON.stringify(e.days))),a?(S(e.inputsDias,"semana").model=l,e.days=i.days):(S(e.inputsDias,"semana").model=S(e.inputsDias,"semana").default,e.days=d)}))},oe=()=>{const e=x(G.value).discipline_id,a=x(G.value).location_id;let t=[];a.forEach((e=>{let a=N.value.find((a=>a.locations_id==e)),s=[];a.trainers.forEach((e=>{s.push({staffs_id:e.staffs_id})})),t.push({locations_id:a.locations_id,start_date:a.start_date.model+" "+a.start_time.model,end_date:a.end_date.model+" "+a.end_time.model,capacity:a.capacity.model,recurrence:JSON.stringify(a.recurrence.model),type_of_member:a.type_of_member.model,level:a.level.model,color:a.color.model,trainers:s})})),z.value={dicipline_id:e,status:!0,locations:t},"create"==T.type?(async e=>await k.post("schedule",e))(z.value).then((e=>{L.success("Save Success"),e.data.forEach((e=>{I("addEvent",e),N.value=[],A(G.value)}))})).catch((e=>{for(var a in e.response.data.errores)e.response.data.errores[a].forEach((e=>{L.error(`${a} ${e}`)}))})):(async(e,a)=>{const t=await k.put(`schedule/${e}`,a);return B.value=t.data,t})(B.value.id,z.value).then((e=>{L.success("Success Update"),e.data.forEach((e=>{I("addEvent",e),N.value=[],A(G.value)}))})).catch((e=>{for(var a in e.response.data.errores)e.response.data.errores[a].forEach((e=>{L.error(`${a} ${e}`)}))}))},de=()=>{const e=B.value.id;(async e=>await k.delete(`schedule/${e}`))(e).then((e=>{I("deleteEvent",B.value.id),N.value=[],A(G.value)})).catch((a=>{404==a.response.status&&(console.log("props.idEvent",e),I("deleteEvent",e))}))};return(n,l)=>{const o=e,d=a,r=t,c=s,u=i;return p(),f(y,null,[v(c,{buttons:T.buttons,step:T.step,titles:h(ee),class:"mb-2",onSaveData:oe,color:"warning"},{default:_((()=>["create"!=T.type?(p(),f(d,{key:0,color:"warning"},{default:_((()=>[v("div",P,[v(o,{onClick:de,icon:"fa fa-times",color:"danger",elevated:""},{default:_((()=>[Q])),_:1}),U])])),_:1})):b("v-if",!0),b(' <inputsLayaut :inputs-step="locationsSelect" /> '),v(r,{"inputs-step":h(G)},null,8,["inputs-step"])])),_:1},8,["buttons","step","titles"]),(p(!0),f(y,null,g(h(N),((e,a)=>(p(),f(d,{key:`location-${a}`,class:"mb-4"},{default:_((()=>[v("div",X,[v(u,{picture:`${h(q)}storage/${e.image}`},null,8,["picture"]),v("h1",Z,E(e.name),1)]),v(r,{"inputs-step":h(F)},null,8,["inputs-step"]),v(r,{"inputs-step":e.inputsfechas},null,8,["inputs-step"]),b('  <inputsLayaut\n          :inputs-step="inputsMismosHorariosTrainer"\n        /> '),b(' <VCard \n      v-for="(trainer, key) in location.trainers"\n      :key="`trainer-${key}`"\n      class="mb-4"\n     >\n        <p>{{ trainer.name }}</p>\n        <inputsLayaut\n          :inputs-step="trainer.inputsDias"\n        />\n\n         \n        \n          <div \n            v-for="(day, key) in trainer.days"\n            key="`day-${key}`"\n            class="mb-4">\n\n            <VCard\n            v-show="(trainer.days.All && key == \'All\') || (!trainer.days.All && key != \'All\')"\n            >\n   \n              <p v-show="!trainer.days.All" >{{ key }}</p>  \n              <div\n                v-for="(horario, keey) in day"\n                :key="`horario-${key}`"\n                \n              >\n\n                <div class="columns">\n                  <div class="column is-9">\n                    <inputsLayaut\n                      :inputs-step="horario.inputsHorarios"\n                    />\n\n                  </div>\n                  <div class="column is-3 mt-6 d-flex">\n                    <VButton \n                      @click="addHorario(key, trainer)"\n                      color="info"  \n                      icon="fa fa-plus" \n                      v-if="keey >= day.length-1"\n                      > Add</VButton>\n                    <VButton v-if="keey > 0" color="danger" class="ml-2"  icon="fa fa-minus" elevated> Remove</VButton>\n                  </div>\n                </div>\n              </div>\n            </VCard>\n          </div>\n        \n        \n        \n      </VCard> ')])),_:2},1024)))),128))],64)}}});export{ee as _,J as g};
