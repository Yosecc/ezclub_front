import{_ as e}from"./V-Avatar.vue_vue&type=script&setup=true&lang.d100ee36.js";import{_ as s}from"./V-Card.vue_vue&type=script&setup=true&lang.e9e64dc2.js";import{_ as t}from"./inputsLayaut.vue_vue&type=style&index=0&lang.fe67fad1.js";import{_ as l}from"./V-Button.vue_vue&type=script&setup=true&lang.cc6d2b95.js";import{_ as a}from"./V-Loader.vue_vue&type=script&setup=true&lang.069747cb.js";import{g as n,a as i,p as o,m as u,n as c,b as r}from"./index.3fcb40f4.js";import{g as d}from"./Discounts.4a66a136.js";import{g as m}from"./Staffs.5a290635.js";import{a as p,f as v}from"./Companies.016afcb5.js";import{g as _}from"./Diciplines.5b22709e.js";import{u as b,c as f,p as y,a as h,h as x,b as g,d as Y,i as k,e as D,s as M,f as C,j,r as z,k as O,l as A,m as P,n as L,o as w,g as V,q as S}from"./Subscriptions.14ea3fc1.js";import{d as q,r as R,o as N,h as E,i as I,B as T,k as H,l as U,G as $,b as B,F as G,W as X,X as F,H as K,K as W,R as J,_ as Q,w as Z,P as ee,S as se,A as te,L as le}from"./vendor.4454b83d.js";import{_ as ae}from"./V-SwitchBlock.vue_vue&type=script&setup=true&lang.32bcd9b0.js";import{_ as ne}from"./V-Control.63a8a239.js";import{_ as ie}from"./V-Field.vue_vue&type=script&setup=true&lang.b3ed284d.js";import{_ as oe,a as ue,b as ce,c as re}from"./subscription-method-stripe-checkout.vue_vue&type=script&setup=true&lang.58e7c636.js";import{_ as de}from"./V-Modal.vue_vue&type=script&setup=true&lang.ef7028a7.js";import{_ as me}from"./Presupuesto.vue_vue&type=script&setup=true&lang.8f245707.js";import{a as pe,g as ve}from"./MemberCards.98a0b493.js";import{e as _e}from"./Members.aa5289df.js";const be=$("Save");var fe=q({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:u}){const c=e,r=R(!1),f=R(!1),y=R([{typeInput:"checkboxGroupSimpleEventInput",name:"locations",placeholder:"Locations access",text:"Locations access",required:!0,values:[],model:"",disabled:!1,class:"is-12",isLabel:!0,change:function(e,s){_(this.model).then((e=>{e.data.length&&i(s,"diciplines",e.data)}))},click:function(){}},{typeInput:"DropdownCheckbox",name:"diciplines",text:"Disciplines",placeholder:"Disciplines",required:!1,model:[],values:[],disabled:!1,class:"is-12",isLabel:!0,drop:!1},{typeInput:"selectDataActionChangeInput",name:"discount",placeholder:"Discount",values:[],data:null,model:"",disabled:!1,class:"is-12",isLabel:!0},{typeInput:"DropdownCheckbox",name:"staff_id",placeholder:"Trainer",values:[],model:[],disabled:!1,required:!1,class:"is-12",isLabel:!0,drop:!1},{typeInput:"date",typeInputDefault:"date",name:"fecha_vencimiento",placeholder:"Next payment date",model:"",class:"is-6",isLabel:!0,required:!0},{name:"payment_type_id",typeInput:"selectData",placeholder:"Payment Type",model:"",required:!0,values:[{id:1,name:"Cash"},{id:3,name:"Debit automatic"}],class:"is-6",isLabel:!0,filterOptionText:function(e){return e.name}}]);N((()=>{(async()=>{f.value=!0,n(y.value,"fecha_vencimiento").model=T(c.suscripcion.estado.fecha_vencimiento,"YYYY-MM-DD").format("YYYY-MM-DD"),n(y.value,"payment_type_id").model=c.suscripcion.payment_type_id,c.suscripcion.memberships_members&&c.suscripcion.memberships_members.diciplines.length&&(n(y.value,"diciplines").model=c.suscripcion.memberships_members.diciplines.map((e=>e.diciplines_id))),c.suscripcion.member&&c.suscripcion.member.trainers.length&&(n(y.value,"staff_id").model=c.suscripcion.member.trainers.map((e=>e.staffs_id))),c.suscripcion.discount&&(n(y.value,"discount").model=c.suscripcion.discount.id),await p().then((e=>{if(i(y,"locations",v.value),c.suscripcion&&c.suscripcion.memberships_members&&c.suscripcion.memberships_members.locaciones.length){const e=c.suscripcion.memberships_members.locaciones.map((e=>e.companies_locations_id));n(y.value,"locations").model=e,_(e).then((e=>{e.data.length&&i(y,"diciplines",e.data)}))}})),await d().then((e=>{i(y,"discount",e.data.discounts)})),await m().then((e=>{i(y,"staff_id",e.data)})),f.value=!1})()}));const h=async()=>{const e=o(y.value);r.value=!0,await b(c.suscripcion.id,e).then((e=>{r.value=!1,u("reload")}))};return(e,n)=>{const i=t,o=l,u=a,c=s;return E(),I(u,{class:"h-100",size:"small",active:f.value},{default:H((()=>[U(c,{class:""},{default:H((()=>[U(i,{"inputs-step":y.value},null,8,["inputs-step"]),U(u,{class:"h-100",size:"small",active:r.value},{default:H((()=>[U(o,{color:"primary",onClick:h,size:"small"},{default:H((()=>[be])),_:1})])),_:1},8,["active"])])),_:1})])),_:1},8,["active"])}}});const ye=U("p",null,[U("b",null,"Cancel Suscription")],-1);var he=q({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const l=e,n=R(!1),i=()=>{n.value=!0,f(l.suscripcion.id,{}).then((e=>{n.value=!1,t("reload")})).catch((e=>{n.value=!1}))};return N((()=>{})),(e,t)=>{const l=s,o=a;return E(),I(o,{class:"h-100",size:"small",active:n.value},{default:H((()=>[U(l,{color:"danger",outlined:"",onClick:i,class:"\r\n        mr-4\r\n        btn-card\r\n        text-center\r\n        px-2\r\n        h-100\r\n        d-flex\r\n        align-items-center\r\n        justify-content-center\r\n      ",style:{"font-size":"14px"}},{default:H((()=>[ye])),_:1})])),_:1},8,["active"])}}});const xe={key:0},ge={key:1},Ye=U("small",null,"by default it will be scheduled for the next payment",-1),ke={class:"columns is-multiline"},De={class:"column is-4"},Me=U("p",{class:"title is-6 mb-1"},[U("b",null,"Total")],-1),Ce={class:"title is-3 mb-0"},je={class:"is-4 column mx-auto"},ze={class:"is-4 column mx-auto"};var Oe=q({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const l=e,n=R(!0),i=R(!1),o=(e=null)=>{i.value=!0,e&&(e.isProrrateo=n.value),y(l.suscripcion.id,e).then((e=>{i.value=!1,r.value=!1,c.success("Success"),t("reload")})).catch((e=>{console.log(e),c.error("Error"),i.value=!1,r.value=!1}))},r=R(!1),d=()=>{r.value=!1},m=B((()=>l.suscripcion.memberships_members.multigym));B((()=>l.suscripcion.presupuesto));const p=B((()=>l.suscripcion.user)),v=R(0),_=()=>{m.value?(n.value=!1,o()):(h(l.suscripcion.id,{}).then((e=>{v.value=e.data})),n.value=!0,r.value=!0)};return(e,t)=>{const l=s,c=ae,b=ne,f=ie,y=a,h=oe,x=ue,g=de;return E(),I(y,{class:"h-100",size:"small",active:i.value},{default:H((()=>[U(l,{color:"info",outlined:!G(m),onClick:_,class:"\r\n        mr-4\r\n        btn-card\r\n        text-center\r\n        px-2\r\n        h-100\r\n        d-flex\r\n        align-items-center\r\n        justify-content-center\r\n      ",style:{"font-size":"14px"}},{default:H((()=>[U("p",null,[G(m)?(E(),I("b",ge,"Disable MultiGym ")):(E(),I("b",xe,"Activate MultiGym "))])])),_:1},8,["outlined"]),U(g,{open:r.value,size:"big",actions:"center",onClose:d},{content:H((()=>[U(f,null,{default:H((()=>[U(b,null,{default:H((()=>[U(c,{modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=e=>n.value=e),label:"Make the prorated charge",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1}),X(U("p",null,[Ye],512),[[F,!n.value]]),n.value?(E(),I(l,{key:0,style:{"margin-bottom":"24px"}},{default:H((()=>[U("div",ke,[U("div",De,[U(y,{size:"small",class:"h-100",active:i.value},{default:H((()=>[U(l,{class:"mb-4 h-100"},{default:H((()=>[U("div",null,[Me,U("p",Ce,K(G(u)(v.value)),1)])])),_:1})])),_:1},8,["active"])]),U("div",je,[U(y,{size:"small",active:i.value},{default:H((()=>[U(h,{total:v.value,user:G(p),onOnPayment:o},null,8,["total","user"])])),_:1},8,["active"])]),U("div",ze,[U(y,{size:"small",active:i.value},{default:H((()=>[U(x,{total:v.value,onOnPayment:o},null,8,["total"])])),_:1},8,["active"])])])])),_:1})):W("",!0)])),action:H((()=>[])),_:1},8,["open"])])),_:1},8,["active"])}}});const Ae=U("p",null,[U("b",null,"HOLD Membership")],-1),Pe={key:0},Le=$("Active until: "),we=U("br",null,null,-1),Ve=U("label",{for:"hold_date_start"},[U("p",null,"Hold date start")],-1),Se=U("label",{for:"hold_date_end"},[U("p",null,"Hold date end")],-1),qe=$("Confirm");var Re=q({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const n=e,i=R(!1),o=R(!1),u=R(T(n.suscripcion.hold_date_start).format("YYYY-MM-DD")),r=R(T(n.suscripcion.hold_date_end).format("YYYY-MM-DD")),d=()=>{x(n.suscripcion.id,{hold_date_start:u.value,hold_date_end:r.value}).then((e=>{o.value=!1,c.success("success"),t("reload")})).catch((e=>{o.value=!1}))},m=B((()=>n.suscripcion.isHold));return N((()=>{})),(e,t)=>{const c=s,p=a,v=l,_=de;return E(),I(J,null,[U(p,{size:"small",class:"h-100",active:i.value},{default:H((()=>[U(c,{color:"warning",outlined:null==n.suscripcion.hold_date_end,onClick:t[1]||(t[1]=e=>G(m)?d():o.value=!0),class:"\r\n        mr-4\r\n        btn-card\r\n        text-center\r\n        h-100\r\n        px-2\r\n        d-flex\r\n        align-items-center\r\n        justify-content-center\r\n      ",style:{"font-size":"14px"}},{default:H((()=>[Ae,U("p",null,[null!=n.suscripcion.hold_date_end?(E(),I("span",Pe,[Le,we,$(" "+K(G(T)(n.suscripcion.hold_date_start).format("MM/DD/YYYY"))+" - "+K(G(T)(n.suscripcion.hold_date_end).format("MM/DD/YYYY")),1)])):W("",!0)])])),_:1},8,["outlined"])])),_:1},8,["active"]),U(_,{open:o.value,actions:"center",onClose:t[4]||(t[4]=e=>o.value=!1)},{content:H((()=>[Ve,X(U("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=e=>u.value=e),class:"input mt-2 mb-4"},null,512),[[Q,u.value]]),Se,X(U("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=e=>r.value=e),class:"input mt-2 mb-4"},null,512),[[Q,r.value]])])),action:H((()=>[U(v,{onClick:d,color:"primary",raised:""},{default:H((()=>[qe])),_:1})])),_:1},8,["open"])],64)}}});const Ne={class:"columns is-multiline"},Ee={class:"title is-4"},Ie={class:"title is-5 text-left mt-2"},Te={class:"d-flex justify-content-end mb-4"},He={key:0},Ue={key:1},$e=$("Accept and continue ");var Be=q({expose:[],props:{suscripcion:{type:Object,default:{}},is_config:{type:Boolean,default:!0},is_recurrence:{type:Boolean,default:!0},restar:{type:Number,default:{text:"",amount:""}},amounts_not_ids:{type:Array,default:[]}},emits:["update:modelValue","reload","onReady","changeMembership"],setup(e,{emit:o}){const r=e;ee();const d=R([]),m=R(!0),p=R(!1),v=R(!1);N((()=>{y.value=!0,g().then((e=>{d.value=e.data})),Y(1,"membership").then((e=>{i(k,"discount",e.data.discounts)}))}));const _=B((()=>{const e=d.value.find((e=>e.id==M.memberships_id));return null==e?void 0:e.amounts.filter((e=>e.is_recurrence==m.value&&null!=e.recurrencia))})),b=B((()=>{for(var e in M)null!=n(k.value,e)&&(M[e]=n(k.value,e).model);return M})),f=()=>{D.value=null,v.value=!1,p.value=!0,y.value=!0,C(b.value).then((e=>{D.value=e.data,o("update:modelValue",D.value),y.value=!0,setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight||document.documentElement.scrollHeight),p.value=!1}),300)})).catch((e=>{const s=e.response.data;for(var t in p.value=!1,s)if("object"==typeof s[t]&&"object"==typeof s[t])for(var l in s[t])c.error(s[t][l])}))},y=R(!0),h=()=>{v.value=!0;let e=b.value;o("onReady",e),y.value=!1};return Z((()=>M.memberships_id),(()=>{D.value=null,o("changeMembership")})),(e,n)=>{const i=s,o=a,v=ae,b=ne,x=ie,g=t,Y=l,C=me;return E(),I(J,null,[U(i,{class:"mb-4"},{default:H((()=>[U(o,{size:"large",active:!d.value.length},{default:H((()=>[U("div",Ne,[(E(!0),I(J,null,se(d.value,((e,s)=>(E(),I("div",{key:`membership-${s}`,class:"column is-4 btn btn-card",onClick:s=>G(M).memberships_id=e.id},[U(i,{color:G(M).memberships_id==e.id?"primary":void 0,class:"h-100"},{default:H((()=>[U("div",null,[U("h1",Ee,K(e.name),1)])])),_:2},1032,["color"])],8,["onClick"])))),128))])])),_:1},8,["active"])])),_:1}),U(i,{class:"mb-4"},{default:H((()=>[U("div",null,[r.is_recurrence?(E(),I(x,{key:0},{default:H((()=>[U(b,null,{default:H((()=>[U(v,{modelValue:m.value,"onUpdate:modelValue":n[1]||(n[1]=e=>m.value=e),label:"Recurring Subscription",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1})):W("",!0),(E(!0),I(J,null,se(G(_),((e,s)=>(E(),I("div",{key:`membership-precios-${s}`,class:"btn btn-card",onClick:s=>(e=>{r.amounts_not_ids.includes(e.id)?c.error("Select a membership with a higher price than the current one"):M.recurrences_id=e.id})(e)},[U(i,{color:G(M).recurrences_id==e.id?"primary":void 0,class:"mb-3 py-4"},{default:H((()=>[U("p",null,K(e.recurrencia.descriptions),1),U("p",Ie,K(G(u)(e.amount)),1)])),_:2},1032,["color"])],8,["onClick"])))),128))])])),_:1}),r.is_config?(E(),I(i,{key:0,class:""},{default:H((()=>[U(g,{"inputs-step":G(k)},null,8,["inputs-step"])])),_:1})):W("",!0),U("div",Te,[U(o,{size:"large",active:p.value},{default:H((()=>[U(Y,{onClick:f,color:G(D)?void 0:"primary",class:"d-flex justify-content-center mt-6 py-5 w-100",style:{"text-align":"center","text-transform":"uppercase","font-size":"20px","font-weight":"900"}},{default:H((()=>[G(D)?(E(),I("span",Ue," restart")):(E(),I("span",He,"start subscription"))])),_:1},8,["color"])])),_:1},8,["active"])]),G(D)?(E(),I(i,{key:1,class:"mb-4"},{default:H((()=>[U(C,{presupuesto:G(D),restar:r.restar},null,8,["presupuesto","restar"])])),_:1})):W("",!0),G(D)&&y.value?(E(),I(Y,{key:2,onClick:h,color:"primary",class:"d-flex justify-content-center py-5 px-6 ml-auto",style:{"text-align":"center","text-transform":"uppercase","font-size":"20px","font-weight":"900"}},{default:H((()=>[$e])),_:1})):W("",!0)],64)}}});const Ge={class:"columns is-multiline"},Xe={class:"column is-4"},Fe=U("p",{class:"title is-6 mb-1"},[U("b",null,"Total")],-1),Ke={class:"title is-3 mb-0"},We={key:0,class:"is-4 column mx-auto"},Je={key:1,class:"is-4 column mx-auto"},Qe={key:2,class:"is-4 column mx-auto"};var Ze=q({expose:[],props:{suscripcion:{type:Object,required:!0},amount:{type:Number,default:0},methods:{type:Array,default:[]},isLoaderActive:{type:Boolean,default:!1}},emits:["onPayment"],setup(e,{emit:t}){const l=e,n=B((()=>l.suscripcion.user)),i=(e=null)=>{t("onPayment",e)};return(t,o)=>{const c=s,r=a,d=oe,m=ue,p=ce;return E(),I(c,{style:{"margin-bottom":"24px"}},{default:H((()=>[U("div",Ge,[U("div",Xe,[U(r,{size:"small",class:"h-100",active:e.isLoaderActive},{default:H((()=>[U(c,{class:"mb-4 h-100"},{default:H((()=>[U("div",null,[Fe,U("p",Ke,K(G(u)(l.amount)),1)])])),_:1})])),_:1},8,["active"])]),l.methods.includes("debit_automatic")?(E(),I("div",We,[U(r,{size:"small",active:e.isLoaderActive},{default:H((()=>[U(d,{total:e.amount,user:G(n),onOnPayment:i},null,8,["total","user"])])),_:1},8,["active"])])):W("",!0),l.methods.includes("cash")?(E(),I("div",Je,[U(r,{size:"small",active:e.isLoaderActive},{default:H((()=>[U(m,{total:e.amount,onOnPayment:i},null,8,["total"])])),_:1},8,["active"])])):W("",!0),l.methods.includes("posnet")?(E(),I("div",Qe,[U(r,{size:"small",active:e.isLoaderActive},{default:H((()=>[U(p,{total:e.amount,onOnPayment:i,define_status:!0},null,8,["total"])])),_:1},8,["active"])])):W("",!0)])])),_:1})}}});const es=U("p",null,[U("b",null,"Upgrade Subscription")],-1),ss={class:"title is-7 mb-2"},ts=U("p",{class:"title is-7 mb-2"},"Remaining Amount",-1),ls={class:"title is-3"};var as=q({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const l=e,a=R(!1),n=te({next_payment_date:"",amount:0,amounts_not_ids:[]}),i=()=>{o.value=!0,j(l.suscripcion.id).then((e=>{n.next_payment_date=e.data.next_payment_date,n.amount=e.data.amount,n.amounts_not_ids=e.data.amounts_not_ids})).catch((e=>{}))};N((()=>{}));const o=R(!1),c=()=>{o.value=!1},r=R(null),d=e=>{r.value=e,console.log("ready",e),p.value=!0},m=R(null),p=R(!1),v=B((()=>{let e=m.value.total;return e-=n.amount,e<-0&&(e=0),e}));Z((()=>m.value),(e=>{p.value=!1})),Z(o,(e=>{console.log("cambia",e),z()}));const _=()=>{p.value=!1},b=e=>{const s=Object.assign({},e,r.value);a.value=!0,O(l.suscripcion.id,s).then((e=>{a.value=!1,c(),t("reload")})).catch((e=>{a.value=!1}))};return(e,t)=>{const r=s,f=Be,y=Ze,h=de;return E(),I(J,null,[U(r,{color:"primary",outlined:"",onClick:i,class:"\r\n      mr-4\r\n      btn-card\r\n      text-center\r\n      px-2\r\n      h-100\r\n      d-flex\r\n      align-items-center\r\n      justify-content-center\r\n    ",style:{"font-size":"14px"}},{default:H((()=>[es])),_:1}),U(h,{open:o.value,size:"big",actions:"center",onClose:c},{content:H((()=>[U("div",null,[U(r,{class:"mb-4"},{default:H((()=>[U("p",ss," Next payment date: "+K(G(T)(G(n).next_payment_date,"MM-DD-YYYY").format("MM-DD-YYYY")),1),ts,U("p",ls,K(G(u)(G(n).amount)),1)])),_:1}),U(f,{onOnReady:d,modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),onChangeMembership:_,is_config:!1,is_recurrence:!1,restar:{text:"Remaining Amount",amount:G(n).amount},amounts_not_ids:G(n).amounts_not_ids,class:"mb-4"},null,8,["modelValue","restar","amounts_not_ids"]),p.value?(E(),I(y,{key:0,methods:["debit_automatic","cash","terminal"],suscripcion:l.suscripcion,amount:G(v),"is-loader-active":a.value,onOnPayment:b,class:"mt-4"},null,8,["suscripcion","amount","is-loader-active"])):W("",!0)])])),action:H((()=>[])),_:1},8,["open"])],64)}}});const ns=U("p",null,[U("b",null," Balances ")],-1),is={class:"columns"},os={class:"column is-4"},us=U("p",{class:"title is-6 mb-1"},[U("b",null,"Total")],-1),cs={class:"title is-3 mb-0"},rs=U("label",{for:""},[U("p",null,"Amount")],-1),ds={class:"columns is-multiline"},ms={class:"column is-4"},ps=U("p",{class:"title is-6 mb-1"},[U("b",null,"Total")],-1),vs={class:"title is-3 mb-0"},_s={class:"is-4 column mx-auto"},bs={class:"is-4 column mx-auto"},fs={class:"table is-hoverable is-fullwidth"},ys=U("thead",null,[U("tr",null,[U("th",{scope:"col"},"Amount"),U("th",{scope:"col"},"Date")])],-1);var hs=q({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:t}){const l=e,n=R(null),i=R(!1),o=(e=null)=>{i.value=!0,e.amount=n.value,console.log(e),pe(m.value.id,e).then((e=>{i.value=!1,r.value=!1,c.success("Success"),t("reload")})).catch((e=>{e=e.response.data,i.value=!1,r.value=!1}))},r=R(!1),d=()=>{r.value=!1},m=B((()=>l.suscripcion.user)),p=R(0),v=R([]),_=()=>{ve(m.value.id).then((e=>{p.value=e.data.saldo,v.value=e.data.saldos,r.value=!0}))};return(e,t)=>{const l=s,c=a,b=ne,f=ie,y=oe,h=ue,x=de;return E(),I(c,{class:"h-100",size:"small",active:i.value},{default:H((()=>[U(l,{color:"info",outlined:!0,onClick:_,class:"\r\n        mr-4\r\n        btn-card\r\n        text-center\r\n        px-2\r\n        h-100\r\n        d-flex\r\n        align-items-center\r\n        justify-content-center\r\n      ",style:{"font-size":"14px"}},{default:H((()=>[ns])),_:1}),U(x,{open:r.value,size:"big",actions:"center",onClose:d},{content:H((()=>[U("div",is,[U("div",os,[U(c,{size:"small",class:"h-100",active:i.value},{default:H((()=>[U(l,{class:"mb-4 h-100"},{default:H((()=>[U("div",null,[us,U("p",cs,K(G(u)(p.value)),1)])])),_:1})])),_:1},8,["active"])]),U(f,{class:"is-8 column"},{default:H((()=>[U(b,{style:{height:"100%"}},{default:H((()=>[rs,X(U("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=e=>n.value=e),class:"input mt-4",placeholder:"0.00",style:{height:"60%","font-size":"20px"}},null,512),[[Q,n.value]])])),_:1})])),_:1})]),U(l,{style:{"margin-bottom":"24px"}},{default:H((()=>[U("div",ds,[U("div",ms,[U(c,{size:"small",class:"h-100",active:i.value},{default:H((()=>[U(l,{class:"mb-4 h-100"},{default:H((()=>[U("div",null,[ps,U("p",vs,K(G(u)(n.value)),1)])])),_:1})])),_:1},8,["active"])]),U("div",_s,[U(c,{size:"small",active:i.value},{default:H((()=>[U(y,{total:n.value,user:G(m),onOnPayment:o},null,8,["total","user"])])),_:1},8,["active"])]),U("div",bs,[U(c,{size:"small",active:i.value},{default:H((()=>[U(h,{total:n.value,onOnPayment:o},null,8,["total"])])),_:1},8,["active"])])])])),_:1}),U(l,null,{default:H((()=>[U("table",fs,[ys,U("tbody",null,[(E(!0),I(J,null,se(v.value,((e,s)=>(E(),I("tr",{key:`saldo-${s}`},[U("td",null,K(G(u)(e.monto)),1),U("td",null,K(G(T)(e.created_at).format("MM-DD-YYYY")),1)])))),128))])])])),_:1})])),action:H((()=>[])),_:1},8,["open"])])),_:1},8,["active"])}}});const xs=U("p",null,[U("b",null," Invoices ")],-1),gs=U("p",{class:"title is-5"},"Invoices",-1),Ys={class:"table is-hoverable is-fullwidth"},ks=U("thead",null,[U("tr",{class:"has-background-grey-dark"},[U("th",{scope:"col"},"ID"),U("th",{scope:"col"},"Amount"),U("th",{scope:"col"},"Date"),U("th",{scope:"col"},"Status"),U("th",{scope:"col"},"Status Description"),U("th",{scope:"col"},"Payment Type")])],-1);var Ds=q({expose:[],props:{suscripcion:{type:Object,required:!0}},setup(e){const t=e,l=R(!1),n=R(!1),i=()=>{l.value=!1},o=B((()=>t.suscripcion.memberships_members&&t.suscripcion.memberships_members.payments?t.suscripcion.memberships_members.payments:[]));return R(null),(e,t)=>{const u=s,c=de,r=a;return E(),I(r,{class:"h-100",size:"small",active:n.value},{default:H((()=>[U(u,{color:"orange",outlined:!0,onClick:t[1]||(t[1]=e=>l.value=!0),class:"\r\n        mr-4\r\n        btn-card\r\n        text-center\r\n        px-2\r\n        h-100\r\n        d-flex\r\n        align-items-center\r\n        justify-content-center\r\n      ",style:{"font-size":"14px"}},{default:H((()=>[xs])),_:1}),U(c,{open:l.value,size:"big",actions:"center",onClose:i},{content:H((()=>[U("div",null,[gs,U("table",Ys,[ks,(E(!0),I(J,null,se(G(o),((e,s)=>(E(),I("tbody",{key:`incoide-${s}`},[U("tr",null,[U("td",null,[U("p",null,K(e.id),1)]),U("td",null,[U("p",null,K(e.amount),1)]),U("td",null,[U("p",null,K(e.created_ad),1)]),U("td",null,[U("p",null,K(1==e.status?"Paid":"Error"),1)]),U("td",null,[U("p",null,K(e.status_description),1)]),U("td",null,[U("p",null,K(e.payment_type.name),1)])]),(E(!0),I(J,null,se(e.items,((e,s)=>(E(),I("tr",{key:`item-${s}`},[U("td",null,K(e.description)+" "+K(e.type),1),U("td",null,K(e.amount),1)])))),128))])))),128))])])])),action:H((()=>[])),_:1},8,["open"])])),_:1},8,["active"])}}});const Ms=U("p",{class:"title is-4 mt-4"},"New subscription",-1);var Cs=q({expose:[],props:{suscripcion:{type:Object,required:!0},type:{type:String,default:"new"}},emits:["reload"],setup(e,{emit:s}){const t=e,l=R(!1),a=te({next_payment_date:"",amount:0,amounts_not_ids:[]}),n=R(null),i=e=>{n.value=e,console.log("ready",e),u.value=!0},o=R(null),u=R(!1);B((()=>{let e=o.value.total;return e-=a.amount,e<-0&&(e=0),e})),Z((()=>o.value),(e=>{u.value=!1}));const c=()=>{u.value=!1},r=e=>{const a=Object.assign({},e,n.value);l.value=!0,"reprocess"==t.type&&A(t.suscripcion.id,a).then((e=>{l.value=!1,s("reload")})).catch((e=>{}))};return(e,s)=>{const a=Be,n=Ze;return E(),I("div",null,[Ms,U(a,{onOnReady:i,modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=e=>o.value=e),onChangeMembership:c,class:"mb-4"},null,8,["modelValue"]),u.value&&o.value?(E(),I(n,{key:0,methods:["debit_automatic","cash","terminal"],suscripcion:t.suscripcion,amount:o.value.total,"is-loader-active":l.value,onOnPayment:r,class:"mt-4"},null,8,["suscripcion","amount","is-loader-active"])):W("",!0)])}}});const js={class:"columns is-multiline",style:{"min-height":"350px"}},zs={class:"column is-3"},Os=U("p",{class:"title is-6 mb-1"},[U("b",null,"Total")],-1),As={key:0,class:"title is-3 mb-0"},Ps={key:1,class:"title is-3 mb-0"},Ls=U("div",{class:"column is-9"},null,-1),ws=$("] "),Vs={key:0,class:"is-4 column mx-auto"},Ss={key:1,class:"is-4 column mx-auto"},qs={key:2,class:"is-4 column mx-auto"},Rs={key:3,class:"is-4 column mx-auto"},Ns=U("div",{class:"mb-4 column is-12"},null,-1);var Es=q({expose:[],props:{total:{type:Number,default:0,required:!0},user:{type:Object,default:{},required:!0},suscripcion_id:{type:Number,required:!0},metodos:{type:Array,default:["stripe-debit","cash","posnet"]}},emits:["proccessCheckout","reload"],setup(e,{emit:t}){const l=e;ee();const n=R(!1),i=e=>{n.value=!0,P(l.suscripcion_id,e).then((e=>{n.value=!1,t("proccessCheckout")})).catch((e=>{if(n.value=!1,t("reload"),"object"==typeof e.response.data)for(var s in e.response.data)if("object"==typeof e.response.data[s])for(var l in e.response.data[s]){if("object"==typeof e.response.data[s][l])for(var a in e.response.data[s][l])c.error(e.response.data[s][l][a]);"string"==typeof e.response.data[s][l]&&c.error(e.response.data[s][l])}}))};return(t,o)=>{const c=s,r=a,d=oe,m=re,p=ue,v=ce;return E(),I("div",js,[U("div",zs,[U(r,{size:"small",active:n.value},{default:H((()=>[U(c,{class:"mb-4"},{default:H((()=>[le(t.$slots,"default"),U("div",null,[Os,t.order?(E(),I("p",As,K(G(u)(e.total)),1)):(E(),I("p",Ps,K(G(u)(e.total)),1))])])),_:3})])),_:1},8,["active"])]),Ls,ws,l.metodos.includes("stripe-debit")?(E(),I("div",Vs,[U(r,{size:"small",active:n.value},{default:H((()=>[U(d,{total:l.total,user:l.user,onOnPayment:i},null,8,["total","user"])])),_:1},8,["active"])])):W("",!0),l.metodos.includes("stripe-checkout")?(E(),I("div",Ss,[U(r,{size:"small",active:n.value},{default:H((()=>[U(m,{total:l.total,onOnPayment:i},null,8,["total"])])),_:1},8,["active"])])):W("",!0),l.metodos.includes("cash")?(E(),I("div",qs,[U(r,{size:"small",active:n.value},{default:H((()=>[U(p,{total:l.total,onOnPayment:i},null,8,["total"])])),_:1},8,["active"])])):W("",!0),l.metodos.includes("posnet")?(E(),I("div",Rs,[U(r,{size:"small",active:n.value},{default:H((()=>[U(v,{total:l.total,onOnPayment:i,define_status:!0},null,8,["total"])])),_:1},8,["active"])])):W("",!0),Ns])}}});const Is={class:"w-100",style:{"min-height":"200px"}},Ts={key:0,class:"h-100 w-100"},Hs={key:0},Us={key:0,class:""},$s={style:{"font-size":"12px"}},Bs={style:{"font-size":"12px"}},Gs={key:1,class:""},Xs={style:{"font-size":"12px"}},Fs={style:{"font-size":"12px"}},Ks={class:"d-flex justify-content-between"},Ws={class:"title is-5 mb-0"},Js=$("Membership: "),Qs=$(" Current billing location: "),Zs={class:"title is-4 mb-0"},et={key:0},st={class:"text-right"},tt=U("b",null,"Payment Method:",-1),lt={key:0},at={key:0,class:"title is-4 mb-0"},nt=U("br",null,null,-1),it={key:1,class:"title is-4 mb-0"},ot=U("br",null,null,-1),ut={key:2,class:"title is-6"},ct=U("br",null,null,-1),rt={key:1},dt=U("p",null,"no tiene presupuesto",-1),mt={class:"d-flex flex-row mt-4"},pt={class:"mr-3"},vt=U("b",null,"Consultation date: ",-1),_t={class:"mr-3"},bt=U("b",null,"Created date: ",-1),ft={class:"mr-3"},yt=U("b",null,"Start date: ",-1),ht={class:"mr-3"},xt=U("b",null,"Month: ",-1),gt={key:0,class:"mr-3"},Yt=U("b",null,"Start: ",-1),kt={class:"mr-3"},Dt=U("b",null,"Next payment date: ",-1),Mt={key:1,class:"mr-3"},Ct=U("b",null,"Cancellation Date: ",-1),jt={key:2,class:"mr-3"},zt=U("b",null,"Last payment attempt: ",-1),Ot={key:3,class:"mr-3"},At=U("b",null,"Status Last payment attempt: ",-1),Pt={key:4,class:"d-flex"},Lt={class:"mr-3"},wt=U("b",null,"Months late: ",-1),Vt={class:"mr-3"},St=U("b",null,"Days late: ",-1),qt={class:"mr-3"},Rt=U("b",null,"Hours late: ",-1),Nt=U("i",{style:{color:"white"},class:"fa fa-exclamation-triangle mr-4"},null,-1),Et={style:{"font-size":"10px"}},It=U("b",null," Intent:",-1),Tt={key:0,style:{"font-size":"10px"}},Ht={style:{"font-size":"10px"}},Ut={key:0,class:"columns"},$t={class:"column is-8 pt-0"},Bt={class:"column is-4"},Gt={class:"column is-12"},Xt={class:"column is-12"},Ft={class:"column is-12"},Kt={class:"column is-12"},Wt={class:"column is-12"},Jt={class:"column is-12"},Qt={class:"column is-12"},Zt={key:2};var el=q({expose:[],props:{suscripcion:{type:Object,default:null},suscripcion_id:{type:Number,default:null},member_id:{type:Number,default:null},code:{type:String,default:null}},setup(t){const l=t,n=ee(),i=R(null),o=R(!1),c=R(!1),d=()=>{Object.assign(M,L),c.value=!0;let e=null;n.query.id&&(e=n.query.id),l.member_id&&(e=l.member_id),l.suscripcion_id?w(l.suscripcion_id,!1).then((e=>{i.value=e.data.suscripcion,c.value=!1})):null==e&&l.code?V(l.code).then((e=>{i.value=e.data.suscripcion,c.value=!1})):w(e,!0).then((e=>{i.value=e.data.suscripcion,c.value=!1}))},m=B((()=>l.suscripcion?l.suscripcion:i.value));N((()=>{d()})),Z((()=>l.member_id),(()=>{d()}));const p=()=>{d()};return(t,l)=>{const n=e,i=s,v=fe,_=he,b=Oe,f=Re,y=as,h=hs,x=oe,g=a,Y=Ds,k=Cs,D=Es,M=me;return E(),I(g,{size:"small",active:c.value},{default:H((()=>[U("div",Is,[G(m)?(E(),I("div",Ts,[U(i,{class:"mb-4 d-flex align-items-center"},{default:H((()=>[G(m).member?(E(),I("div",Hs,[U(n,{picture:`${G(r)}storage/${G(m).member.photo}`,color:"primary",initials:G(_e)(G(m).member.name,G(m).member.last_name),size:"medium",class:"mr-4 mb-4"},null,8,["picture","initials"])])):W("",!0),U("div",null,[G(m).member?(E(),I("div",Gs,[U("p",Xs,K(G(m).member.name)+" "+K(G(m).member.last_name),1),U("p",Fs,K(G(m).member.email),1)])):(E(),I("div",Us,[U("p",$s," Username: "+K(G(m).user.name),1),U("p",Bs," Email: "+K(G(m).user.email),1)]))])])),_:1}),U(i,{class:"mb-5",style:{background:G(m).estado.color}},{default:H((()=>[U("div",Ks,[U("span",null,[U("p",Ws," ESTADO : "+K(G(m).estado.estado_pago),1),U("p",null,[U("small",null,[Js,U("small",null,[Qs,U("b",null,K(G(m).memberships_members.location.name),1)])])]),U("p",Zs,K(G(m).membership.name),1),G(m).recurrence?(E(),I("p",et,K(G(m).recurrence.recurrencia.descriptions),1)):W("",!0)]),U("span",st,[U("p",null,[U("small",null,[tt,$(" "+K(G(m).payment_type.name),1)])]),U("p",null,[U("small",null,K(G(m).is_recurrence?"Recurrence":"no recurrence"),1)]),G(m).presupuesto?(E(),I("span",lt,[G(m).discount?(E(),I("p",it,[$(K(G(u)(G(m).presupuesto.total)),1),ot])):(E(),I("p",at,[$(K(G(u)(G(m).presupuesto.recurrente)),1),nt])),G(m).discount?(E(),I("p",ut,[U("small",null,K(G(m).discount.name),1),$(" : "+K(G(u)(G(m).presupuesto.total)),1),ct])):W("",!0)])):(E(),I("span",rt,[dt]))])]),U("div",mt,[U("p",pt,[vt,$(" "+K(G(T)(G(m).estado.fecha_validacion,"YYYY-MM-DD").format("MM-DD-YYYY")),1)]),U("p",_t,[bt,$(" "+K(G(T)(G(m).estado.fecha_creacion,"YYYY-MM-DD").format("MM-DD-YYYY")),1)]),U("p",ft,[yt,$(" "+K(G(T)(G(m).estado.fecha_inicio,"YYYY-MM-DD").format("MM-DD-YYYY")),1)]),U("p",ht,[xt,$(" "+K(G(m).estado.meses_pagados),1)]),G(m).schedules_start?(E(),I("p",gt,[Yt,$(" "+K(G(T)(G(m).schedules_start,"YYYY-MM-DD").format("MM-DD-YYYY")),1)])):W("",!0),U("p",kt,[Dt,$(" "+K(G(T)(G(m).estado.fecha_vencimiento,"YYYY-MM-DD").format("MM-DD-YYYY")),1)]),G(m).estado.fecha_suspencion?(E(),I("p",Mt,[Ct,$(" "+K(G(T)(G(m).estado.fecha_suspencion,"YYYY-MM-DD").format("MM-DD-YYYY")),1)])):W("",!0),G(m).memberships_members.payments.length?(E(),I("p",jt,[zt,$(" "+K(G(T)(G(m).memberships_members.payments[0].created_at).format("MM-DD-YYYY")),1)])):W("",!0),G(m).memberships_members.payments.length?(E(),I("p",Ot,[At,$(" "+K(G(m).memberships_members.payments[0].status)+" / "+K(G(m).memberships_members.payments[0].status_description),1)])):W("",!0),"VENCIDO"==G(m).estado.estado_pago?(E(),I("div",Pt,[U("p",Lt,[wt,$(" "+K(G(m).estado.meses_retraso),1)]),U("p",Vt,[St,$(" "+K(G(m).estado.dias_retraso),1)]),U("p",qt,[Rt,$(" "+K(G(m).estado.horas_retraso),1)])])):W("",!0)]),G(m).estado.alerta?(E(),I(i,{key:0,class:"mt-4"},{default:H((()=>[(E(!0),I(J,null,se(G(m).estado.alerta,((e,s)=>(E(),I("div",{key:`alter-${s}`,class:"d-flex w-100"},[Nt,U("p",null,K(e),1)])))),128))])),_:1})):W("",!0),G(m).estado.ultimo_intento?(E(),I(i,{key:1,class:"px-3 py-2"},{default:H((()=>[U("p",Et,[U("b",null,"Status: "+K(G(S).find((e=>e.value==G(m).estado.ultimo_intento.estado)).name),1),It,$(" "+K(G(m).estado.ultimo_intento.intento),1)]),"pagado"!=G(m).estado.ultimo_intento.estado?(E(),I("p",Tt,K(G(m).estado.ultimo_intento.pago_id),1)):W("",!0),U("p",Ht," Date: "+K(G(m).estado.ultimo_intento.fecha),1)])),_:1})):W("",!0)])),_:1},8,["style"]),["PROX. CANCELADO","CANCELADO"].includes(G(m).estado.estado_pago)?W("",!0):(E(),I("div",Ut,[U("div",$t,[U(v,{suscripcion:G(m),onReload:d},null,8,["suscripcion"])]),U("div",Bt,["CANCELADO"!=G(m).estado.estado_pago?(E(),I(i,{key:0,class:"columns is-multiline p-1"},{default:H((()=>[U("div",Gt,[U(_,{suscripcion:G(m),onReload:d},null,8,["suscripcion"])]),U("div",Xt,[U(b,{suscripcion:G(m),onReload:d},null,8,["suscripcion"])]),U("div",Ft,[U(f,{suscripcion:G(m),onReload:d},null,8,["suscripcion"])]),U("div",Kt,[U(y,{suscripcion:G(m),onReload:d},null,8,["suscripcion"])]),U("div",Wt,[U(h,{suscripcion:G(m),onReload:d},null,8,["suscripcion"])]),U("div",Jt,[U(g,{size:"small",active:o.value},{default:H((()=>[U(x,{total:0,card:!0,user:G(m).user,onOnPayment:d},null,8,["user"])])),_:1},8,["active"])]),U("div",Qt,[U(Y,{suscripcion:G(m)},null,8,["suscripcion"])])])),_:1})):W("",!0)])])),G(m)&&["CANCELADO","PROX. CANCELADO"].includes(G(m).estado.estado_pago)?(E(),I(k,{key:1,suscripcion:G(m),type:"reprocess",onReload:d},null,8,["suscripcion"])):W("",!0),["CANCELADO","PROX. CANCELADO","HOLD"].includes(G(m).estado.estado_pago)?W("",!0):(E(),I("div",Zt,[G(m)&&G(m).presupuesto&&"PAGADO"!=G(m).estado.estado_pago?(E(),I(D,{key:0,total:G(m).presupuesto.total,user:G(m).user,suscripcion_id:G(m).id,onProccessCheckout:p,onReload:d},null,8,["total","user","suscripcion_id"])):W("",!0),G(m)&&G(m).presupuesto&&"PAGADO"!=G(m).estado.estado_pago?(E(),I(i,{key:1},{default:H((()=>[U(M,{presupuesto:G(m).presupuesto},null,8,["presupuesto"])])),_:1})):W("",!0)]))])):W("",!0)])])),_:1},8,["active"])}}});export{el as _};
