import{_ as e}from"./V-Button.vue_vue&type=script&setup=true&lang.19e0de69.js";import{_ as t}from"./V-Loader.vue_vue&type=script&setup=true&lang.ee9a9239.js";import{_ as a}from"./V-Card.vue_vue&type=script&setup=true&lang.3e73d9de.js";import{_ as s}from"./V-Control.46cc2837.js";import{_ as l}from"./V-Field.vue_vue&type=script&setup=true&lang.5cab5a8d.js";import{_ as r}from"./V-Modal.vue_vue&type=script&setup=true&lang.b53d2d79.js";import{d as n,r as u,b as i,o,h as c,k as m,j as p,Q as d,F as v,D as y,E as b,R as _,S as f,Y as h,G as g,J as x,w as k,U as j,a8 as C,K as S}from"./vendor.d0c8bc4f.js";import{m as w,b as $,P,A as M,n as q,g as A,p as F}from"./index.8e1175a7.js";import{c as V}from"./Companies.8be077da.js";import{_ as N}from"./MemberCards.vue_vue&type=script&setup=true&lang.d9638379.js";import{_ as I}from"./V-Placeload.ba28fd33.js";import{_ as O}from"./signComponent.vue_vue&type=script&setup=true&lang.9e07ebd1.js";import{B,C as E,s as z,F as D,D as R,E as T}from"./Members.8cde6448.js";const U=m("p",{class:"title is-3"},[m("i",{class:"fas fa-money-bill","aria-hidden":"true"})],-1),Q=m("p",{class:"title is-5"},"Cash",-1),G={class:"d-flex mb-4 justify-content-between"},J={class:"title is-5"},K=b(" Total: "),L={class:"title is-5"},Y=b(" Cash Total: "),H={class:"\n          d-flex\n          justify-content-center\n          align-items-center\n          flex-column\n          mb-4\n        "},W=m("p",{class:"title is-5 mb-4"},"Change Back:",-1),X={class:"title is-3 mb-0"},Z={class:"d-flex justify-content-center flex-wrap mb-4"},ee=m("div",{class:"w-100"},null,-1),te={class:"d-flex justify-content-center"},ae=b("Reset"),se=b("Confirm");var le=n({expose:[],props:{total:{type:[Number,String],default:0}},emits:["onPaymentCash"],setup(t,{emit:n}){const g=t,x=u(!1),k=u(0),j=i((()=>{const e=parseFloat(k.value)-parseFloat(g.total/100);return e>0?e:0})),C=()=>{x.value=!1,n("onPaymentCash",{changeBack:j.value,cash:k.value})};return(n,u)=>{const i=a,g=e,S=s,$=l,P=r;return o(),c(d,null,[m(i,{color:"warning",class:"mx-2 btn-card w-100 justify-content-center column is-4",onClick:u[1]||(u[1]=e=>x.value=!0)},{default:p((()=>[U,Q])),_:1}),m(P,{title:"",open:x.value,actions:"center",onClose:u[5]||(u[5]=e=>x.value=!1)},{content:p((()=>[m("div",G,[m("p",J,[K,m("b",null,v(y(w)(t.total/100)),1)]),m("p",L,[Y,m("b",null,v(y(w)(k.value)),1)])]),m("div",H,[W,m("p",X,[m("b",null,v(y(w)(y(j))),1)])]),m("div",Z,[m(g,{bold:"",class:"m-3",style:{"font-size":"14px"},onClick:u[2]||(u[2]=e=>k.value=t.total/100)},{default:p((()=>[b(" Full Payment "+v(y(w)(t.total/100)),1)])),_:1}),ee,(o(),c(d,null,_([5,10,20,50,100],((e,t)=>m(g,{key:`calculato-${t}`,bold:"",class:"m-3",style:{"font-size":"14px"},onClick:t=>(e=>{k.value=parseFloat(k.value)+parseFloat(e)})(e)},{default:p((()=>[b(" $"+v(e),1)])),_:2},1032,["onClick"]))),64))]),m("div",te,[m($,null,{default:p((()=>[m(S,null,{default:p((()=>[f(m("input",{"onUpdate:modelValue":u[3]||(u[3]=e=>k.value=e),type:"text",class:"input text-center",placeholder:"Cash"},null,512),[[h,k.value]])])),_:1})])),_:1})])])),action:p((()=>[m(g,{onClick:u[4]||(u[4]=e=>k.value=0),class:"d-flex justify-content-center",raised:""},{default:p((()=>[ae])),_:1}),m(g,{color:"success",onClick:C,disabled:t.total/100>k.value,class:"d-flex justify-content-center",raised:""},{default:p((()=>[se])),_:1},8,["disabled"])])),_:1},8,["open"])],64)}}});const re={class:"d-flex justify-content-between align-items-start"},ne=m("div",null,[m("p",{class:"title is-3"},[m("i",{class:"fas fa-receipt",style:{color:"white !important"},"aria-hidden":"true"})]),m("p",{class:"title is-5",style:{color:"white !important"}},"View Order")],-1),ue={key:0,class:"title is-6"},ie=m("i",{class:"fas fa-check","aria-hidden":"true"},null,-1);var oe=n({expose:[],props:{membership_member:{type:[Number,String],default:0}},setup(e){const t=e,s=u(!1);return g((()=>{})),(e,l)=>{const n=a,u=r;return o(),c(d,null,[m(n,{style:{background:"#388e3c"},class:"mx-2 mx-auto mt-4 is-4 column btn-card justify-content-center",onClick:l[1]||(l[1]=e=>s.value=!0)},{default:p((()=>[m("div",re,[ne,e.openModalRecibo?(o(),c("p",ue,[ie])):x("",!0)])])),_:1}),m(u,{title:"",open:s.value,actions:"center",onClose:l[2]||(l[2]=e=>s.value=!1)},{content:p((()=>[m("iframe",{src:`${y($)}ticket_membership/${t.membership_member}?companie_id=${y(V).id}`,width:"100%",height:"500px",frameborder:"0"},null,8,["src"]),m("a",{href:`${y($)}/ticket_membership/${t.membership_member}?companie_id=${y(V).id}`},"Open",8,["href"])])),action:p((()=>[])),_:1},8,["open"])],64)}}});const ce=m("div",{id:"payment-element"},null,-1),me=b("Pay now "),pe=m("div",{id:"payment-message",class:"hidden"},null,-1);var de=n({expose:[],props:{amount:{type:[Number,String],required:!0},id:{type:Number,required:!0},url:{type:String,default:"stripe"},member_membership:{type:Number,default:0},variosMiembros:{type:Boolean,default:!1},miembros:{type:Array,default:[]}},emits:["PaymentAction"],setup(s,{emit:l}){const r=s,n=Stripe(P.value);k((()=>r.id),(e=>{v.value=!0,A()}));const v=u(!0);u({id:r.id,amount:r.amount});const y=u(),b=i((()=>"stripe"!=r.url?{payment_type_id:3,amount:r.amount}:{id:r.id,member_mermship_id:r.member_membership,amount:r.amount,payment_type_id:1}));u(null);const _=u(null),S=u(null),w=u(!1),$=u(null),A=async()=>{let e=await M.post(r.url,b.value).then((e=>{_.value=e.data.clientSecret,$.value=e.data.user_id,y.value=n.elements({clientSecret:_.value,appearance:{theme:"night",rules:{".Input":{boxShadow:"none"}}}}),S.value=y.value.create("card",{classes:{base:"base_card"}}),S.value.mount("#payment-element")})).catch((e=>{v.value=!1}));return v.value=!1,e},F=u(null),V=async e=>{e.preventDefault(),w.value=!0;const{setupIntent:t,error:a}=await n.confirmCardSetup(_.value,{payment_method:{card:S.value,billing_details:{name:F.value}}});if(a)w.value=!1,q.error(a.message);else{const{payment_method:e}=t;r.variosMiembros?r.miembros.forEach((t=>{M.post("paymentStripe",{payment_method:e,user_id:t.idMember,membership_member_id:t.idMemberMembership,payment_type_id:3}).catch((e=>{w.value=!1}))})):await M.post("paymentStripe",{payment_method:e,amount:r.amount,user_id:$.value,membership_member_id:r.member_membership,payment_type_id:3}).catch((e=>{w.value=!1})),b.value&&(l("PaymentAction",b),q.success("Success Payment"))}w.value=!1};return g((()=>{w.value=!1,A()})),(s,l)=>{const r=I,n=e,u=t,i=a;return o(),c(d,null,[v.value?(o(),c(r,{key:0,height:"200px",class:"mt-6"})):x("",!0),f(m(i,{class:"mt-6"},{default:p((()=>[m("form",{onSubmit:C(V,["prevent"]),id:"payment-form"},[f(m("input",{id:"card-holder-name",class:"input mb-3","onUpdate:modelValue":l[1]||(l[1]=e=>F.value=e),placeholder:"Name",type:"text"},null,512),[[h,F.value]]),ce,m(u,{size:"small",active:w.value},{default:p((()=>[m(n,{id:"submit",class:"mt-4",color:"info"},{default:p((()=>[me])),_:1})])),_:1},8,["active"]),pe],40,["onSubmit"])])),_:1},512),[[j,!v.value]])],64)}}});const ve={class:"w-100"},ye={class:"my-4"},be={key:0},_e=m("small",null,"Register the principal first",-1),fe=b(" Process Membership "),he=b(" Process Membership "),ge={key:0,class:"columns is-multiline justify-content-center mt-6"},xe={class:"d-flex justify-content-between align-items-start"},ke=m("div",null,[m("p",{class:"title is-3"},[m("i",{class:"fas fa-credit-card","aria-hidden":"true"})]),m("p",{class:"title is-5"},"Debit Automatic")],-1),je={key:0,class:"title is-6"},Ce=m("i",{class:"fas fa-check","aria-hidden":"true"},null,-1),Se={class:"columns is-multiline justify-content-center mt-6"},we=m("p",{class:"title is-4"},"Payment Success",-1);var $e=n({expose:[],props:{member:{type:Array,required:!0},member_id:{type:Number,default:0},membresia:{type:Array,required:!0},contact:{type:Array,required:!0},presupuesto_id:{type:String},total:{type:[String,Number],required:!0},categoriesMembers:{type:Object,required:!0},notasInput:{type:Object,required:!0},type:{type:String,default:"create"}},emits:["PaymentAction"],setup(s,{emit:l}){const r=s,n=u(null),d=u(!1),b=u(null),_=u(null);g((()=>{d.value=!1,h.value=!1}));const f=()=>{n.value=null,d.value=!0,b.value=r.member.id,_.value=null;const e=F(r.membresia);e.members_id=r.member_id,e.total=r.total,e.payment_type_id=3,T(e).then((e=>{b.value=e.data.id,_.value=e.data.membership_members_id,q.success("Success"),d.value=!1})).catch((e=>{for(var t in e.response.data.errores)e.response.data.errores[t].forEach((e=>{q.error(`${t}: ${e}`)}))}))},h=u(!1),k=e=>{h.value=!0,l("PaymentAction",e)},j=i((()=>0==A(r.member,"is_family").model)),C=i((()=>!h.value&&!(!j.value&&!B.value))),S=e=>{E(e,_.value).then((e=>{if(e.data.status)q.success("Sign Success");else for(var t in q.error(e.data.mensaje),e.data.errores)e.data.errores[t].forEach((e=>{q.error(`${t} : ${e}`)}))})).catch((e=>{}))},w=e=>{if(n.value=1,_.value){const t={cash:e.cash,payment_type_id:n.value,total:r.total,cash_back:e.changeBack,membership_member_id:_.value};z(_.value,t).then((e=>{k(b.value),q.success("Success Payment")})).catch((e=>{console.log(e.response)}))}else q.error("The membership ID is required. Click on Process Membership to generate it automatically")},$=e=>{d.value=!0,D({payment_method:e,amount:r.total,user_id:b.value,membership_member_id:_.value,payment_type_id:3}).then((e=>{k(b.value),q.success("Success"),d.value=!1})).catch((e=>{for(var t in e.response.data.errores)e.response.data.errores[t].forEach((e=>{q.error(`${t}: ${e}`)}))}))};return(s,l)=>{const u=e,i=t,g=a,P=le,M=oe,q=N,F=de,V=O;return o(),c("div",ve,[m("div",ye,[m("p",null,v(y(A)(r.member,"name").model)+" "+v(y(A)(r.member,"last_name").model),1),m("p",null,[m("small",null,v(y(j)?"Main member":"Family"),1)]),y(j)||y(B)?x("",!0):(o(),c("p",be,[_e]))]),m(i,{size:"small",active:d.value},{default:p((()=>["create"==r.type?(o(),c(u,{key:0,color:"success",onClick:l[1]||(l[1]=e=>y(C)?(n.value=null,d.value=!0,b.value=null,_.value=null,R({member:r.member,contact:r.contact,membresia:r.membresia,total:r.total,categoriesMembers:r.categoriesMembers,notasInput:r.notasInput,presupuesto_id:r.presupuesto_id}).then((e=>{b.value=e.data.id,_.value=e.data.membership_members_id})).catch((e=>{})),void(d.value=!1)):null),style:y(C)?{}:{opacity:".5"}},{default:p((()=>[fe])),_:1},8,["style"])):(o(),c(u,{key:1,color:"success",onClick:f},{default:p((()=>[he])),_:1}))])),_:1},8,["active"]),b.value&&!h.value?(o(),c("div",ge,[m(g,{color:"info",class:"mx-2 btn-card w-100 column is-4",style:1==n.value?{opacity:"0.4"}:{},onClick:l[2]||(l[2]=e=>n.value=3)},{default:p((()=>[m("div",xe,[ke,3==n.value?(o(),c("p",je,[Ce])):x("",!0)])])),_:1},8,["style"]),m(P,{total:r.total,onOnPaymentCash:w},null,8,["total"])])):x("",!0),m("div",Se,[_.value&&h.value?(o(),c(M,{key:0,membership_member:_.value},null,8,["membership_member"])):x("",!0)]),3!=n.value||h.value?x("",!0):(o(),c(q,{key:1,"show-new-card":!1,memberid:b.value,onOnMethodPayment:$},null,8,["memberid"])),3!=n.value||h.value?x("",!0):(o(),c(F,{key:2,amount:r.total,id:b.value,member_membership:_.value,onPaymentAction:l[3]||(l[3]=e=>k(b.value))},null,8,["amount","id","member_membership"])),h.value?(o(),c(g,{key:3,color:"success",class:"my-6"},{default:p((()=>[we])),_:1})):x("",!0),h.value?(o(),c(V,{key:4,onOnSign:S,"is-sign":!0,contract:`contract_${b.value}_${_.value}_${y(A)(r.member,"personal_identifications").model}.pdf`,"url-contract":`generateContract/${b.value}`},null,8,["contract","url-contract"])):x("",!0)])}}});const Pe={class:"table is-hoverable is-striped is-fullwidth"},Me=m("thead",null,[m("tr",null,[m("th",{scope:"col"},"Membership Name"),m("th",{scope:"col"},"Plan"),m("th",{scope:"col"},"Quantity"),m("th",{scope:"col"},"Cost"),m("th",{scope:"col"},"Import")])],-1),qe={class:"text-capitalize"},Ae={style:{"text-align":"right"}},Fe={style:{"text-align":"right"}},Ve={style:{"text-align":"right"}},Ne=m("td",{colspan:"4",style:{"text-align":"right"}},[m("b",null,"Subtotal")],-1),Ie={key:0,style:{"text-align":"right"}},Oe={colspan:"4"},Be={key:0},Ee={key:1},ze={style:{"text-align":"right"}},De=m("td",{colspan:"4",style:{"text-align":"right"}},"Tax 7%",-1),Re={style:{"text-align":"right"}},Te=m("td",{colspan:"4",style:{"text-align":"right"}},[m("b",null,"Total to pay")],-1),Ue={key:1,style:{"text-align":"right"}},Qe=m("td",{colspan:"4",style:{"text-align":"right"}},"Recurring total",-1);var Ge=n({expose:[],props:{presupuesto:{type:Object,required:!0}},setup:e=>(t,s)=>{const l=a;return e.presupuesto?(o(),c(l,{key:0,class:"mb-4"},{default:p((()=>[m("table",Pe,[Me,m("tbody",null,[(o(!0),c(d,null,_(e.presupuesto.membresias,((e,t)=>(o(),c("tr",{key:`membresia-${t}`},[m("td",null,v(e.description),1),m("td",qe,v(e.type?e.type:"Initiation Fee"),1),m("td",null,v(e.quantity),1),m("td",Ae,v(y(w)(e.amount_subtotal/e.quantity/100)),1),m("td",Fe,v(y(w)(e.amount_subtotal/100)),1)])))),128)),m("tr",Ve,[Ne,m("td",null,v(y(w)(e.presupuesto.totales.upfront.amount_subtotal/100)),1)]),e.presupuesto.discount?(o(),c("tr",Ie,[m("td",Oe,[b(v(e.presupuesto.discount.name)+" ",1),"percentaje"==e.presupuesto.discount.type?(o(),c("span",Be," ( "+v(e.presupuesto.discount.value)+"% off ) ",1)):(o(),c("span",Ee," ( $"+v(e.presupuesto.discount.value)+" off ) ",1))]),m("td",null," - "+v(y(w)(e.presupuesto.totales.upfront.total_details.amount_discount/100)),1)])):x("",!0),m("tr",ze,[De,m("td",null,v(y(w)(e.presupuesto.totales.upfront.total_details.amount_tax/100)),1)]),m("tr",Re,[Te,m("td",null,v(y(w)(e.presupuesto.totales.upfront.amount_total/100)),1)]),e.presupuesto.totales.recurring?(o(),c("tr",Ue,[Qe,m("td",null,v(y(w)(e.presupuesto.totales.recurring.amount_total/100)),1)])):x("",!0)])]),S(t.$slots,"default")])),_:3})):x("",!0)}});export{$e as _,Ge as a};
