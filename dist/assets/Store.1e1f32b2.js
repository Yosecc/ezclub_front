import{r as s,a as y,c as u,A as o,n as l,g as p}from"./index.4457215e.js";import{l as b}from"./Companies.4f645ec0.js";import{v as w}from"./Discounts.a9c8271e.js";const n=s([]),g=s(!1);s(!1);const k=s(1),v=s(null),C=s(!1),j=s(!1),m=s(null),P=s(null),B=s(!1),M=e=>{const a=n.value.findIndex(t=>t.product_id==e.id);a==-1?n.value.push({product_id:e.id,count:1,products_amount:e.price,name:e.name,stock:e.stock,custom:e.custom}):(n.value[a].custom||n.value.find(t=>t.product_id==e.id).count++,n.value[a].custom&&(n.value[a].products_amount=e.price,n.value[a].name=e.name))},f=y([{typeInput:"selectDataActionChangeInput",name:"discount",placeholder:"Discount",values:[],data:null,model:"",disabled:!1,class:"is-12",isLabel:!0,change:function(){this.model!=""?w(this.values.find(e=>e.id==this.model).code,"membership").then(e=>{this.data=e.data,l.success("Discuount valid")}).catch(e=>{l.error(e.response.data),this.model=""}):this.data=null},filter:function(e){return`${e.name}`}}]),h=u(()=>{let e=0;n.value.forEach(t=>{e+=t.products_amount*t.count});let a=0;return r.value&&(r.value.type=="percentaje"?a=e*r.value.value/100:a=r.value.value),e-a}),x=u(()=>h.value*7/100),r=u(()=>p(f,"discount").data?p(f,"discount").data:null),_=u(()=>h.value+x.value),R=(e,a,t)=>{e=="minus"?(a.count>0&&a.count--,a.count==0&&n.value.splice(t,1)):a.count+1<=a.stock?a.count++:l.error("Sin Stock")},d=s(0),A=u(()=>{const e=parseFloat(d.value)-parseFloat(_.value);return e>0?e:0}),q=e=>{d.value=parseFloat(d.value)+parseFloat(e)},i=s(null),c=s({email:null,phone:null,barcode:null}),z=()=>{const e={total:_.value,tax_id:1,payment_type_id:i.value,email:c.value.email,phone:c.value.phone,barcode:c.value.barcode,change_back:A.value,products:n.value,locations_id:p(b.value,"locations_id").model,member_id:m.value?m.value.id:null};r.value&&(e.discount=r.value.id),I(e).then(a=>{i.value==1&&(i.value=null,c.value.email=null,c.value.phone=null,c.value.barcode=null,d.value=0,n.value=[],k.value=3,g.value=!1),i.value==3&&(v.value=a.data.order),v.value=a.data.order,l.success("Success"),S({invoice_pdf:a.data.invoice_pdf,order:a.data.order})}).catch(a=>{l.error(a.response.data.message)})},I=async e=>await o.post("orders",e),E=async e=>await o.post("orders/activate",{payment_intent_client_secret:e});s("");s(null);const S=e=>{P.value=e.invoice_pdf,v.value=e.order,C.value=!0},L=async e=>await o.post("orders/store_debit_automatic",e),T=async e=>await o.post("orders/swipe_card",e),G=async e=>await o.post("orders/cancel_payment_intent",{id:e}),H=async(e,a)=>await o.post("orders/another_try",{id:e,terminal_id:a}),J=async e=>await o.post("orders/capture_payment",{id:e}),K=async(e,a)=>await o.post(`orders/send_receipt/${e}`,{email:a}),N=async(e,a,t)=>await o.post(`orders/send_invoice_mail/${e}`,{email:a,invoice_pdf:t});export{B as A,E as B,j as C,d as a,A as b,n as c,q as d,v as e,M as f,R as g,x as h,S as i,L as j,f as k,P as l,m,K as n,g as o,z as p,N as q,i as r,h as s,_ as t,C as u,r as v,T as w,G as x,H as y,J as z};
