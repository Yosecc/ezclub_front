import{_ as e}from"./V-Button.vue_vue&type=script&setup=true&lang.19e0de69.js";import{_ as a}from"./V-Card.vue_vue&type=script&setup=true&lang.3e73d9de.js";import{_ as t}from"./inputsLayaut.vue_vue&type=style&index=0&lang.db4f1fa3.js";import{_ as s}from"./formLayaut.vue_vue&type=style&index=0&lang.2ed213c2.js";import{_ as i}from"./V-Avatar.vue_vue&type=script&setup=true&lang.e8b89c92.js";import{r as l,d as n,u as o,b as d,w as c,G as r,z as u,o as m,h as p,k as f,j as v,D as _,Q as h,R as y,a4 as g,J as b,F as E,E as I}from"./vendor.d0c8bc4f.js";import{A as D,a as S,g as w,f as q,n as x,p as Y,e as j,b as k}from"./index.b05546b7.js";import{g as L,d as M}from"./Diciplines.49b184f7.js";import{b as A,c as $,l as C,d as O}from"./Companies.b2984950.js";import{h as N,t as H}from"./Staffs.a1bc2e13.js";l([]);const J=l([]),T=l([]),G=async e=>{const a=await D.get(`schedule?locations_id=${e}`);return T.value=a.data,a},F=l(),R=l([{typeInput:"selectDataActionChange",name:"discipline_id",placeholder:"Discipline",values:[""],model:"",required:!0,class:"is-6"},{typeInput:"checkboxGroupSimpleEventInput",name:"location_id",text:"Locations",values:[""],model:[],required:!0,class:"is-12"}]),V=l([{typeInput:"switchEventChangeInput",name:"mismoshorariostrainers",values:["","Mismos horarios para todos los trainers seleccionados"],model:!1,required:!0,class:"is-6",click:function(){},change:function(){}}]);l([{typeInput:"switchEventChangeInput",name:"mismoshorariosdias",values:["","Mismos horarios para todos los dias"],model:!0,required:!0,class:"is-6",click:function(){},change:function(){}}]);const B=l([{typeInput:"switchEventChangeInput",name:"mismasfechas",values:["","Mismas fechas para todas las locaciones"],model:!0,required:!0,class:"is-12",click:function(){},change:function(){}}]),K=[{typeInput:"date",name:"start_date",placeholder:"Start Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"start_time",placeholder:"Start Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"date",name:"end_date",placeholder:"end Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"end_time",placeholder:"end Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"number",name:"capacity",placeholder:"Capacity people num",values:null,model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"type_of_member",placeholder:"Type of Member",values:["Adults Only","Kids Only","Adult & Kids"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"level",placeholder:"Level",values:["All Levels","Pro","Expert","Medium","Beginner"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"color",name:"color",placeholder:"Color",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"switchEventChangeInput",name:"is_recurrence",placeholder:"Recurrence",values:["","Recurrence"],model:!1,required:!0,class:"is-3",isLabel:!0,change:function(){}},{typeInput:"checkboxGroupSimpleEventInput",name:"recurrence",text:"Dias de la semana",default:[1,2,3,4,5,6,0],values:[{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"},{id:0,name:"Sunday"},{id:"All",name:"All"}],model:[],required:!0,disabled:!0,class:"is-12",click:function(){},change:function(){}}],W=l([{typeInput:"checkboxGroupSimpleEventInput",name:"trainers_id",text:"Trainers",values:[""],model:[],required:!0,class:"is-12"}]),z=l(null),P={class:"d-flex justify-content-between"},Q=I(" DELETE"),U=f("h3",{class:"title is-5 mb-2"},"Warning Edit",-1),X={class:"d-flex align-items-center"},Z={class:"ml-3 title is-6"};var ee=n({expose:[],props:{type:{type:String,default:"create"},buttons:{type:Array,default:["save"]},step:{type:Number,default:1},selectInfoData:{type:Object,default:null},idEvent:{type:Number,default:null}},emits:["addEvent","deleteEvent"],setup(n,{emit:I}){const T=n;g();const{cookies:G}=o(),ee=d((()=>"create"==T.type?{title:"Add a new schedule",subtitle:"Add information for a new schedule"}:{title:"Edit schedule",subtitle:"Edit information for a schedule"}));c((()=>T.idEvent),(()=>{"edit"==T.type&&(J.value=[],j(R.value),(async e=>{const a=await D.get(`schedule/${e}/edit`);return F.value=a.data,a})(T.idEvent).then((e=>{w(R.value,"location_id").model.push(F.value.locations_id),w(R.value,"discipline_id").model=F.value.class.dicipline_id,se(F.value.locations_id)})).catch((e=>{console.log(e.response.status),404==e.response.status&&console.log(T.idEvent)})))})),c((()=>O.value),(()=>{S(R,"location_id",O.value)})),c((()=>T.selectInfoData),(()=>{J.value=[],j(R.value),null!=G.get("locations_id")&&(w(R.value,"location_id").model.push(parseFloat(G.get("locations_id"))),se(G.get("locations_id")))}));const ae=function(e){"object"==typeof e&&(e=this.model),se(e)};c((()=>w(C.value,"locations_id").model),(e=>{se(e)})),r((()=>{A().then((e=>{S(C,"locations_id",$.value.locations),w(C.value,"locations_id").change=ae,null!=G.get("locations_id")&&(w(C.value,"locations_id").model=G.get("locations_id"),ae(G.get("locations_id")))})),L().then((e=>{S(R,"discipline_id",M.value)})),w(R.value,"location_id").change=se,w(R.value,"location_id").click=function(){},w(B.value,"mismasfechas").change=function(){w(B.value,"mismasfechas").model||le()},N().then((e=>{S(W,"trainers_id",H.value)}))}));const te=function(e,a){q([this],"trainers_id").forEach((a=>{null==J.value.find((e=>e.locations_id==this.locations_id)).trainers.find((e=>e.staffs_id==a.id))?J.value.find((e=>e.locations_id==this.locations_id)).trainers.push({locations_id:this.locations_id,staffs_id:a.id,name:a.name}):a.id==e.target.value&&J.value.find((e=>e.locations_id==this.locations_id)).trainers.splice(J.value.find((e=>e.locations_id==this.locations_id)).trainers.findIndex((e=>e.staffs_id==a.id)),1)}))};c((()=>w(B.value,"mismasfechas").model),(()=>{w(B.value,"mismasfechas").model&&le()}));const se=function(e,a){let t=null;t="object"==typeof e?e.target.value:e,q(R.value,"location_id").forEach((e=>{if(null==J.value.find((a=>a.locations_id==e.id))){w(V.value,"mismoshorariostrainers").change=ne,w(V.value,"mismoshorariostrainers").locations_id=e.id;let a=l(JSON.parse(JSON.stringify(K))).value;if(T.selectInfoData&&(w(a,"start_date").model=u(T.selectInfoData.start).format("YYYY-MM-DD"),w(a,"start_time").model=u(T.selectInfoData.start).format("HH:mm:ss"),w(a,"end_date").model=u(T.selectInfoData.end).format("YYYY-MM-DD"),w(a,"end_time").model=u(T.selectInfoData.end).format("HH:mm:ss")),"edit"==T.type){if(null==F.value)return x.error("Error Desconocido"),void window.location.reload();w(a,"start_date").model=u(F.value.start_date).format("YYYY-MM-DD"),w(a,"start_time").model=u(F.value.start_date).format("HH:mm:ss"),w(a,"end_date").model=u(F.value.end_date).format("YYYY-MM-DD"),w(a,"end_time").model=u(F.value.end_date).format("HH:mm:ss"),w(a,"capacity").model=F.value.capacity,w(a,"color").model=F.value.color,F.value.recurrence.length>0&&(w(a,"is_recurrence").model=!0,w(a,"recurrence").model=F.value.recurrence,w(a,"recurrence").disabled=!1),w(a,"type_of_member").model=F.value.type_of_member,w(a,"level").model=F.value.level}w(a,"start_date").change=ie,w(a,"end_date").change=ie,w(a,"capacity").change=ie,w(a,"end_time").change=ie,w(a,"start_time").change=ie,w(a,"is_recurrence").change=function(){w(a,"recurrence").disabled=this.model},w(a,"recurrence").click=function(){},w(a,"recurrence").change=function(){this.model.includes("All")&&(this.model=this.default)};let t=l(JSON.parse(JSON.stringify(W.value[0]))).value;t.change=te,t.click=function(){},t.locations_id=e.id,"edit"==T.type&&F.value.trainers.forEach((e=>{t.model.push(e.staffs_id)})),a.push(t),J.value.push({locations_id:e.id,name:e.name,start_date:w(a,"start_date"),start_time:w(a,"start_time"),end_date:w(a,"end_date"),end_time:w(a,"end_time"),capacity:w(a,"capacity"),recurrence:w(a,"recurrence"),inputsfechas:a,type_of_member:w(a,"type_of_member"),level:w(a,"level"),color:w(a,"color"),trainers:[]})}else e.id==t&&J.value.splice(J.value.findIndex((a=>a.locations_id==e.id)),1)}))},ie=function(){w(B.value,"mismasfechas").model&&le()},le=function(){let e=J.value.find((e=>e.locations_id==q(R.value,"location_id")[0].id));J.value.filter((e=>e.locations_id!=q(R.value,"location_id")[0].id)).forEach((a=>{w(a.inputsfechas,"start_date").model=w(e.inputsfechas,"start_date").model,w(a.inputsfechas,"end_date").model=w(e.inputsfechas,"end_date").model,w(a.inputsfechas,"end_time").model=w(e.inputsfechas,"end_time").model,w(a.inputsfechas,"start_time").model=w(e.inputsfechas,"start_time").model,w(a.inputsfechas,"capacity").model=w(e.inputsfechas,"capacity").model,w(a.inputsfechas,"color").model=w(e.inputsfechas,"color").model,w(a.inputsfechas,"type_of_member").model=w(e.inputsfechas,"type_of_member").model,w(a.inputsfechas,"level").model=w(e.inputsfechas,"level").model,w(a.inputsfechas,"recurrence").model=w(e.inputsfechas,"recurrence").model}))},ne=function(e){let a=null,t=null;"number"==typeof e?(t=e,a=w(V.value,"mismoshorariostrainers").model):(t=this.locations_id,a=!w(V.value,"mismoshorariostrainers").model);let s=J.value.find((e=>e.locations_id==t)),i=s.trainers[0],n=w(i.inputsDias,"semana").model,o=s.trainers.filter((e=>e.staffs_id!=i.staffs_id)),d=null;o.forEach((e=>{d=l(JSON.parse(JSON.stringify(e.days))),a?(w(e.inputsDias,"semana").model=n,e.days=i.days):(w(e.inputsDias,"semana").model=w(e.inputsDias,"semana").default,e.days=d)}))},oe=()=>{const e=Y(R.value).discipline_id,a=Y(R.value).location_id;let t=[];a.forEach((e=>{let a=J.value.find((a=>a.locations_id==e)),s=[];a.trainers.forEach((e=>{s.push({staffs_id:e.staffs_id})})),t.push({locations_id:a.locations_id,start_date:a.start_date.model+" "+a.start_time.model,end_date:a.end_date.model+" "+a.end_time.model,capacity:a.capacity.model,recurrence:JSON.stringify(a.recurrence.model),type_of_member:a.type_of_member.model,level:a.level.model,color:a.color.model,trainers:s})})),z.value={dicipline_id:e,status:!0,locations:t},"create"==T.type?(async e=>await D.post("schedule",e))(z.value).then((e=>{x.success("Save Success"),e.data.forEach((e=>{I("addEvent",e),J.value=[],j(R.value)}))})).catch((e=>{for(var a in e.response.data.errores)e.response.data.errores[a].forEach((e=>{x.error(`${a} ${e}`)}))})):(async(e,a)=>{const t=await D.put(`schedule/${e}`,a);return F.value=t.data,t})(F.value.id,z.value).then((e=>{x.success("Success Update"),e.data.forEach((e=>{I("addEvent",e),J.value=[],j(R.value)}))})).catch((e=>{for(var a in e.response.data.errores)e.response.data.errores[a].forEach((e=>{x.error(`${a} ${e}`)}))}))},de=()=>{const e=F.value.id;(async e=>await D.delete(`schedule/${e}`))(e).then((e=>{I("deleteEvent",F.value.id),J.value=[],j(R.value)})).catch((a=>{404==a.response.status&&(console.log("props.idEvent",e),I("deleteEvent",e))}))};return(l,n)=>{const o=e,d=a,c=t,r=s,u=i;return m(),p(h,null,[f(r,{buttons:T.buttons,step:T.step,titles:_(ee),class:"mb-2",onSaveData:oe,color:"warning"},{default:v((()=>["create"!=T.type?(m(),p(d,{key:0,color:"warning"},{default:v((()=>[f("div",P,[f(o,{onClick:de,icon:"fa fa-times",color:"danger",elevated:""},{default:v((()=>[Q])),_:1}),U])])),_:1})):b("",!0),f(c,{"inputs-step":_(R)},null,8,["inputs-step"])])),_:1},8,["buttons","step","titles"]),(m(!0),p(h,null,y(_(J),((e,a)=>(m(),p(d,{key:`location-${a}`,class:"mb-4"},{default:v((()=>[f("div",X,[f(u,{picture:`${_(k)}storage/${e.image}`},null,8,["picture"]),f("h1",Z,E(e.name),1)]),f(c,{"inputs-step":_(B)},null,8,["inputs-step"]),f(c,{"inputs-step":e.inputsfechas},null,8,["inputs-step"])])),_:2},1024)))),128))],64)}}});export{ee as _,G as g};
