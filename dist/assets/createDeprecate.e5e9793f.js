import{_ as e}from"./V-Button.vue_vue&type=script&setup=true&lang.115c9f56.js";import{_ as t}from"./V-Control.b8a16a92.js";import{_ as a}from"./V-Field.vue_vue&type=script&setup=true&lang.5a5e683f.js";import{_ as s}from"./inputsLayaut.vue_vue&type=style&index=0&lang.9a5f1b2d.js";import{_ as l}from"./formLayaut.vue_vue&type=style&index=0&lang.e35c9b92.js";import{d as i,r,w as n,b as u,i as o,j as m,F as p,k as c,l as d,o as v,H as f,Q as y,I as b,S as _,U as h,W as g,_ as S,G as x,A as j,B as k,X as C,a2 as P,D as M,E as A,P as w}from"./vendor.84e48f7c.js";import{g as N,p as V,h as $,e as D,s as O,v as E,m as F,b as I,P as q,n as R,A as T,a as B}from"./index.7b297ef5.js";import{J,K as L,d as U,L as z,i as G,M as Q,b as W,N as X,O as Y,P as H,k as K,Q as Z,o as ee,h as te,R as ae,S as se,T as le,U as ie,V as re,W as ne,X as ue,Y as oe,c as me,Z as pe,_ as ce,$ as de}from"./Members.c3acaab1.js";import{_ as ve}from"./SearchBar.vue_vue&type=style&index=0&lang.c33d2ec7.js";import{_ as fe}from"./V-Card.vue_vue&type=script&setup=true&lang.b57414a9.js";import{_ as ye}from"./V-Placeload.8fe4e440.js";import{_ as be}from"./V-Loader.vue_vue&type=script&setup=true&lang.a67ef8b7.js";import{_ as _e}from"./V-Modal.vue_vue&type=script&setup=true&lang.f91cc122.js";import{c as he}from"./Companies.9bf42d00.js";import{_ as ge}from"./MemberCards.008d2ac6.js";import{_ as Se}from"./signComponent.vue_vue&type=script&setup=true&lang.50b98306.js";import{_ as xe}from"./Presupuesto.vue_vue&type=script&setup=true&lang.d3d4416a.js";import{_ as je}from"./V-Progress.vue_vue&type=script&setup=true&lang.3578c716.js";import{_ as ke}from"./SidebarLayout.vue_vue&type=script&setup=true&lang.837fe5b6.js";import{a as Ce,m as Pe}from"./Memberships.0d03aea3.js";import{g as Me}from"./Recurrences.c5a7ec40.js";import{g as Ae}from"./Discounts.4a553121.js";import{e as we,c as Ne,s as Ve,d as $e}from"./config.46ff2575.js";import{g as De}from"./Staffs.3a776af7.js";import{p as Oe}from"./sidebarLayoutState.bceb862d.js";import"./V-SwitchSegment.vue_vue&type=script&setup=true&lang.8a41fb82.js";import"./V-Checkbox.vue_vue&type=script&setup=true&lang.3090aa96.js";import"./V-CardAdvanced.vue_vue&type=script&setup=true&lang.cc314943.js";import"./Diciplines.5e7d07fe.js";import"./V-Avatar.vue_vue&type=script&setup=true&lang.b74dc949.js";import"./pdf_icon.0a206595.js";import"./ActivityPanel.vue_vue&type=style&index=0&lang.5e609119.js";import"./useDropdown.3858e0aa.js";import"./V-Dropdown.7cdac118.js";import"./V-Icon.vue_vue&type=script&setup=true&lang.1503437d.js";import"./activePanelState.de92bd5f.js";import"./fastpizza.1e58d0ec.js";import"./TaskPanel.vue_vue&type=style&index=0&lang.1c78e14a.js";import"./V-Tag.vue_vue&type=script&setup=true&lang.43768b74.js";import"./video.f5cea5d5.js";import"./SearchPanel.vue_vue&type=style&index=0&lang.f7104d79.js";import"./darkModeState.0452d175.js";import"./AnimatedLogo.2dcbd823.js";import"./V-IconBox.vue_vue&type=script&setup=true&lang.051c3ce8.js";import"./V-Block.vue_vue&type=script&setup=true&lang.d16ae397.js";import"./UserPopoverContent.vue_vue&type=script&setup=true&lang.e7d23443.js";import"./userPopovers.f4b9fc60.js";var Ee=i({expose:[],props:{type:{type:String,default:"create"},inputs:{type:Array,default:[]},title:{type:String,default:""}},emits:["changeStep","returData"],setup(e,{emit:t}){const a=e,i=r(!1);n((()=>a.inputs),((e,t)=>{v()}));const v=()=>{i.value=!0,setTimeout((()=>{i.value=!1}),500)},f=u((()=>{const e=a.inputs;return e.length&&null!=N(e,"country_id")&&(N(e,"country_id").model=34),console.log("data",e),y.value?e.filter((e=>e.typeMember.includes("Company"))):e.filter((e=>e.typeMember.includes("Individual")))})),y=r(!1),b=e=>{y.value=!e.input.model,v()},_=e=>{let a=V(f.value);$.value||(a.select_type=a.select_type?"Company":"Individual",L.value=a,t("returData",a),t("changeStep",e))};return(t,a)=>{const r=s,n=l;return o(),m(n,{titles:{title:e.title},"is-loading":i.value,buttons:["next"],"buttons-disabled":p(J),step:1,onChangeStep:_},{default:c((()=>[d(r,{"inputs-step":p(f),onChangeSwitch:b},null,8,["inputs-step"])])),_:1},8,["titles","is-loading","buttons-disabled"])}}}),Fe=i({expose:[],props:{type:{type:String,default:"create"},inputs:{type:Array,default:[]},title:{type:String,default:""}},emits:["changeStep","returData"],setup(e,{emit:t}){const a=r(null),i=r([]),u=e=>{t("changeStep",e)};v((()=>{i.value=[],N(U.value,"parent_email").disabled=!0})),n((()=>z.value),(()=>{z.value?(i.value=[],console.log(z.value),N(U.value,"member_id").model=z.value.id,N(U.value,"parent_email").model=z.value.email,N(U.value,"postal_code").model=z.value.postal_code,N(U.value,"city_id").model=z.value.city_id,N(U.value,"country_id").model=z.value.country_id,N(U.value,"state_id").model=z.value.state_id,N(U.value,"parent_name").model=z.value.name,N(U.value,"address").model=z.value.address,N(U.value,"parent_second_name").model=z.value.second_name,N(U.value,"parent_last_name").model=z.value.last_name,N(U.value,"parent_goverment_id").model=z.value.goverment_id,N(U.value,"parent_personal_identifications").model=z.value.personal_identifications,N(U.value,"parent_phone").model=z.value.phone,U.value.forEach((e=>{e.required=!1}))):(D(U.value),U.value.forEach((e=>{e.required=!0})))}));const _=e=>{!1===e?(i.value.push("next"),N(U.value,"parent_email").model=""):(i.value=[],N(U.value,"parent_email").model=e)};return(t,r)=>{const n=ve,v=s,h=l;return o(),m(h,{titles:{title:e.title},buttons:["next","prev"],"buttons-disabled":i.value,step:2,onChangeStep:u},{default:c((()=>[d("p",null,f(a.value),1),d(n,{"is-head":!0,"place-holder":"Enter the guardian email",onOnSubmit:_,class:"",modelValue:p(z),"onUpdate:modelValue":r[1]||(r[1]=e=>y(z)?z.value=e:null)},null,8,["modelValue"]),b(' <div\n      v-if="!memberGuardian"\n      class="d-flex justify-content-center mt-5 w-100"\n      style="border-bottom: 1px solid rgba(0, 0, 0, 0.05)"\n    >\n      <p>Or</p>\n    </div> '),d(v,{"inputs-step":p(U)},null,8,["inputs-step"])])),_:1},8,["titles","buttons-disabled"])}}});const Ie={key:0},qe=x(" Remove Family Member "),Re={key:1,class:"column d-flex justify-content-center flex-column is-4 mx-auto"},Te=x(" Add Another Family Member ");var Be=i({expose:[],props:{type:{type:String,default:"create"},inputs:{type:Array,default:[]},title:{type:String,default:""}},emits:["changeStep","returData"],setup(i,{emit:v}){const f=i,y=r(!1);n((()=>f.inputs),((e,t)=>{x()}));const x=()=>{y.value=!0,setTimeout((()=>{y.value=!1}),500)},C=r([]);u((()=>(x(),C.value.forEach(((e,t)=>{M.value.includes(t)?C.value[t]=e.filter((e=>e.category.includes("Minor"))):C.value[t]=JSON.parse(JSON.stringify(f.inputs))})),C.value)));const P=e=>{v("returData",C),v("changeStep",e)},M=r([]),A=u((()=>C.value.length>0)),w=r(0),V=()=>{if(w.value>0)for(var e=0;e<w.value;++e){const e=j(JSON.parse(JSON.stringify(f.inputs)));N(e,"misma_direccion").change=F,N(e,"category").change=$,C.value.push(e)}},$=function(e){console.log(e),e.forEach((e=>{this.model?e.category.includes("Adult")&&(e.typeInput=e.typeInputDefault):e.category.includes("Minor")||(e.typeInput="hidden")})),this.model||(D(e),O(e,"email",`family_${k().format("hms")}_${E(G.value,"email")}`),O(e,"phone",E(G.value,"phone"))),console.log(this.model)},D=e=>{O(e,"address",E(G.value,"address")),O(e,"postal_code",E(G.value,"postal_code")),O(e,"country_id",E(G.value,"country_id")),O(e,"city_id",E(G.value,"city_id")),O(e,"state_id",E(G.value,"state_id"))},F=function(e){console.log("llejay"),this.model?(O(e,"postal_code",""),O(e,"country_id",""),O(e,"city_id",""),O(e,"state_id","")):D(e)};return(r,n)=>{const u=s,v=e,f=fe,x=t,j=a,k=l;return o(),m(k,{titles:{title:i.title},"is-loading":y.value,buttons:["next","prev"],step:2,onChangeStep:P},{default:c((()=>[p(A)?(o(),m("div",Ie,[(o(!0),m(_,null,h(C.value,((e,t)=>(o(),m(f,{key:t,class:"mb-4"},{default:c((()=>[d(u,{"inputs-step":e,onChangeSwitch:e=>{return a=t,void M.value.findIndex((e=>e==a));var a}},null,8,["inputs-step","onChangeSwitch"]),d(v,{onClick:e=>C.value.splice(t,1),color:"danger",class:"mx-auto",icon:"fas fa-times"},{default:c((()=>[qe])),_:2},1032,["onClick"])])),_:2},1024)))),128))])):b("v-if",!0),p(A)?b("v-if",!0):(o(),m("div",Re,[d(j,{class:"mb-4"},{default:c((()=>[d(x,null,{default:c((()=>[g(d("input",{type:"number","onUpdate:modelValue":n[1]||(n[1]=e=>w.value=e),class:"input text-center",placeholder:"Family quantity"},null,512),[[S,w.value]])])),_:1})])),_:1}),d(v,{onClick:V,color:"info",icon:"fas fa-check",raised:""},{default:c((()=>[Te])),_:1})]))])),_:1},8,["titles","is-loading"])}}}),Je=i({expose:[],props:{type:{type:String,default:"create"},inputs:{type:Array,default:[]},title:{type:String,default:""}},emits:["changeStep"],setup(e,{emit:t}){const a=e,i=r(!1);n((()=>a.inputs),((e,t)=>{f()}));const v=e=>{let a=[];y.value.forEach((e=>{e.values.forEach((e=>{let t=e.values.find((e=>"sms"==e.name)).model.length,s=e.values.find((e=>"email"==e.name)).model.length;a.push({[e.name]:e.value,sms:t>0,email:s>0})}))})),Q.value=a,t("returnData",a),t("changeStep",e)},f=()=>{i.value=!0,setTimeout((()=>{i.value=!1}),500)},y=u((()=>a.inputs)),b=r(!1),_=e=>{b.value=!e.input.model,f()};return(t,a)=>{const r=s,n=l;return o(),m(n,{titles:{title:e.title},"is-loading":i.value,buttons:["next","prev"],step:3,onChangeStep:v},{default:c((()=>[d(r,{"inputs-step":p(y),onChangeSwitch:_},null,8,["inputs-step"])])),_:1},8,["titles","is-loading"])}}});const Le={class:""};var Ue=i({expose:[],props:{type:{type:String,default:"create"},inputs:{type:Array,default:[]},title:{type:String,default:""},member:{type:Array,default:[]},familiares:{type:Array,default:[]},memberships:{type:Array,default:[]},notes:{type:Array,default:[]}},emits:["changeStep","returnData"],setup(e,{emit:t}){const a=e,i=r(!1),y=r([]);n((()=>a.inputs),((e,t)=>{g()})),v((()=>{let e=W.findIndex((e=>"prorrateo"==e.name)),t=W.findIndex((e=>"schedules"==e.name));N(W,"recurrence").class="is-12",-1!=e&&(W.splice(e,1),g()),-1!=t&&(W.splice(t,1),g())}));const g=()=>{i.value=!0,setTimeout((()=>{i.value=!1}),500)},S=e=>{let a=null;X.forEach(((e,t)=>{0==t?a=e.inputs:y.value.push(e)})),$.value||(Y.value=a,t("returnData",{memberMembership:a,familyMembership:y}),t("changeStep",e))},x=u((()=>{const e=j([]);X.value=[];let t=[];W.forEach((e=>{t.push(JSON.parse(JSON.stringify(e)))})),e.push(k(a.member,JSON.parse(JSON.stringify(t))));for(var s=0;s<a.familiares.length;++s)e.push(k(a.familiares[s],JSON.parse(JSON.stringify(t))));return X.value=e,e})),k=(e,t,a)=>{const s={member:null,membresia:null};return"Prospect"==H.value?(N(t,"recurrence").model=!1,N(t,"recurrence").display=!1,N(t,"is_initiation_fee").model=!0,N(t,"is_card_price").model=!0):(N(t,"recurrence").model=!0,N(t,"recurrence").display=!0,N(t,"is_initiation_fee").model=!1,N(t,"is_card_price").model=!1),s.member=e,s.membresia=t,K(s.membresia,s.member),s};return(t,a)=>{const r=s,n=fe,u=l;return o(),m(u,{titles:{title:e.title},isloading:i.value,buttons:["next","prev"],step:4,onChangeStep:S},{default:c((()=>[(o(!0),m(_,null,h(p(x),((e,t)=>(o(),m(n,{key:`ss${t}`,class:"mb-4"},{default:c((()=>[d("p",Le,[d("b",null,f(p(E)(e.member,"name"))+" "+f(p(E)(e.member,"second_name"))+" "+f(p(E)(e.member,"last_name")),1)]),d(r,{"inputs-step":e.membresia},null,8,["inputs-step"])])),_:2},1024)))),128)),b(' <V-Card class="mb-4">\n      <inputsLayaut :inputs-step="notes" />\n    </V-Card> ')])),_:1},8,["titles","isloading"])}}});const ze=d("p",{class:"title is-3"},[d("i",{class:"fas fa-money-bill","aria-hidden":"true"})],-1),Ge={class:"title is-5"},Qe=x(" Cash "),We={class:"d-flex mb-4 justify-content-between"},Xe={class:"title is-5"},Ye=x(" Total: "),He={class:"title is-5"},Ke=x(" Cash Total: "),Ze={class:"\n          d-flex\n          justify-content-center\n          align-items-center\n          flex-column\n          mb-4\n        "},et=d("p",{class:"title is-5 mb-4"},"Change Back:",-1),tt={class:"title is-3 mb-0"},at={class:"d-flex justify-content-center flex-wrap mb-4"},st=d("div",{class:"w-100"},null,-1),lt={class:"d-flex justify-content-center"},it=x("Reset"),rt=x("Confirm");var nt=i({expose:[],props:{total:{type:[Number,String],default:0},margin:{type:String,default:"mx-2"},presupuesto:{type:Object,defaukt:{}}},emits:["onPaymentCash"],setup(s,{emit:l}){const i=s,n=r(!1),v=r(0),y=u((()=>{const e=parseFloat(v.value)-parseFloat(i.total/100);return e>0?e:0})),j=()=>{n.value=!1,l("onPaymentCash",{changeBack:y.value,cash:v.value,presupuesto:i.presupuesto})};return(l,i)=>{const r=fe,u=e,k=t,C=a,P=_e;return o(),m(_,null,[d(r,{color:"warning",class:["btn-card w-100 justify-content-center column is-4",s.margin],onClick:i[1]||(i[1]=e=>n.value=!0)},{default:c((()=>[ze,d("p",Ge,[Qe,d("b",null,f(p(F)(s.total)),1)])])),_:1},8,["class"]),d(P,{title:"",open:n.value,actions:"center",onClose:i[5]||(i[5]=e=>n.value=!1)},{content:c((()=>[d("div",We,[d("p",Xe,[Ye,d("b",null,f(p(F)(s.total)),1)]),d("p",He,[Ke,d("b",null,f(p(F)(v.value)),1)])]),d("div",Ze,[et,d("p",tt,[d("b",null,f(p(F)(p(y))),1)])]),d("div",at,[d(u,{bold:"",class:"m-3",style:{"font-size":"14px"},onClick:i[2]||(i[2]=e=>v.value=Number.parseFloat(s.total).toFixed(2))},{default:c((()=>[x(" Full Payment "+f(p(F)(s.total)),1)])),_:1}),st,(o(),m(_,null,h([5,10,20,50,100],((e,t)=>d(u,{key:`calculato-${t}`,bold:"",class:"m-3",style:{"font-size":"14px"},onClick:t=>(e=>{v.value=parseFloat(v.value)+parseFloat(e)})(e)},{default:c((()=>[x(" $"+f(e),1)])),_:2},1032,["onClick"]))),64))]),d("div",lt,[d(C,null,{default:c((()=>[d(k,null,{default:c((()=>[b(" <p>{{ Number.parseFloat(cash).toFixed(2)  }}</p> "),g(d("input",{"onUpdate:modelValue":i[3]||(i[3]=e=>v.value=e),type:"text",class:"input text-center",placeholder:"Cash"},null,512),[[S,v.value]])])),_:1})])),_:1})])])),action:c((()=>[d(u,{onClick:i[4]||(i[4]=e=>v.value=0),class:"d-flex justify-content-center",raised:""},{default:c((()=>[it])),_:1}),d(u,{color:"success",onClick:j,disabled:parseFloat(v.value)<parseFloat(parseFloat(s.total/100).toFixed(2)),class:"d-flex justify-content-center",raised:""},{default:c((()=>[rt])),_:1},8,["disabled"])])),_:1},8,["open"])],64)}}});const ut={class:"d-flex justify-content-between align-items-start"},ot=d("div",null,[d("p",{class:"title is-3"},[d("i",{class:"fas fa-receipt",style:{color:"white !important"},"aria-hidden":"true"})]),d("p",{class:"title is-5",style:{color:"white !important"}},"View Order")],-1),mt={key:0,class:"title is-6"},pt=d("i",{class:"fas fa-check","aria-hidden":"true"},null,-1);var ct=i({expose:[],props:{membership_member:{type:[Number,String],default:0},invoice_id:{type:[Number,String],default:0}},setup(e){const t=e,a=r(!1);return v((()=>{})),(e,s)=>{const l=fe,i=_e;return o(),m(_,null,[d(l,{style:{background:"#388e3c"},class:"mx-2 mx-auto mt-4 is-4 column btn-card justify-content-center",onClick:s[1]||(s[1]=e=>a.value=!0)},{default:c((()=>[d("div",ut,[ot,e.openModalRecibo?(o(),m("p",mt,[pt])):b("v-if",!0)])])),_:1}),d(i,{title:"",open:a.value,actions:"center",onClose:s[2]||(s[2]=e=>a.value=!1)},{content:c((()=>[b(' <iframe id="printf" :src="`${FRONTEND_URL}members/recibo?id=${props.membership_member}`"></iframe> '),d("iframe",{src:`${p(I)}ticket_membership/${t.membership_member}?companie_id=${p(he).id}&invoice_id=${t.invoice_id}`,width:"100%",height:"500px",frameborder:"0"},null,8,["src"]),d("a",{href:`${p(I)}ticket_membership/${t.membership_member}?companie_id=${p(he).id}&invoice_id=${t.invoice_id}`},"Open",8,["href"])])),action:c((()=>[])),_:1},8,["open"])],64)}}});const dt=d("div",{id:"payment-element"},[b("Stripe.js injects the Payment Element")],-1),vt=x("Pay now "),ft=d("div",{id:"payment-message",class:"hidden"},null,-1);var yt=i({expose:[],props:{presupuesto:{type:Object,default:{}},amount:{type:[Number,String],required:!0},id:{type:Number,required:!0},url:{type:String,default:"stripe"},member_membership:{type:Number,default:0},variosMiembros:{type:Boolean,default:!1},miembros:{type:Array,default:[]}},emits:["PaymentAction"],setup(t,{emit:a}){const s=t,l=Stripe(q.value);n((()=>s.id),(e=>{i.value=!0,k()}));const i=r(!0);r({id:s.id,amount:s.amount});const p=r(),f=u((()=>"stripe"!=s.url?{payment_type_id:3,amount:s.amount}:{id:s.id,member_mermship_id:s.member_membership,amount:s.amount,payment_type_id:1}));r(null);const y=r(null),h=r(null),x=r(!1),j=r(null),k=async()=>{let e=await T.post(s.url,f.value).then((e=>{y.value=e.data.clientSecret,j.value=e.data.user_id,p.value=l.elements({clientSecret:y.value,appearance:{theme:"night",rules:{".Input":{boxShadow:"none"}}}}),h.value=p.value.create("card",{classes:{base:"base_card"}}),h.value.mount("#payment-element")})).catch((e=>{i.value=!1}));return i.value=!1,e},M=r(null),A=async e=>{e.preventDefault(),x.value=!0;const{setupIntent:t,error:i}=await l.confirmCardSetup(y.value,{payment_method:{card:h.value,billing_details:{name:M.value}}});if(i)x.value=!1,R.error(i.message);else{const{payment_method:e}=t;s.variosMiembros?(s.miembros.forEach((t=>{T.post("paymentStripe",{payment_method:e,user_id:t.idMember,membership_member_id:t.idMemberMembership,payment_type_id:3,presupuesto:s.presupuesto}).catch((e=>{x.value=!1}))})),response.then((e=>{a("PaymentAction",e.data),R.success("Success Payment")})).catch((e=>{x.value=!1}))):await T.post("paymentStripe",{payment_method:e,amount:s.amount,user_id:j.value,membership_member_id:s.member_membership,payment_type_id:3,presupuesto:s.presupuesto}).then((e=>{a("PaymentAction",e.data),R.success("Success Payment")})).catch((e=>{x.value=!1}))}x.value=!1};return v((()=>{x.value=!1,k(),new Pusher("2cd5b586808b2f41f8e6",{cluster:"us2"}).subscribe("payment_stripe_channel").bind("payment_stripe_event",(function(e){R.error("ALERT PAYMENT: "+e.member+" "+e.message)}))})),(t,a)=>{const s=ye,l=e,r=be,n=fe;return o(),m(_,null,[i.value?(o(),m(s,{key:0,height:"200px",class:"mt-6"})):b("v-if",!0),g(d(n,{class:"mt-6"},{default:c((()=>[d("form",{onSubmit:P(A,["prevent"]),id:"payment-form"},[g(d("input",{id:"card-holder-name",class:"input mb-3","onUpdate:modelValue":a[1]||(a[1]=e=>M.value=e),placeholder:"Name",type:"text"},null,512),[[S,M.value]]),dt,d(r,{size:"small",active:x.value},{default:c((()=>[d(l,{id:"submit",class:"mt-4",color:"info"},{default:c((()=>[vt])),_:1})])),_:1},8,["active"]),ft],40,["onSubmit"])])),_:1},512),[[C,!i.value]])],64)}}});const bt={class:"w-100"},_t={class:"my-4"},ht={key:0},gt=d("small",null,"Register the principal first",-1),St=x(" Process Membership "),xt=x(" Process Membership "),jt={key:0,class:"columns is-multiline justify-content-center mt-6"},kt={class:"d-flex justify-content-between align-items-start"},Ct=d("div",null,[d("p",{class:"title is-3"},[d("i",{class:"fas fa-credit-card","aria-hidden":"true"})]),d("p",{class:"title is-5"},"Debit Automatic")],-1),Pt={key:0,class:"title is-6"},Mt=d("i",{class:"fas fa-check","aria-hidden":"true"},null,-1),At={class:"columns is-multiline justify-content-center mt-6"},wt=d("p",{class:"title is-4"},"Payment Success",-1);var Nt=i({expose:[],props:{presupuesto:{type:Object,default:{}},member:{type:Array,required:!0},member_id:{type:Number,default:0},membresia:{type:Array,required:!0},contact:{type:Array,required:!0},presupuesto_id:{type:String},total:{type:[String,Number],required:!0},categoriesMembers:{type:Object,required:!0},notasInput:{type:Object,required:!0},type:{type:String,default:"create"}},emits:["PaymentAction"],setup(t,{emit:a}){const s=t,l=r(null),i=r(!1),n=r(null),y=r(null);v((()=>{i.value=!1,h.value=!1}));const _=()=>{l.value=null,i.value=!0,n.value=s.member.id,y.value=null,console.log("props.membresia",s.membresia);const e=V(s.membresia);e.members_id=s.member_id,e.total=s.total,e.payment_type_id=3,console.log(e),le(e).then((e=>{n.value=e.data.id,y.value=e.data.membership_members_id,R.success("Success"),i.value=!1})).catch((e=>{for(var t in e.response.data.errores)e.response.data.errores[t].forEach((e=>{R.error(`${t}: ${e}`)}))}))},h=r(!1),g=e=>{"object"==typeof e&&(n.value=e.id,k.value=e.invoice_id,a("PaymentAction",n)),h.value=!0},S=u((()=>0==N(s.member,"is_family").model)),x=u((()=>!h.value&&!(!S.value&&!Z.value))),j=e=>{ee(e,y.value).then((e=>{if(e.data.status)R.success("Sign Success");else for(var t in R.error(e.data.mensaje),e.data.errores)e.data.errores[t].forEach((e=>{R.error(`${t} : ${e}`)}))})).catch((e=>{}))},k=r(0),C=e=>{if(l.value=1,y.value){const t={cash:e.cash,payment_type_id:l.value,total:s.total,cash_back:e.changeBack,membership_member_id:y.value,presupuesto:s.presupuesto};console.log("datos",t),te(y.value,t).then((e=>{console.log("cash",e),g({id:e.data.member_id,invoice_id:e.data.invoice_id}),R.success("Success Payment")})).catch((e=>{console.log(e.response)}))}else R.error("The membership ID is required. Click on Process Membership to generate it automatically")},P=e=>{i.value=!0,ae({payment_method:e,amount:s.total,user_id:n.value,membership_member_id:y.value,payment_type_id:3,presupuesto:s.presupuesto}).then((e=>{k.value=e.data.invoice_id,g(n.value),R.success("Success"),i.value=!1})).catch((e=>{for(var t in e.response.data.errores)e.response.data.errores[t].forEach((e=>{R.error(`${t}: ${e}`)}))}))};return(a,r)=>{const u=e,v=be,M=fe,A=nt,w=ct,V=ge,$=yt,D=Se;return o(),m("div",bt,[d("div",_t,[d("p",null,f(p(N)(s.member,"name").model)+" "+f(p(N)(s.member,"last_name").model),1),d("p",null,[d("small",null,f(p(S)?"Main member":"Family"),1)]),p(S)||p(Z)?b("v-if",!0):(o(),m("p",ht,[gt]))]),d(v,{size:"small",active:i.value},{default:c((()=>["create"==s.type?(o(),m(u,{key:0,color:"success",onClick:r[1]||(r[1]=e=>p(x)?(l.value=null,i.value=!0,n.value=null,y.value=null,se({member:s.member,contact:s.contact,membresia:s.membresia,total:s.total,categoriesMembers:s.categoriesMembers,notasInput:s.notasInput}).then((e=>{n.value=e.data.id,y.value=e.data.membership_members_id})).catch((e=>{})),void(i.value=!1)):null),style:p(x)?{}:{opacity:".5"}},{default:c((()=>[St])),_:1},8,["style"])):(o(),m(u,{key:1,color:"success",onClick:_},{default:c((()=>[xt])),_:1}))])),_:1},8,["active"]),b(" <p>{{ paymentMethod }}</p> "),n.value&&!h.value?(o(),m("div",jt,[d(M,{color:"info",class:"mx-2 btn-card w-100 column is-4",style:1==l.value?{opacity:"0.4"}:{},onClick:r[2]||(r[2]=e=>l.value=3)},{default:c((()=>[d("div",kt,[Ct,3==l.value?(o(),m("p",Pt,[Mt])):b("v-if",!0)])])),_:1},8,["style"]),d(A,{presupuesto:t.presupuesto,total:s.total,onOnPaymentCash:C},null,8,["presupuesto","total"])])):b("v-if",!0),d("div",At,[b(" <p>{{ typeof invoice_id }}</p> "),y.value&&h.value?(o(),m(w,{key:0,membership_member:y.value,invoice_id:k.value},null,8,["membership_member","invoice_id"])):b("v-if",!0)]),3!=l.value||h.value?b("v-if",!0):(o(),m(V,{key:1,"show-new-card":!1,memberid:n.value,"member-guardian-id":p(z)?p(z).id:null,onOnMethodPayment:P},null,8,["memberid","member-guardian-id"])),3!=l.value||h.value?b("v-if",!0):(o(),m($,{key:2,amount:s.total,id:n.value,member_membership:y.value,presupuesto:t.presupuesto,onPaymentAction:g},null,8,["amount","id","member_membership","presupuesto"])),h.value?(o(),m(M,{key:3,color:"success",class:"my-6"},{default:c((()=>[wt])),_:1})):b("v-if",!0),h.value?(o(),m(D,{key:4,onOnSign:j,"is-sign":!0,contract:`contract_${n.value}_${y.value}_${p(N)(s.member,"personal_identifications").model}.pdf`,"url-contract":`generateContract/${n.value}`},null,8,["contract","url-contract"])):b("v-if",!0)])}}});const Vt={key:1},$t={class:"d-flex justify-content-end w-100"},Dt={class:"d-flex justify-content-between w-100"},Ot=x(" Finish "),Et=x(" Cancel "),Ft=x(" Register another member ");var It=i({expose:[],props:{type:{type:String,default:"create"},title:{type:String,default:""}},emits:["changeStep","returnData"],setup(t,{emit:a}){r(!1);const s=r(!1),i=u((()=>X.value[0])),n=u((()=>{let e=[];return X.value.forEach(((t,a)=>{a>0&&e.push(t)})),e}));v((()=>{N(ie.value,"mismatarjeta").change=y,re.value=[],i.value?(ne(i.value.membresia,i.value.member),n.value.length&&n.value.forEach((e=>{ne(e.membresia,e.member)}))):(console.error("No tiene membresia"),R.error("Membership is required"))}));const y=function(){this.model},g=(e,t=3,s)=>{a("returnData",{total:s}),a("changeStep",e,t,{})},S=u((()=>{let e=[];return re.value.forEach((t=>{0==N(t.member,"is_family").model&&e.push(t)})),re.value.forEach((t=>{1==N(t.member,"is_family").model&&e.push(t)})),e}));r([]);const x=()=>{window.location.reload()},j=r([]),k=e=>{j.value.push(e)};return(a,i)=>{const r=ye,n=Nt,u=xe,v=e,y=l;return o(),m(y,{titles:{title:t.title},"is-loading":s.value,buttons:["prev"],step:5,onChangeStep:g},{default:c((()=>[b(' <div class="d-flex justify-content-end align-items-center mb-4">\n\n      <VButton @click="PaymentAllMembership" color="primary"\n        >Pay all memberships</VButton\n      >\n\n      <div v-if="miembrosNuevos.length">\n        <stripeAddCard\n          :amount="props.total"\n          :id="miembrosNuevos[0].idMember"\n          :member_membership="miembrosNuevos[0].idMemberMembership"\n          :variosMiembros="true"\n          :miembros="miembrosNuevos"\n          @PaymentAction="PaymentAction"\n        />\n      </div>\n      \n    </div> '),p(re).length?b("v-if",!0):(o(),m(r,{key:0,height:"300px",class:"mb-4"})),p(re)?(o(),m("div",Vt,[(o(!0),m(_,null,h(p(S),((e,t)=>(o(),m(u,{key:`presupuesto-${t}`,class:"mb-4",presupuesto:e},{default:c((()=>[d("div",$t,[d("p",null,f(e.presupuesto_id),1),d(n,{member:e.member,membresia:e.membresia,contact:p(Q),presupuesto_id:e.presupuesto_id,"categories-members":p(ue),"notas-input":p(oe),total:e.total,presupuesto:e,onPaymentAction:k},null,8,["member","membresia","contact","presupuesto_id","categories-members","notas-input","total","presupuesto"])])])),_:2},1032,["presupuesto"])))),128))])):b("v-if",!0),d("div",Dt,[p(S).length>0&&j.value.length==p(S).length?(o(),m(v,{key:0,color:"danger",to:{name:"index"}},{default:c((()=>[Ot])),_:1})):(o(),m(v,{key:1,color:"danger",to:{name:"index"}},{default:c((()=>[Et])),_:1})),p(S).length>0&&j.value.length==p(S).length?(o(),m(v,{key:2,color:"success",onClick:x},{default:c((()=>[Ft])),_:1})):b("v-if",!0)])])),_:1},8,["titles","is-loading"])}}});M("data-v-5a5e3b40");const qt={class:"content"},Rt={class:"content-text"};A();var Tt=i({expose:[],props:{active:{type:Boolean,default:!1,required:!0},step:{type:Number,default:0,required:!0},text:{type:String,default:""}},setup(e){const t=e,a=u((()=>t.active?100:0));return(t,s)=>{const l=je;return o(),m("div",qt,[d("div",{class:["circle",e.active?"active":""]},null,2),d(l,{class:"progressbar",value:p(a),size:"smaller"},null,8,["value"]),d("div",Rt,[d("p",null,"STEP "+f(e.step),1),d("p",null,[d("b",null,f(e.text),1)])])])}}});Tt.__scopeId="data-v-5a5e3b40";const Bt={class:"columns is-multiline"},Jt={class:"column is-12"},Lt={class:"column is-9"},Ut={class:"column is-3"};var zt=i({expose:[],setup(s){Oe.value="Add New members",w({title:"Members"}),v((()=>{I(),Ce(1).then((e=>{B(W,"memberships_id",e.data.memberships)})),N(W,"memberships_id").disabled=!1,N(W,"recurrences_id").disabled=!1,N(W,"is_initiation_fee").disabled=!1,N(W,"discount").disabled=!1,Ae(1,"membership").then((e=>{B(W,"discount",e.data.discounts)})),Me(),we().then((e=>{B(G,"city_id",Ne.value),B(me,"city_id",Ne.value),B(U,"city_id",Ne.value),B(G,"state_id",Ve.value),B(me,"state_id",Ve.value),B(U,"state_id",Ve.value),B(G,"country_id",$e.value),N(G.value,"country_id").model=34,B(me,"country_id",$e.value),B(U,"country_id",$e.value)})),De().then((e=>{B(W,"staff_id",e.data)}))}));const l=r(1),i=r([{step:1,text:"Member Information",categories:["Adult","Minor","Prospect"]},{step:2,text:"Add Family Member",categories:["Adult"]},{step:2,text:"Parent / Guardian",categories:["Minor"]},{step:2,text:"Contact Preference",categories:["Prospect"]},{step:3,text:"Contact Preference",categories:["Adult","Minor"]},{step:4,text:"Select membership",categories:["Adult","Minor","Prospect"]},{step:5,text:"Add Payment Method",categories:["Adult","Minor","Prospect"]}]),n=u((()=>G.value.filter((e=>e.categories.includes(ue.value.model))))),y=u((()=>i.value.find((e=>e.step==l.value&&e.categories.includes(ue.value.model))))),S=u((()=>i.value.filter((e=>e.categories.includes(ue.value.model)))));u((()=>V(U.value)));const j=(e,t=3,a={})=>{ue.value.model,6==e?sendData(t,a):l.value=e},k=r(null),P=e=>{k.value=e},M=r(null),A=e=>{M.value=e},$=r([]),O=e=>{$.value=e.value},E=r([]),F=e=>{E.value=e.familyMembership.value,Y.value=e.memberMembership};r(null),r(null),r(null);const I=()=>{pe.value=null,ce.value=null;let e=["is_family","principal_family"];D(G.value.filter((t=>!e.includes(t.name)))),e=["recurrence"],D(W.filter((t=>!e.includes(t.name)))),D(oe.value),D(U.value)};return(s,i)=>{const r=e,u=t,v=a,k=Ee,M=Fe,w=Be,N=Je,V=Ue,D=It,I=Tt,q=ke;return o(),m(q,null,{default:c((()=>[b(" Display a payment form "),d("div",Bt,[d("div",Jt,[1==l.value?(o(),m(v,{key:0,class:"w-100",addons:""},{default:c((()=>[(o(!0),m(_,null,h(p(ue).values,((e,t)=>(o(),m(u,{key:`categoymember-${t}`},{default:c((()=>[d(r,{onClick:t=>p(ue).model=e,color:p(ue).model==e?"primary":void 0,rounded:""},{default:c((()=>[x(f("Prospect"==e?"":e),1)])),_:2},1032,["onClick","color"])])),_:2},1024)))),128))])),_:1})):b("v-if",!0)]),d("div",Lt,[b(" memberInformation "),g(d(k,{type:"create",title:p(y).text,inputs:p(n),onChangeStep:j,onReturData:P},null,8,["title","inputs"]),[[C,1==l.value]]),b(" parentGuardian "),g(d(M,{title:p(y).text,onChangeStep:j},null,8,["title"]),[[C,2==l.value&&"Minor"==p(ue).model]]),b(" familyMembers "),g(d(w,{type:"create",title:p(y).text,inputs:p(me),onChangeStep:j,onReturData:O},null,8,["title","inputs"]),[[C,2==l.value&&"Adult"==p(ue).model]]),b(" contactPreference "),g(d(N,{type:"create",title:p(y).text,inputs:p(de),onChangeStep:j,onReturnData:A},null,8,["title","inputs"]),[[C,3==l.value||2==l.value&&"Prospect"==p(ue).model]]),b(" selectMembership "),g(d(V,{type:"create",member:p(n),familiares:$.value,title:p(y).text,inputs:p(X),memberships:p(Pe),notes:p(oe),onChangeStep:j,onReturnData:F},null,8,["member","familiares","title","inputs","memberships","notes"]),[[C,4==l.value]]),b(" paymentMethod "),5==l.value?(o(),m(D,{key:0,type:"create",title:p(y).text,member:p(n),familiares:$.value,inputs:p(X),"member-membership":p(Y),"family-membership":E.value,onChangeStep:j},null,8,["title","member","familiares","inputs","member-membership","family-membership"])):b("v-if",!0)]),d("div",Ut,[(o(!0),m(_,null,h(p(S),((e,t)=>(o(),m(I,{key:t,active:e.step<=l.value,step:e.step,text:e.text},null,8,["active","step","text"])))),128))])])])),_:1})}}});export default zt;
