import{n as a,A as e,g as s}from"./index.7b1c874f.js";import{l as t}from"./Companies.4c6a9643.js";import{v as o}from"./Discounts.0fce10d7.js";import{r as l,z as n,b as u}from"./vendor.19da945b.js";const c=l([]),r=l(!1);l(!1);const i=l(1),d=l(null),v=l(!1),p=l(!1),m=l(null),_=l(null),h=l(!1),f=e=>{const s=c.value.findIndex((a=>a.product_id==e.id));if(e.stock&&e.stock.current_stock>0)if(-1==s)c.value.push({product_id:e.id,count:1,products_amount:e.price,name:e.name,stock:e.stock.current_stock});else{c.value.find((a=>a.product_id==e.id)).count+1<=e.stock.current_stock?c.value.find((a=>a.product_id==e.id)).count++:a.error("Sin Stock")}else a.error("Sin Stock")},y=n([{typeInput:"selectDataActionChangeInput",name:"discount",placeholder:"Discount",values:[],data:null,model:"",disabled:!1,class:"is-12",isLabel:!0,change:function(){""!=this.model?o(this.values.find((a=>a.id==this.model)).code,"membership").then((e=>{this.data=e.data,a.success("Discuount valid")})).catch((e=>{a.error(e.response.data),this.model=""})):this.data=null},filter:function(a){return`${a.name}`}}]),k=u((()=>{let a=0;c.value.forEach((e=>{a+=e.products_amount*e.count}));let e=0;return w.value&&(e="percentaje"==w.value.type?a*w.value.value/100:w.value.value),a-e})),b=u((()=>7*k.value/100)),w=u((()=>s(y,"discount").data?s(y,"discount").data:null)),g=u((()=>k.value+b.value)),S=(e,s,t)=>{"minus"==e?(s.count>0&&s.count--,0==s.count&&c.value.splice(t,1)):s.count+1<=s.stock?s.count++:a.error("Sin Stock")},j=l(0),x=u((()=>{const a=parseFloat(j.value)-parseFloat(g.value);return a>0?a:0})),D=a=>{j.value=parseFloat(j.value)+parseFloat(a)},F=l(null),A=l({email:null,phone:null,barcode:null}),C=()=>{const e={total:g.value,tax_id:1,payment_type_id:F.value,email:A.value.email,phone:A.value.phone,barcode:A.value.barcode,change_back:x.value,products:c.value,locations_id:s(t.value,"locations_id").model};w.value&&(e.discount=w.value.id),I(e).then((e=>{console.log(e.data),1==F.value&&(F.value=null,A.value.email=null,A.value.phone=null,A.value.barcode=null,j.value=0,c.value=[],i.value=3,r.value=!1),3==F.value&&(d.value=e.data.order),d.value=e.data.order,a.success("Success"),z({invoice_pdf:e.data.invoice_pdf,order:e.data.order})})).catch((e=>{a.error(e.response.data.message)}))},I=async a=>await e.post("orders",a),$=async a=>await e.post("orders/activate",{payment_intent_client_secret:a});l(""),l(null);const z=a=>{_.value=a.invoice_pdf,d.value=a.order,v.value=!0},q=async a=>await e.post("orders/store_debit_automatic",a),B=async a=>await e.post("orders/swipe_card",a),E=async a=>await e.post("orders/cancel_payment_intent",{id:a}),L=async(a,s)=>await e.post("orders/another_try",{id:a,terminal_id:s}),G=async a=>await e.post("orders/capture_payment",{id:a}),H=async(a,s)=>await e.post(`orders/send_receipt/${a}`,{email:s}),J=async(a,s,t)=>await e.post(`orders/send_invoice_mail/${a}`,{email:s,invoice_pdf:t});export{h as A,$ as B,p as C,f as a,c as b,S as c,g as d,r as e,j as f,x as g,D as h,z as i,q as j,y as k,_ as l,m,H as n,d as o,C as p,J as q,F as r,k as s,b as t,v as u,w as v,B as w,E as x,L as y,G as z};
