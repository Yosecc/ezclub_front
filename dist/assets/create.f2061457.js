import{_ as e}from"./V-Placeload.9d0101ab.js";import{_ as t}from"./V-Button.vue_vue&type=script&setup=true&lang.a97a12f7.js";import{_ as a}from"./V-Avatar.vue_vue&type=script&setup=true&lang.acbf948e.js";import{_ as s}from"./V-Control.b36667bf.js";import{_ as l}from"./V-Field.vue_vue&type=script&setup=true&lang.189c1bf7.js";import{_ as o}from"./V-Tag.vue_vue&type=script&setup=true&lang.eb96c098.js";import{_ as u}from"./V-FlexTable.vue_vue&type=script&setup=true&lang.a0cb7547.js";import{_ as r}from"./V-PlaceholderSection.vue_vue&type=script&setup=true&lang.3abc5d60.js";import{_ as n}from"./V-Modal.vue_vue&type=script&setup=true&lang.daae4ec3.js";import{_ as c}from"./SidebarLayout.vue_vue&type=script&setup=true&lang.2b0913ad.js";import{d as i,z as p,r as d,A as v,b as m,o as f,h as y,B as _,D as b,j as g,E as k,k as h,K as j,L as x,N as V,O as S,G as C,S as P,H as w}from"./vendor.e3a29b40.js";import{p as U}from"./sidebarLayoutState.436b738a.js";import{l as I,a as K,b as T,d as A}from"./Inventory.9da08c71.js";import{g as D,p as q}from"./Products.e0c659c1.js";import{n as B}from"./ActivityPanel.vue_vue&type=style&index=0&lang.6ca24eb8.js";import{a as L}from"./index.33529e5c.js";import"./TaskPanel.vue_vue&type=style&index=0&lang.5c60cd1f.js";import"./V-Message.vue_vue&type=script&setup=true&lang.f3abd056.js";import"./V-Tabs.vue_vue&type=script&setup=true&lang.b59ccca7.js";import"./V-Icon.vue_vue&type=script&setup=true&lang.1a89ef3a.js";import"./navbarLayoutState.eac28a0a.js";import"./V-Dropdown.7404a3e2.js";import"./useDropdown.dfad556c.js";import"./video.674f0486.js";import"./activePanelState.5a49edcb.js";import"./darkModeState.a53f3c67.js";import"./SearchPanel.vue_vue&type=style&index=0&lang.2f79059e.js";import"./AnimatedLogo.e43df3fc.js";import"./V-IconBox.vue_vue&type=script&setup=true&lang.5e6c3f74.js";import"./V-Block.vue_vue&type=script&setup=true&lang.f5251e79.js";import"./UserPopoverContent.vue_vue&type=script&setup=true&lang.16aa198e.js";import"./userPopovers.f4b9fc60.js";import"./Toolbar.vue_vue&type=script&setup=true&lang.c5504f9b.js";import"./Companies.7d0f7197.js";import"./V-SwitchSegment.vue_vue&type=script&setup=true&lang.16e258e3.js";import"./V-Checkbox.vue_vue&type=script&setup=true&lang.f00f67a3.js";import"./moment.08a7f518.js";import"./notyf.es.f84e4201.js";import"./fastpizza.1e58d0ec.js";const z={key:0,class:"page-content-inner"},F={class:"title is-4 mb-0"},$={class:"title is-6 mb-0"},E={key:0,class:"title is-6"},M={key:1},N={class:"title is-5"},G={key:2},H={class:"d-flex justify-content-end mb-4 w-100"},O=w("Back"),J=w("Save"),Q=h("div",{class:"flex-table-header"},[h("span",null,"Product"),h("span",null,"SKU"),h("span",null,"Previous stock"),h("span",null,"Current stock"),h("span",null,"Total"),h("span",null,"Providers"),h("span",null,"Date of admission"),h("span",null,"Status")],-1),R={class:"flex-table-cell","data-th":"product"},W={class:"light-text d-flex align-items-center"},X={class:"flex-table-cell","data-th":"SKU"},Y={class:"flex-table-cell","data-th":"current_stock"},Z={class:"flex-table-cell","data-th":"previous_stock"},ee={class:"flex-table-cell","data-th":"previous_stock"},te={class:"flex-table-cell","data-th":"previous_stock"},ae={class:"flex-table-cell","data-th":"previous_stock"},se={class:"flex-table-cell","data-th":"-"},le={class:"d-flex justify-content-end mt-4 w-100"},oe=w("Save"),ue=w("Confirm");var re=i({expose:[],setup(i){U.value="Inventory Create",p({title:"Inventory"});const w=_(),re=b();d([]),v((()=>{if(de.value=!0,!w.query.locations_id)return B.error("la location es requerida"),void console.error("la locacion es requerida");I.value=w.query.locations_id,D(I.value,"active").then((e=>{K(w.query.id).then((e=>{ie(),de.value=!1}))}))}));const ne=d([]),ce=m((()=>ne.value)),ie=()=>{q.value.forEach((e=>{let t=null,a=null,s=null,l=!1,o=null,u=null;if(null!=T.value.products){const r=T.value.products.find((t=>t.product_id==e.id));console.log("element",e),console.log("product",r),null!=r?(a=r.previous_stock,t=r.current_stock,s=t+a,l=!0,o=r.proveedor,u=r.ingreso):(a=e.stock?e.stock.current_stock:0,s=a)}let r={id:e.id,name:e.name,photo:e.photo,current_stock:t,previous_stock:a,subtotal:s,status:l,sku:e.sku,proveedor:o,ingreso:u};0==T.value.status&&0==r.status||ne.value.push(r)}))},pe=e=>{e.subtotal=parseFloat(e.previous_stock)+parseFloat(e.current_stock)},de=d(!1),ve=d(!1),me=d("Processing Inventory... Please do not close the browser window until the process is complete"),fe=()=>{ve.value=!1,de.value=!0;let e={products:_e.value};A(e).then((e=>{console.log("response.data",e.data),B.success("Data Save"),de.value=!1}))},ye=d({}),_e=d([]),be=()=>{ve.value=!0,ce.value.forEach((e=>{_e.value.push({product_id:e.id,previous_stock:e.previous_stock,current_stock:e.subtotal,proveedor:e.proveedor,ingreso:e.ingreso})})),console.log(_e.value),ye.value=`Do you want to save ${_e.value.length} products out of ${q.value.length}? Products not added in inventory will have stock = 0`},ge=m((()=>null!=T.value.products?T.value.products.length:""));return(i,p)=>{const d=e,v=t,m=a,_=s,b=l,w=o,U=u,I=r,K=n,A=c;return f(),y(A,null,{default:g((()=>[k(T)?(f(),y("div",z,[h("h1",F,"Inventory #"+j(k(T).id),1),h("h1",$," Status: "+j(1==k(T).status?"Active":"Close"),1),k(T)?(f(),y("h1",E," Products: "+j(k(ge)),1)):x("",!0),de.value?(f(),y("div",M,[h("p",N,j(me.value),1),h(d,{height:"200px"})])):(f(),y("div",G,[h("div",H,[h(v,{color:"",raised:"",onClick:p[1]||(p[1]=e=>k(re).back()),class:"mr-3"},{default:g((()=>[O])),_:1}),k(T).status?(f(),y(v,{key:0,color:"success",onClick:be,raised:""},{default:g((()=>[J])),_:1})):x("",!0)]),h(U,null,{header:g((()=>[Q])),body:g((()=>[(f(!0),y(V,null,S(ne.value,(e=>(f(),y("div",{key:e.id,class:"flex-table-item"},[h("div",R,[h("span",W,[h(m,{picture:`${k(L)}storage/${e.photo}`,color:"primary",size:"medium",class:"mr-3"},null,8,["picture"]),h("div",null,[h("p",null,j(e.name),1)])])]),h("div",X,[h("p",null,[h("small",null,j(e.sku),1)])]),h("div",Y,[h(b,null,{default:g((()=>[h(_,null,{default:g((()=>[C(h("input",{"onUpdate:modelValue":t=>e.previous_stock=t,type:"number",class:"input",readonly:0==k(T).status,onKeyup:t=>pe(e),onChange:t=>pe(e)},null,40,["onUpdate:modelValue","readonly","onKeyup","onChange"]),[[P,e.previous_stock]])])),_:2},1024)])),_:2},1024)]),h("div",Z,[h(b,null,{default:g((()=>[h(_,null,{default:g((()=>[C(h("input",{"onUpdate:modelValue":t=>e.current_stock=t,type:"number",class:"input",readonly:0==k(T).status,onKeyup:t=>pe(e),onChange:t=>pe(e)},null,40,["onUpdate:modelValue","readonly","onKeyup","onChange"]),[[P,e.current_stock]])])),_:2},1024)])),_:2},1024)]),h("div",ee,[h("p",null,j(isNaN(e.subtotal)?0:e.subtotal),1)]),h("div",te,[h(b,null,{default:g((()=>[h(_,null,{default:g((()=>[C(h("input",{"onUpdate:modelValue":t=>e.proveedor=t,type:"text",class:"input",readonly:0==k(T).status},null,8,["onUpdate:modelValue","readonly"]),[[P,e.proveedor]])])),_:2},1024)])),_:2},1024)]),h("div",ae,[h(b,null,{default:g((()=>[h(_,null,{default:g((()=>[C(h("input",{"onUpdate:modelValue":t=>e.ingreso=t,type:"date",class:"input",readonly:0==k(T).status},null,8,["onUpdate:modelValue","readonly"]),[[P,e.ingreso]])])),_:2},1024)])),_:2},1024)]),h("div",se,[e.status?(f(),y(w,{key:0,color:"success",label:"Save",rounded:"",elevated:""})):(f(),y(w,{key:1,color:void 0,label:"Pending",rounded:"",elevated:""}))])])))),128))])),_:1}),h("div",le,[k(T).status?(f(),y(v,{key:0,color:"success",onClick:be,raised:""},{default:g((()=>[oe])),_:1})):x("",!0)])])),h(K,{open:ve.value,actions:"center",onClose:p[2]||(p[2]=e=>ve.value=!1)},{content:g((()=>[h(I,{title:"Are you sure you want to save the changes?",subtitle:"This action will affect the stock of all products and cannot be undone."}),h("p",null,j(ye.value),1)])),action:g((()=>[h(v,{color:"primary",onClick:fe,raised:""},{default:g((()=>[ue])),_:1})])),_:1},8,["open"])])):x("",!0)])),_:1})}}});export default re;
