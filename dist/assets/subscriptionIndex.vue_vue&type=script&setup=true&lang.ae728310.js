import{_ as e}from"./V-Card.vue_vue&type=script&setup=true&lang.d3d76712.js";import{_ as s}from"./inputsLayaut.vue_vue&type=style&index=0&lang.082bb801.js";import{_ as t}from"./V-Button.vue_vue&type=script&setup=true&lang.940c9f5e.js";import{_ as l}from"./V-Loader.vue_vue&type=script&setup=true&lang.72c1da57.js";import{d as a,r as n,o as i,i as c,j as o,B as u,k as r,l as d,I as p,G as m,S as v,c as f,F as b,W as y,X as _,H as h,_ as x,O as k,U as g,L as C,w as D}from"./vendor.b96c0b62.js";import{g as Y,a as j,p as M,n as V,m as w}from"./index.00880309.js";import{g as O}from"./Discounts.87bc234c.js";import{g as z}from"./Staffs.e1250f8e.js";import{a as A,f as P}from"./Companies.d716ac27.js";import{g as S}from"./Diciplines.4bb0d6a4.js";import{u as L,c as q,p as N,a as R,h as I,b as E,d as T,e as B,i as H,f as U,s as G,r as $,j as X,k as F,g as W,l as J}from"./Subscriptions.595d1bc0.js";import{_ as K}from"./V-SwitchBlock.vue_vue&type=script&setup=true&lang.3ea5d316.js";import{_ as Q}from"./V-Control.9f6b030b.js";import{_ as Z}from"./V-Field.vue_vue&type=script&setup=true&lang.9839f63b.js";import{s as ee,_ as se,a as te,g as le}from"./MemberCards.41ebb950.js";import{_ as ae}from"./V-Modal.vue_vue&type=script&setup=true&lang.793fc7c9.js";import{_ as ne,a as ie}from"./subscription-method-stripe-checkout.vue_vue&type=script&setup=true&lang.0975daa8.js";import{_ as ce}from"./Presupuesto.vue_vue&type=script&setup=true&lang.72dbe24c.js";const oe=m("Save");var ue=a({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(a,{emit:m}){const v=a,f=n(!1),b=n(!1),y=n([{typeInput:"checkboxGroupSimpleEventInput",name:"locations",placeholder:"Locations access",text:"Locations access",required:!0,values:[],model:"",disabled:!1,class:"is-12",isLabel:!0,change:function(e,s){S(this.model).then((e=>{e.data.length&&j(s,"diciplines",e.data)}))},click:function(){}},{typeInput:"DropdownCheckbox",name:"diciplines",text:"Disciplines",placeholder:"Disciplines",required:!1,model:[],values:[],disabled:!1,class:"is-12",isLabel:!0,drop:!1},{typeInput:"selectDataActionChangeInput",name:"discount",placeholder:"Discount",values:[],data:null,model:"",disabled:!1,class:"is-12",isLabel:!0},{typeInput:"DropdownCheckbox",name:"staff_id",placeholder:"Trainer",values:[],model:[],disabled:!1,required:!1,class:"is-12",isLabel:!0,drop:!1},{typeInput:"date",typeInputDefault:"date",name:"fecha_vencimiento",placeholder:"Next payment date",model:"",class:"is-6",isLabel:!0,required:!0},{name:"payment_type_id",typeInput:"selectData",placeholder:"Payment Type",model:"",required:!0,values:[{id:1,name:"Cash"},{id:3,name:"Debit automatic"}],class:"is-6",isLabel:!0,filterOptionText:function(e){return e.name}}]);i((()=>{(async()=>{b.value=!0,Y(y.value,"fecha_vencimiento").model=u(v.suscripcion.estado.fecha_vencimiento,"YYYY-MM-DD").format("YYYY-MM-DD"),Y(y.value,"payment_type_id").model=v.suscripcion.payment_type_id,v.suscripcion.memberships_members&&v.suscripcion.memberships_members.diciplines.length&&(Y(y.value,"diciplines").model=v.suscripcion.memberships_members.diciplines.map((e=>e.diciplines_id))),v.suscripcion.member&&v.suscripcion.member.trainers.length&&(Y(y.value,"staff_id").model=v.suscripcion.member.trainers.map((e=>e.staffs_id))),v.suscripcion.discount&&(Y(y.value,"discount").model=v.suscripcion.discount.id),await A().then((e=>{if(j(y,"locations",P.value),v.suscripcion&&v.suscripcion.memberships_members&&v.suscripcion.memberships_members.locaciones.length){const e=v.suscripcion.memberships_members.locaciones.map((e=>e.companies_locations_id));Y(y.value,"locations").model=e,S(e).then((e=>{e.data.length&&j(y,"diciplines",e.data)}))}})),await O().then((e=>{j(y,"discount",e.data.discounts)})),await z().then((e=>{j(y,"staff_id",e.data)})),b.value=!1})()}));const _=async()=>{const e=M(y.value);f.value=!0,await L(v.suscripcion.id,e).then((e=>{f.value=!1,m("reload")}))};return(a,n)=>{const i=s,u=t,m=l,v=e;return c(),o(m,{class:"h-100",size:"small",active:b.value},{default:r((()=>[d(v,{class:""},{default:r((()=>[p(" {{ props.suscripcion }} "),d(i,{"inputs-step":y.value},null,8,["inputs-step"]),d(m,{class:"h-100",size:"small",active:f.value},{default:r((()=>[d(u,{color:"primary",onClick:_,size:"small"},{default:r((()=>[oe])),_:1})])),_:1},8,["active"])])),_:1})])),_:1},8,["active"])}}});const re=d("p",null,[d("b",null,"Cancel Suscription")],-1);var de=a({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(s,{emit:t}){const a=s,u=n(!1),p=()=>{u.value=!0,q(a.suscripcion.id,{}).then((e=>{u.value=!1,t("reload")})).catch((e=>{u.value=!1}))};return i((()=>{})),(s,t)=>{const a=e,n=l;return c(),o(n,{class:"h-100",size:"small",active:u.value},{default:r((()=>[d(a,{color:"danger",outlined:"",onClick:p,class:"\n        mr-4\n        btn-card\n        text-center\n        px-2\n        h-100\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:r((()=>[re])),_:1})])),_:1},8,["active"])}}});const pe={class:"d-flex justify-content-between align-items-start"},me=d("div",null,[d("p",{class:"title is-3"},[d("i",{class:"fas fa-credit-card","aria-hidden":"true"})]),d("p",{class:"title is-5"},"Debit Automatic")],-1),ve={key:0,class:"title is-6"},fe=d("i",{class:"fas fa-check","aria-hidden":"true"},null,-1),be=d("p",null,[d("b",null,"Cards")],-1),ye={class:"pb-3 mb-5"},_e=m(" Sync Cards "),he=m("Confirm");var xe=a({expose:[],props:{total:{type:Number,required:!0},user:{type:Object,required:!0},card:{type:Boolean,default:!1}},emits:["onPayment"],setup(s,{emit:a}){const i=s,u=n(!1),m=()=>{null!=_.value?(u.value=!1,a("onPayment",{amount:i.total,payment_type_id:3,payment_method_id:_.value})):V.error("Select card")},f=n(!1),b=n(!0),y=()=>{ee(i.user.id).then((e=>{b.value=!1,setTimeout((()=>{b.value=!0}),100)}))},_=n(null);return(s,a)=>{const n=e,h=l,x=t,k=se,g=ae;return c(),o(v,null,[i.card?(c(),o(h,{key:1,class:"h-100",size:"small",active:s.isLoaderActive},{default:r((()=>[d(n,{color:"success",outlined:"",onClick:a[2]||(a[2]=e=>u.value=!0),class:"\n        mr-4\n        btn-card\n        text-center\n        px-2\n        h-100\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:r((()=>[be])),_:1})])),_:1},8,["active"])):(c(),o(n,{key:0,onClick:a[1]||(a[1]=e=>u.value=!0),color:"success",class:"mx-2 btn-card w-100 justify-content-center"},{default:r((()=>[d("div",pe,[me,(c(),o("p",ve,[fe]))])])),_:1})),p("  "),d(g,{title:"",size:"big",open:u.value,actions:"center",onClose:a[4]||(a[4]=e=>u.value=!1)},{content:r((()=>[d("div",ye,[d(h,{size:"large",active:f.value},{default:r((()=>[d(x,{color:"undefined",onClick:y,class:"d-flex justify-content-center",raised:""},{default:r((()=>[_e])),_:1})])),_:1},8,["active"])]),i.user&&u.value&&b.value?(c(),o(k,{key:0,"show-option":!0,class:"mb-6",modelValue:_.value,"onUpdate:modelValue":a[3]||(a[3]=e=>_.value=e),method_default:i.user.pm_last_four,"show-new-card":!0,user:i.user,"on-new-card-u-r-l":"v2/stripe/setup","add-card-stripe-u-r-l":"v2/stripe/addCard",v2:!0,actions:[]},null,8,["modelValue","method_default","user"])):p("v-if",!0)])),action:r((()=>[d(x,{color:"success",onClick:m,disabled:!_.value,class:"d-flex justify-content-center",raised:""},{default:r((()=>[he])),_:1},8,["disabled"])])),_:1},8,["open"])],64)}}});const ke={key:0},ge={key:1},Ce=d("small",null,"by default it will be scheduled for the next payment",-1),De={class:"columns is-multiline"},Ye={class:"column is-4"},je=d("p",{class:"title is-6 mb-1"},[d("b",null,"Total")],-1),Me={class:"title is-3 mb-0"},Ve={class:"is-4 column mx-auto"},we={class:"is-4 column mx-auto"};var Oe=a({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(s,{emit:t}){const a=s,i=n(!0),u=n(!1),m=(e=null)=>{u.value=!0,e&&(e.isProrrateo=i.value),N(a.suscripcion.id,e).then((e=>{u.value=!1,v.value=!1,V.success("Success"),t("reload")})).catch((e=>{console.log(e),V.error("Error"),u.value=!1,v.value=!1}))},v=n(!1),x=()=>{v.value=!1},k=f((()=>a.suscripcion.memberships_members.multigym));f((()=>a.suscripcion.presupuesto));const g=f((()=>a.suscripcion.user)),C=n(0),D=()=>{k.value?(i.value=!1,m()):(R(a.suscripcion.id,{}).then((e=>{C.value=e.data})),i.value=!0,v.value=!0)};return(s,t)=>{const a=e,n=K,f=Q,Y=Z,j=l,M=xe,V=ne,O=ae;return c(),o(j,{class:"h-100",size:"small",active:u.value},{default:r((()=>[d(a,{color:"info",outlined:!b(k),onClick:D,class:"\n        mr-4\n        btn-card\n        text-center\n        px-2\n        h-100\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:r((()=>[d("p",null,[b(k)?(c(),o("b",ge,"Disable MultiGym ")):(c(),o("b",ke,"Activate MultiGym "))])])),_:1},8,["outlined"]),d(O,{open:v.value,size:"big",actions:"center",noscroll:"",onClose:x},{content:r((()=>[d(Y,null,{default:r((()=>[d(f,null,{default:r((()=>[d(n,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),label:"Make the prorated charge",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1}),y(d("p",null,[Ce],512),[[_,!i.value]]),i.value?(c(),o(a,{key:0,style:{"margin-bottom":"24px"}},{default:r((()=>[d("div",De,[d("div",Ye,[d(j,{size:"small",class:"h-100",active:u.value},{default:r((()=>[d(a,{class:"mb-4 h-100"},{default:r((()=>[d("div",null,[je,d("p",Me,h(b(w)(C.value)),1)])])),_:1})])),_:1},8,["active"])]),d("div",Ve,[d(j,{size:"small",active:u.value},{default:r((()=>[d(M,{total:C.value,user:b(g),onOnPayment:m},null,8,["total","user"])])),_:1},8,["active"])]),d("div",we,[d(j,{size:"small",active:u.value},{default:r((()=>[d(V,{total:C.value,onOnPayment:m},null,8,["total"])])),_:1},8,["active"])])])])),_:1})):p("v-if",!0)])),action:r((()=>[p(' <VButton color="primary" @click="onAction"> Confirm</VButton> ')])),_:1},8,["open"])])),_:1},8,["active"])}}});const ze=d("p",null,[d("b",null,"HOLD Membership")],-1),Ae={key:0},Pe=m("Active until: "),Se=d("br",null,null,-1),Le=d("label",{for:"hold_date_start"},[d("p",null,"Hold date start")],-1),qe=d("label",{for:"hold_date_end"},[d("p",null,"Hold date end")],-1),Ne=m("Confirm");var Re=a({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(s,{emit:a}){const _=s,k=n(!1),g=n(!1),C=n(u(_.suscripcion.hold_date_start).format("YYYY-MM-DD")),D=n(u(_.suscripcion.hold_date_end).format("YYYY-MM-DD")),Y=()=>{I(_.suscripcion.id,{hold_date_start:C.value,hold_date_end:D.value}).then((e=>{g.value=!1,V.success("success"),a("reload")})).catch((e=>{g.value=!1}))},j=f((()=>_.suscripcion.isHold));return i((()=>{})),(s,a)=>{const n=e,i=l,f=t,M=ae;return c(),o(v,null,[d(i,{size:"small",class:"h-100",active:k.value},{default:r((()=>[d(n,{color:"warning",outlined:null==_.suscripcion.hold_date_end,onClick:a[1]||(a[1]=e=>b(j)?Y():g.value=!0),class:"\n        mr-4\n        btn-card\n        text-center\n        h-100\n        px-2\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:r((()=>[ze,d("p",null,[null!=_.suscripcion.hold_date_end?(c(),o("span",Ae,[Pe,Se,m(" "+h(b(u)(_.suscripcion.hold_date_start).format("MM/DD/YYYY"))+" - "+h(b(u)(_.suscripcion.hold_date_end).format("MM/DD/YYYY")),1)])):p("v-if",!0)])])),_:1},8,["outlined"])])),_:1},8,["active"]),d(M,{open:g.value,actions:"center",onClose:a[4]||(a[4]=e=>g.value=!1)},{content:r((()=>[Le,y(d("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=e=>C.value=e),class:"input mt-2 mb-4"},null,512),[[x,C.value]]),qe,y(d("input",{type:"date","onUpdate:modelValue":a[3]||(a[3]=e=>D.value=e),class:"input mt-2 mb-4"},null,512),[[x,D.value]])])),action:r((()=>[d(f,{onClick:Y,color:"primary",raised:""},{default:r((()=>[Ne])),_:1})])),_:1},8,["open"])],64)}}});const Ie=d("p",null,[d("b",null,"Upgrade Subscription")],-1);var Ee=a({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(s,{emit:t}){const a=s,u=n(!1),p=()=>{u.value=!0,E(a.suscripcion.id,{}).then((e=>{u.value=!1,t("reload")})).catch((e=>{u.value=!1}))};return i((()=>{})),(s,t)=>{const a=e,n=l;return c(),o(n,{class:"h-100",size:"small",active:u.value},{default:r((()=>[d(a,{color:"primary",outlined:"",onClick:p,class:"\n        mr-4\n        btn-card\n        text-center\n        px-2\n        h-100\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:r((()=>[Ie])),_:1})])),_:1},8,["active"])}}});const Te=d("p",null,[d("b",null," Balances ")],-1),Be={class:"column is-4"},He=d("p",{class:"title is-6 mb-1"},[d("b",null,"Total")],-1),Ue={class:"title is-3 mb-0"},Ge=d("label",{for:""},[d("p",null,"Amount")],-1),$e={class:"columns is-multiline"},Xe={class:"column is-4"},Fe=d("p",{class:"title is-6 mb-1"},[d("b",null,"Total")],-1),We={class:"title is-3 mb-0"},Je={class:"is-4 column mx-auto"},Ke={class:"is-4 column mx-auto"};var Qe=a({expose:[],props:{suscripcion:{type:Object,required:!0}},emits:["reload"],setup(s,{emit:t}){const a=s,i=n(null),u=n(!1),m=(e=null)=>{u.value=!0,e.amount=i.value,console.log(e),te(k.value.id,e).then((e=>{u.value=!1,v.value=!1,V.success("Success"),t("reload")})).catch((e=>{console.log(e),V.error("Error"),u.value=!1,v.value=!1}))},v=n(!1),_=()=>{v.value=!1},k=f((()=>a.suscripcion.user)),g=n(0),C=()=>{le(k.value.id).then((e=>{g.value=e.data.saldo,v.value=!0}))};return(s,t)=>{const a=e,n=l,f=Q,D=Z,Y=xe,j=ne,M=ae;return c(),o(n,{class:"h-100",size:"small",active:u.value},{default:r((()=>[d(a,{color:"info",outlined:!0,onClick:C,class:"\n        mr-4\n        btn-card\n        text-center\n        px-2\n        h-100\n        d-flex\n        align-items-center\n        justify-content-center\n      ",style:{"font-size":"14px"}},{default:r((()=>[Te])),_:1}),d(M,{open:v.value,size:"big",actions:"center",noscroll:"",onClose:_},{content:r((()=>[d("div",Be,[d(n,{size:"small",class:"h-100",active:u.value},{default:r((()=>[d(a,{class:"mb-4 h-100"},{default:r((()=>[d("div",null,[He,d("p",Ue,h(b(w)(g.value)),1)])])),_:1})])),_:1},8,["active"])]),d(D,null,{default:r((()=>[d(f,null,{default:r((()=>[Ge,y(d("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),class:"input",placeholder:"0.00"},null,512),[[x,i.value]])])),_:1})])),_:1}),d(a,{style:{"margin-bottom":"24px"}},{default:r((()=>[d("div",$e,[d("div",Xe,[d(n,{size:"small",class:"h-100",active:u.value},{default:r((()=>[d(a,{class:"mb-4 h-100"},{default:r((()=>[d("div",null,[Fe,d("p",We,h(b(w)(i.value)),1)])])),_:1})])),_:1},8,["active"])]),d("div",Je,[d(n,{size:"small",active:u.value},{default:r((()=>[d(Y,{total:i.value,user:b(k),onOnPayment:m},null,8,["total","user"])])),_:1},8,["active"])]),d("div",Ke,[d(n,{size:"small",active:u.value},{default:r((()=>[d(j,{total:i.value,onOnPayment:m},null,8,["total"])])),_:1},8,["active"])])])])),_:1})])),action:r((()=>[p(' <VButton color="primary" @click="onAction"> Confirm</VButton> ')])),_:1},8,["open"])])),_:1},8,["active"])}}});const Ze={class:"columns is-multiline"},es={class:"title is-4"},ss={class:"title is-5 text-left mt-2"},ts={class:"d-flex justify-content-end mb-4"},ls={key:0},as={key:1},ns=m("Accept and continue ");var is=a({expose:[],props:{suscripcion:{type:Object,default:{}}},emits:["update:modelValue","reload"],setup(a,{emit:u}){const m=a;k();const y=n([]),_=n(!0),x=n(!1),C=n(!1);i((()=>{T().then((e=>{y.value=e.data})),B(1,"membership").then((e=>{j(H,"discount",e.data.discounts)}))}));const D=f((()=>{const e=y.value.find((e=>e.id==G.memberships_id));return null==e?void 0:e.amounts.filter((e=>e.is_recurrence==_.value&&null!=e.recurrencia))})),M=f((()=>{for(var e in G)null!=Y(H.value,e)&&(G[e]=Y(H.value,e).model);return G})),O=()=>{U.value=null,C.value=!1,x.value=!0,X(M.value).then((e=>{U.value=e.data,u("update:modelValue",U.value),setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight||document.documentElement.scrollHeight),x.value=!1}),300)})).catch((e=>{const s=e.response.data;for(var t in x.value=!1,s)if("object"==typeof s[t]&&"object"==typeof s[t])for(var l in s[t])V.error(s[t][l])}))},z=()=>{C.value=!0;let e=M.value;e.suscripcion_id=m.suscripcion.id,e.email=m.suscripcion.user.email,$(e).then((e=>{u("reload")})).catch((e=>{}))};return(a,n)=>{const i=e,u=l,m=K,f=Q,k=Z,C=s,Y=t,j=ce;return c(),o(v,null,[d(i,{class:"mb-4"},{default:r((()=>[d(u,{size:"large",active:!y.value.length},{default:r((()=>[d("div",Ze,[(c(!0),o(v,null,g(y.value,((e,s)=>(c(),o("div",{key:`membership-${s}`,class:"column is-4 btn btn-card",onClick:s=>b(G).memberships_id=e.id},[d(i,{color:b(G).memberships_id==e.id?"primary":void 0,class:"h-100"},{default:r((()=>[d("div",null,[d("h1",es,h(e.name),1)])])),_:2},1032,["color"])],8,["onClick"])))),128))])])),_:1},8,["active"])])),_:1}),d(i,{class:"mb-4"},{default:r((()=>[d("div",null,[d(k,null,{default:r((()=>[d(f,null,{default:r((()=>[d(m,{modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=e=>_.value=e),label:"Recurring Subscription",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1}),(c(!0),o(v,null,g(b(D),((e,s)=>(c(),o("div",{key:`membership-precios-${s}`,class:"btn btn-card",onClick:s=>b(G).recurrences_id=e.id},[d(i,{color:b(G).recurrences_id==e.id?"primary":void 0,class:"mb-3 py-4"},{default:r((()=>[d("p",null,h(e.recurrencia.descriptions),1),d("p",ss,h(b(w)(e.amount)),1)])),_:2},1032,["color"])],8,["onClick"])))),128))])])),_:1}),d(i,{class:""},{default:r((()=>[d(C,{"inputs-step":b(H)},null,8,["inputs-step"])])),_:1}),d("div",ts,[d(u,{size:"large",active:x.value},{default:r((()=>[d(Y,{onClick:O,color:b(U)?void 0:"primary",class:"d-flex justify-content-center mt-6 py-5 w-100",style:{"text-align":"center","text-transform":"uppercase","font-size":"20px","font-weight":"900"}},{default:r((()=>[b(U)?(c(),o("span",as," restart")):(c(),o("span",ls,"start subscription"))])),_:1},8,["color"])])),_:1},8,["active"])]),b(U)?(c(),o(i,{key:0,class:"mb-4"},{default:r((()=>[d(j,{presupuesto:b(U)},null,8,["presupuesto"])])),_:1})):p("v-if",!0),b(U)?(c(),o(Y,{key:1,onClick:z,color:"primary",class:"d-flex justify-content-center py-5 px-6 ml-auto",style:{"text-align":"center","text-transform":"uppercase","font-size":"20px","font-weight":"900"}},{default:r((()=>[ns])),_:1})):p("v-if",!0)],64)}}});const cs={class:"columns is-multiline",style:{"min-height":"350px"}},os={class:"column is-3"},us=d("p",{class:"title is-6 mb-1"},[d("b",null,"Total")],-1),rs={key:0,class:"title is-3 mb-0"},ds={key:1,class:"title is-3 mb-0"},ps=d("div",{class:"column is-9"},[p(' <SearchBar class="" v-model="member" /> ')],-1),ms=m("] "),vs={key:0,class:"is-4 column mx-auto"},fs={key:1,class:"is-4 column mx-auto"},bs={key:2,class:"is-4 column mx-auto"},ys=d("div",{class:"mb-4 column is-12"},[p(' <inputsLayaut :slo="false" class="w-100" :inputs-step="discountInput" /> ')],-1);var _s=a({expose:[],props:{total:{type:Number,default:0,required:!0},user:{type:Object,default:{},required:!0},suscripcion_id:{type:Number,required:!0},metodos:{type:Array,default:["stripe-debit","cash"]}},emits:["proccessCheckout","reload"],setup(s,{emit:t}){const a=s;k();const i=n(!1),u=e=>{i.value=!0,F(a.suscripcion_id,e).then((e=>{i.value=!1,t("proccessCheckout")})).catch((e=>{if(i.value=!1,t("reload"),"object"==typeof e.response.data)for(var s in e.response.data)if("object"==typeof e.response.data[s])for(var l in e.response.data[s]){if("object"==typeof e.response.data[s][l])for(var a in e.response.data[s][l])V.error(e.response.data[s][l][a]);"string"==typeof e.response.data[s][l]&&V.error(e.response.data[s][l])}}))};return(t,n)=>{const m=e,v=l,f=xe,y=ie,_=ne;return c(),o("div",cs,[d("div",os,[d(v,{size:"small",active:i.value},{default:r((()=>[d(m,{class:"mb-4"},{default:r((()=>[C(t.$slots,"default"),d("div",null,[us,t.order?(c(),o("p",rs,h(b(w)(s.total)),1)):(c(),o("p",ds,h(b(w)(s.total)),1))])])),_:3})])),_:1},8,["active"])]),ps,p(' <div class="column is-12 mb-4">\n      <h1 class="title is-5">Payment methods</h1>\n       <div class="d-flex"> '),ms,a.metodos.includes("stripe-debit")?(c(),o("div",vs,[d(v,{size:"small",active:i.value},{default:r((()=>[d(f,{total:a.total,user:a.user,onOnPayment:u},null,8,["total","user"])])),_:1},8,["active"])])):p("v-if",!0),p('\n        <VCard\n          color="warning"\n          :disabled="cashStatus"\n          @click=";(typePayment = 1), (openModalCash = true), payment"\n          class="mx-2 btn-card w-100 justify-content-center"\n        >\n          <p class="title is-3">\n            <i class="fas fa-money-bill" aria-hidden="true"></i>\n          </p>\n          <p class="title is-5">Cash</p>\n        </VCard>\n\n        <VCard\n          color="info"\n          :disabled="swipeCardStatus"\n          class="mx-2 btn-card w-100 justify-content-center"\n          @click="changeSwipwCard"\n          v-tooltip="!terminales.length ? \'No posee terminales\' : \'\'"\n        >\n          <div class="d-flex justify-content-between align-items-start">\n            <div>\n              <p class="title is-3">\n                <i class="fas fa-money-check-alt" aria-hidden="true"></i>\n              </p>\n              <p class="title is-5">Swipe Card</p>\n            </div>\n            <p v-if="terminalesOoptions" class="title is-6">\n              <i class="fas fa-check" aria-hidden="true"></i>\n            </p>\n          </div>\n        </VCard>\n      </div> '),p(' <div class="is-4 column mx-auto">\n        <VCard\n          style="background: #388e3c"\n          v-if="order"\n          class="mx-2 mx-auto btn-card justify-content-center"\n          @click="openModalRecibo = true"\n        >\n          <div class="d-flex justify-content-between align-items-start">\n            <div>\n              <p class="title is-3">\n                <i\n                  class="fas fa-receipt"\n                  style="color: white !important"\n                  aria-hidden="true"\n                ></i>\n              </p>\n              <p class="title is-5" style="color: white !important">\n                View Order\n              </p>\n            </div>\n            <p v-if="openModalRecibo" class="title is-6">\n              <i class="fas fa-check" aria-hidden="true"></i>\n            </p>\n          </div>\n        </VCard>\n      </div> '),p(" Terminales "),p(' <div class="mt-4 mx-2" v-if="terminalesOoptions">\n        <div\n          v-for="(terminal, key) in terminales"\n          :key="`terminal-${key}`"\n          class="columns is-multiline"\n        >\n          <div class="column">\n            <VCard\n              class="p-4 btn-card"\n              :class="paymentIntent && terminal_id == terminal.id ? \'is-3\' : \'\'"\n              :disabled="paymentIntent && terminal_id == terminal.id"\n              :color="terminal_id == terminal.id ? \'info\' : \'\'"\n              @click="paymentSwipeCard(terminal.id)"\n            >\n              <p class="title is-1">\n                <i class="lnir lnir-postcard" aria-hidden="true"></i>\n              </p>\n              <p class="title is-5">{{ terminal.label }}</p>\n              <p>Serial number: {{ terminal.serial_number }}</p>\n              <p>Status: {{ terminal.status }}</p>\n            </VCard>\n          </div>\n\n          <div\n            v-if="paymentIntent && terminal_id == terminal.id"\n            class="column flex-column d-flex justify-content-between is-3"\n          >\n            <VCard\n              color="danger"\n              class="mb-2 btn-card d-flex justify-content-center"\n              @click="oncancelPayment()"\n            >\n              <p class="title is-5">Cancel Payment</p>\n            </VCard>\n            <VCard\n              color="warning"\n              class="btn-card d-flex justify-content-center"\n              @click="onretryPayment()"\n            >\n              <p class="title is-5">Retry Payment</p>\n            </VCard>\n          </div>\n\n          <div\n            v-if="paymentIntent && terminal_id == terminal.id"\n            class="column is-5"\n          >\n            <VCard\n              color="success"\n              class="\n                btn-card\n                h-100\n                d-flex\n                justify-content-center\n                align-items-center\n              "\n              @click="onfinishPayment()"\n            >\n              <p class="title is-3">Finish payment</p>\n            </VCard>\n          </div>\n        </div>\n      </div> '),p("  "),a.metodos.includes("stripe-checkout")?(c(),o("div",fs,[d(v,{size:"small",active:i.value},{default:r((()=>[d(y,{total:a.total,onOnPayment:u},null,8,["total"])])),_:1},8,["active"])])):p("v-if",!0),a.metodos.includes("cash")?(c(),o("div",bs,[d(v,{size:"small",active:i.value},{default:r((()=>[d(_,{total:a.total,onOnPayment:u},null,8,["total"])])),_:1},8,["active"])])):p("v-if",!0),p(" // "),p(' <shopping-checkout-debit-automatic v-if="showOptionsDebit" /> '),p(" </div> "),ys,p(' <shopping-send-recibo v-model="openModalRecibo" /> ')])}}});const hs=d("p",{class:"title is-5"},"Payments",-1),xs={class:"table is-hoverable is-fullwidth"},ks=d("thead",null,[d("tr",null,[d("th",{scope:"col"},"Date"),d("th",{scope:"col"},"Type"),d("th",{scope:"col"},"Description"),d("th",{scope:"col"},"Status"),d("th",{scope:"col"},"Amount"),d("th",{scope:"col"},"Action")])],-1),gs=d("td",null,"Suscription",-1);var Cs=a({expose:[],props:{payments:{type:Number,required:!0}},setup:s=>(t,l)=>{const a=e;return c(),o("div",null,[d(a,{class:"mb-4 -flex justify-content-between align-items-center cardprofile"},{default:r((()=>[d("div",null,[hs,d("table",xs,[ks,d("tbody",null,[(c(!0),o(v,null,g(s.payments,((e,s)=>(c(),o("tr",{key:`payment-${s}`},[d("td",null,h(b(u)(e.created_at).format("MM-DD-Y")),1),d("td",null,h(e.payment_type.name),1),gs,d("td",null,h(e.status_description)+" / "+h(e.status),1),d("td",null,h(e.amount),1),d("td",null,[d("a",{href:e.url_pdf,target:"_blank",rel:"noopener noreferrer"},"View Pdf",8,["href"])])])))),128))])])])])),_:1})])}});const Ds={key:0},Ys={class:"d-flex justify-content-between"},js={class:"title is-5 mb-0"},Ms=m("Membership: "),Vs=m(" Current billing location: "),ws={class:"title is-4 mb-0"},Os={class:"text-right"},zs=d("b",null,"Payment Method:",-1),As={key:0},Ps={key:0,class:"title is-4 mb-0"},Ss=d("br",null,null,-1),Ls={key:1,class:"title is-4 mb-0"},qs=d("br",null,null,-1),Ns={key:2,class:"title is-6"},Rs=d("br",null,null,-1),Is={key:1},Es=d("p",null,"no tiene presupuesto",-1),Ts={class:"d-flex flex-row mt-4"},Bs={class:"mr-3"},Hs=d("b",null,"Consultation date: ",-1),Us={class:"mr-3"},Gs=d("b",null,"Month: ",-1),$s={key:0,class:"mr-3"},Xs=d("b",null,"Start: ",-1),Fs={class:"mr-3"},Ws=d("b",null,"Next payment date: ",-1),Js={key:1,class:"mr-3"},Ks=d("b",null,"Cancellation Date: ",-1),Qs={key:2,class:"mr-3"},Zs=d("b",null,"Last payment attempt: ",-1),et={key:3,class:"mr-3"},st=d("b",null,"Status Last payment attempt: ",-1),tt={key:4,class:"d-flex"},lt={class:"mr-3"},at=d("b",null,"Months late: ",-1),nt={class:"mr-3"},it=d("b",null,"Days late: ",-1),ct={class:"mr-3"},ot=d("b",null,"Hours late: ",-1),ut={key:1,class:"columns"},rt={class:"column is-8 pt-0"},dt={class:"column is-4"},pt={class:"column is-12"},mt={class:"column is-12"},vt={class:"column is-12"},ft={class:"column is-12"},bt={class:"column is-12"},yt={class:"column is-12"},_t={key:3};var ht=a({expose:[],props:{suscripcion:{type:Object,default:null},member_id:{type:Number,default:null},code:{type:String,default:null}},setup(s){const t=s,a=k(),v=n(null),y=n(!1),_=()=>{let e=null;a.query.id&&(e=a.query.id),t.member_id&&(e=t.member_id),null==e&&t.code?W(t.code).then((e=>{v.value=e.data.suscripcion})):J(e).then((e=>{v.value=e.data.suscripcion}))},x=f((()=>t.suscripcion?t.suscripcion:v.value));i((()=>{_()})),D((()=>t.member_id),(()=>{_()}));const g=()=>{_()};return(s,t)=>{const a=e,n=ue,i=de,v=Oe,f=Re,k=Ee,C=Qe,D=xe,Y=l,j=is,M=_s,V=ce,O=Cs;return b(x)?(c(),o("div",Ds,[b(x)?(c(),o(a,{key:0,class:"mb-5",style:{background:b(x).estado.color}},{default:r((()=>[d("div",Ys,[d("span",null,[d("p",js," ESTADO : "+h(b(x).estado.estado_pago),1),d("p",null,[d("small",null,[Ms,d("small",null,[Vs,d("b",null,h(b(x).memberships_members.location.name),1)])])]),d("p",ws,h(b(x).membership.name),1),d("p",null,h(b(x).recurrence.recurrencia.descriptions),1)]),d("span",Os,[d("p",null,[d("small",null,[zs,m(" "+h(b(x).memberships_members.paymenttype.name),1)])]),d("p",null,[d("small",null,h(b(x).recurrence.is_recurrence?"Recurrence":"no recurrence"),1)]),b(x).presupuesto?(c(),o("span",As,[b(x).discount?(c(),o("p",Ls,[m(h(b(w)(b(x).presupuesto.total)),1),qs])):(c(),o("p",Ps,[m(h(b(w)(b(x).presupuesto.recurrente)),1),Ss])),b(x).discount?(c(),o("p",Ns,[d("small",null,h(b(x).discount.name),1),m(" : "+h(b(w)(b(x).presupuesto.total)),1),Rs])):p("v-if",!0)])):(c(),o("span",Is,[Es]))])]),d("div",Ts,[d("p",Bs,[Hs,m(" "+h(b(u)(b(x).estado.fecha_validacion,"YYYY-MM-DD").format("MM-DD-YYYY")),1)]),d("p",Us,[Gs,m(" "+h(b(x).estado.meses_pagados),1)]),b(x).schedules_start?(c(),o("p",$s,[Xs,m(" "+h(b(u)(b(x).schedules_start,"YYYY-MM-DD").format("MM-DD-YYYY")),1)])):p("v-if",!0),d("p",Fs,[Ws,m(" "+h(b(u)(b(x).estado.fecha_vencimiento,"YYYY-MM-DD").format("MM-DD-YYYY")),1)]),b(x).estado.fecha_suspencion?(c(),o("p",Js,[Ks,m(" "+h(b(u)(b(x).estado.fecha_suspencion,"YYYY-MM-DD").format("MM-DD-YYYY")),1)])):p("v-if",!0),b(x).memberships_members.payments.length?(c(),o("p",Qs,[Zs,m(" "+h(b(u)(b(x).memberships_members.payments[0].created_at).format("MM-DD-YYYY")),1)])):p("v-if",!0),b(x).memberships_members.payments.length?(c(),o("p",et,[st,m(" "+h(b(x).memberships_members.payments[0].status)+" / "+h(b(x).memberships_members.payments[0].status_description),1)])):p("v-if",!0),"VENCIDO"==b(x).estado.estado_pago?(c(),o("div",tt,[d("p",lt,[at,m(" "+h(b(x).estado.meses_retraso),1)]),d("p",nt,[it,m(" "+h(b(x).estado.dias_retraso),1)]),d("p",ct,[ot,m(" "+h(b(x).estado.horas_retraso),1)])])):p("v-if",!0)])])),_:1},8,["style"])):p("v-if",!0),["PROX. CANCELADO","CANCELADO"].includes(b(x).estado.estado_pago)?p("v-if",!0):(c(),o("div",ut,[d("div",rt,[d(n,{suscripcion:b(x),onReload:_},null,8,["suscripcion"])]),d("div",dt,["CANCELADO"!=b(x).estado.estado_pago?(c(),o(a,{key:0,class:"columns is-multiline p-1"},{default:r((()=>[d("div",pt,[d(i,{suscripcion:b(x),onReload:_},null,8,["suscripcion"])]),d("div",mt,[d(v,{suscripcion:b(x),onReload:_},null,8,["suscripcion"])]),d("div",vt,[d(f,{suscripcion:b(x),onReload:_},null,8,["suscripcion"])]),p(' <div class="column is-12">\n            <subscription-action-send-email\n              :suscripcion="suscripcionComputed"\n              @reload="onGetSuscripcion"\n            />\n          </div> '),d("div",ft,[d(k,{suscripcion:b(x),onReload:_},null,8,["suscripcion"])]),d("div",bt,[d(C,{suscripcion:b(x),onReload:_},null,8,["suscripcion"])]),d("div",yt,[d(Y,{size:"small",active:y.value},{default:r((()=>[d(D,{total:20,card:!0,user:b(x).user,onOnPayment:_},null,8,["user"])])),_:1},8,["active"]),p(' <subscription-action-cards\n              :suscripcion="suscripcionComputed"\n              @reload="onGetSuscripcion"\n            /> ')])])),_:1})):p("v-if",!0)])])),b(x)&&["CANCELADO","PROX. CANCELADO"].includes(b(x).estado.estado_pago)?(c(),o(j,{key:2,modelValue:b(x).presupuesto,"onUpdate:modelValue":t[1]||(t[1]=e=>b(x).presupuesto=e),suscripcion:b(x),onReload:t[2]||(t[2]=e=>_())},null,8,["modelValue","suscripcion"])):p("v-if",!0),["CANCELADO","PROX. CANCELADO","HOLD"].includes(b(x).estado.estado_pago)?p("v-if",!0):(c(),o("div",_t,[b(x)&&b(x).presupuesto&&"PAGADO"!=b(x).estado.estado_pago?(c(),o(M,{key:0,total:b(x).presupuesto.total,user:b(x).user,suscripcion_id:b(x).id,onProccessCheckout:g,onReload:_},null,8,["total","user","suscripcion_id"])):p("v-if",!0),b(x)&&b(x).presupuesto&&"PAGADO"!=b(x).estado.estado_pago?(c(),o(a,{key:1},{default:r((()=>[d(V,{presupuesto:b(x).presupuesto},null,8,["presupuesto"])])),_:1})):p("v-if",!0)])),b(x)&&"CANCELADO"!=b(x).estado.estado_pago?(c(),o(O,{key:4,payments:b(x).memberships_members.payments},null,8,["payments"])):p("v-if",!0)])):p("v-if",!0)}}});export{ht as _};
