import{_ as e}from"./V-Button.vue_vue&type=script&setup=true&lang.e4f3f19e.js";import{_ as a}from"./V-Card.vue_vue&type=script&setup=true&lang.e9093fe9.js";import{d as t,s,e as i,l,f as n,m as o,n as d,p as c,c as r,o as u,_ as m}from"./Companies.88a0ca09.js";import{_ as p}from"./formLayaut.vue_vue&type=style&index=0&lang.efe54a19.js";import{_ as f}from"./V-Avatar.vue_vue&type=script&setup=true&lang.119fc4d3.js";import{r as _,d as v,u as h,b as y,w as g,z as b,o as E,h as I,k as D,j as S,D as w,L as q,N as Y,B as j,K as k,J as x,G as L}from"./vendor.685e53b0.js";import{A as M,a as A}from"./index.e695d005.js";import{g as $,d as C}from"./Diciplines.c42ace9d.js";import{h as N,t as O}from"./Staffs.33d398a5.js";import{h as H}from"./moment.08a7f518.js";_([]);const J=_([]),T=_([]),G=async e=>{const a=await M.get(`schedule?locations_id=${e}`);return T.value=a.data,a},B=_(),K=_([{typeInput:"selectDataActionChange",name:"discipline_id",placeholder:"Discipline",values:[""],model:"",required:!0,class:"is-6"},{typeInput:"checkboxGroupSimpleEventInput",name:"location_id",text:"Locations",values:[""],model:[],required:!0,class:"is-12"}]),V=_([{typeInput:"switchEventChangeInput",name:"mismoshorariostrainers",values:["","Mismos horarios para todos los trainers seleccionados"],model:!1,required:!0,class:"is-6",click:function(){},change:function(){}}]);_([{typeInput:"switchEventChangeInput",name:"mismoshorariosdias",values:["","Mismos horarios para todos los dias"],model:!0,required:!0,class:"is-6",click:function(){},change:function(){}}]);const F=_([{typeInput:"switchEventChangeInput",name:"mismasfechas",values:["","Mismas fechas para todas las locaciones"],model:!0,required:!0,class:"is-12",click:function(){},change:function(){}}]),R=[{typeInput:"date",name:"start_date",placeholder:"Start Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"start_time",placeholder:"Start Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"date",name:"end_date",placeholder:"end Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"end_time",placeholder:"end Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"number",name:"capacity",placeholder:"Capacity people num",values:null,model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"type_of_member",placeholder:"Type of Member",values:["Adults Only","Kids Only","Adult & Kids"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"level",placeholder:"Level",values:["All Levels","Pro","Expert","Medium","Beginner"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"color",name:"color",placeholder:"Color",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"switchEventChangeInput",name:"is_recurrence",placeholder:"Recurrence",values:["","Recurrence"],model:!1,required:!0,class:"is-3",isLabel:!0,change:function(){}},{typeInput:"checkboxGroupSimpleEventInput",name:"recurrence",text:"Dias de la semana",default:[1,2,3,4,5,6,0],values:[{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"},{id:0,name:"Sunday"},{id:"All",name:"All"}],model:[],required:!0,disabled:!0,class:"is-12",click:function(){},change:function(){}}],W=_([{typeInput:"checkboxGroupSimpleEventInput",name:"trainers_id",text:"Trainers",values:[""],model:[],required:!0,class:"is-12"}]),z=_(null),P={class:"d-flex justify-content-between"},U=L(" DELETE"),Q=D("h3",{class:"title is-5 mb-2"},"Warning Edit",-1),X={class:"d-flex align-items-center"},Z={class:"ml-3 title is-6"};var ee=v({expose:[],props:{type:{type:String,default:"create"},buttons:{type:Array,default:["save"]},step:{type:Number,default:1},selectInfoData:{type:Object,default:null},idEvent:{type:Number,default:null}},emits:["addEvent","deleteEvent"],setup(v,{emit:L}){const T=v;j();const{cookies:G}=h(),ee=y((()=>"create"==T.type?{title:"Add a new schedule",subtitle:"Add information for a new schedule"}:{title:"Edit schedule",subtitle:"Edit information for a schedule"}));g((()=>T.idEvent),(()=>{"edit"==T.type&&(J.value=[],r(K.value),(async e=>{const a=await M.get(`schedule/${e}/edit`);return B.value=a.data,a})(T.idEvent).then((e=>{n(K.value,"location_id").model.push(B.value.locations_id),n(K.value,"discipline_id").model=B.value.class.dicipline_id,se(B.value.locations_id)})).catch((e=>{console.log(e.response.status),404==e.response.status&&console.log(T.idEvent)})))})),g((()=>u.value),(()=>{s(K,"location_id",u.value)})),g((()=>T.selectInfoData),(()=>{J.value=[],r(K.value),null!=G.get("locations_id")&&(n(K.value,"location_id").model.push(parseFloat(G.get("locations_id"))),se(G.get("locations_id")))}));const ae=function(e){"object"==typeof e&&(e=this.model),se(e)};g((()=>n(l.value,"locations_id").model),(e=>{se(e)})),b((()=>{t().then((e=>{s(l,"locations_id",i.value.locations),n(l.value,"locations_id").change=ae,null!=G.get("locations_id")&&(n(l.value,"locations_id").model=G.get("locations_id"),ae(G.get("locations_id")))})),$().then((e=>{s(K,"discipline_id",C.value)})),n(K.value,"location_id").change=se,n(K.value,"location_id").click=function(){},n(F.value,"mismasfechas").change=function(){n(F.value,"mismasfechas").model||le()},N().then((e=>{s(W,"trainers_id",O.value)}))}));const te=function(e,a){o([this],"trainers_id").forEach((a=>{null==J.value.find((e=>e.locations_id==this.locations_id)).trainers.find((e=>e.staffs_id==a.id))?J.value.find((e=>e.locations_id==this.locations_id)).trainers.push({locations_id:this.locations_id,staffs_id:a.id,name:a.name}):a.id==e.target.value&&J.value.find((e=>e.locations_id==this.locations_id)).trainers.splice(J.value.find((e=>e.locations_id==this.locations_id)).trainers.findIndex((e=>e.staffs_id==a.id)),1)}))};g((()=>n(F.value,"mismasfechas").model),(()=>{n(F.value,"mismasfechas").model&&le()}));const se=function(e,a){let t=null;t="object"==typeof e?e.target.value:e,o(K.value,"location_id").forEach((e=>{if(null==J.value.find((a=>a.locations_id==e.id))){n(V.value,"mismoshorariostrainers").change=ne,n(V.value,"mismoshorariostrainers").locations_id=e.id;let a=_(JSON.parse(JSON.stringify(R))).value;if(T.selectInfoData&&(n(a,"start_date").model=H(T.selectInfoData.start).format("YYYY-MM-DD"),n(a,"start_time").model=H(T.selectInfoData.start).format("HH:mm:ss"),n(a,"end_date").model=H(T.selectInfoData.end).format("YYYY-MM-DD"),n(a,"end_time").model=H(T.selectInfoData.end).format("HH:mm:ss")),"edit"==T.type){if(null==B.value)return d.error("Error Desconocido"),void window.location.reload();n(a,"start_date").model=H(B.value.start_date).format("YYYY-MM-DD"),n(a,"start_time").model=H(B.value.start_date).format("HH:mm:ss"),n(a,"end_date").model=H(B.value.end_date).format("YYYY-MM-DD"),n(a,"end_time").model=H(B.value.end_date).format("HH:mm:ss"),n(a,"capacity").model=B.value.capacity,n(a,"color").model=B.value.color,B.value.recurrence.length>0&&(n(a,"is_recurrence").model=!0,n(a,"recurrence").model=B.value.recurrence,n(a,"recurrence").disabled=!1),n(a,"type_of_member").model=B.value.type_of_member,n(a,"level").model=B.value.level}n(a,"start_date").change=ie,n(a,"end_date").change=ie,n(a,"capacity").change=ie,n(a,"end_time").change=ie,n(a,"start_time").change=ie,n(a,"is_recurrence").change=function(){n(a,"recurrence").disabled=this.model},n(a,"recurrence").click=function(){},n(a,"recurrence").change=function(){this.model.includes("All")&&(this.model=this.default)};let t=_(JSON.parse(JSON.stringify(W.value[0]))).value;t.change=te,t.click=function(){},t.locations_id=e.id,"edit"==T.type&&B.value.trainers.forEach((e=>{t.model.push(e.staffs_id)})),a.push(t),J.value.push({locations_id:e.id,name:e.name,start_date:n(a,"start_date"),start_time:n(a,"start_time"),end_date:n(a,"end_date"),end_time:n(a,"end_time"),capacity:n(a,"capacity"),recurrence:n(a,"recurrence"),inputsfechas:a,type_of_member:n(a,"type_of_member"),level:n(a,"level"),color:n(a,"color"),trainers:[]})}else e.id==t&&J.value.splice(J.value.findIndex((a=>a.locations_id==e.id)),1)}))},ie=function(){n(F.value,"mismasfechas").model&&le()},le=function(){let e=J.value.find((e=>e.locations_id==o(K.value,"location_id")[0].id));J.value.filter((e=>e.locations_id!=o(K.value,"location_id")[0].id)).forEach((a=>{n(a.inputsfechas,"start_date").model=n(e.inputsfechas,"start_date").model,n(a.inputsfechas,"end_date").model=n(e.inputsfechas,"end_date").model,n(a.inputsfechas,"end_time").model=n(e.inputsfechas,"end_time").model,n(a.inputsfechas,"start_time").model=n(e.inputsfechas,"start_time").model,n(a.inputsfechas,"capacity").model=n(e.inputsfechas,"capacity").model,n(a.inputsfechas,"color").model=n(e.inputsfechas,"color").model,n(a.inputsfechas,"type_of_member").model=n(e.inputsfechas,"type_of_member").model,n(a.inputsfechas,"level").model=n(e.inputsfechas,"level").model,n(a.inputsfechas,"recurrence").model=n(e.inputsfechas,"recurrence").model}))},ne=function(e){let a=null,t=null;"number"==typeof e?(t=e,a=n(V.value,"mismoshorariostrainers").model):(t=this.locations_id,a=!n(V.value,"mismoshorariostrainers").model);let s=J.value.find((e=>e.locations_id==t)),i=s.trainers[0],l=n(i.inputsDias,"semana").model,o=s.trainers.filter((e=>e.staffs_id!=i.staffs_id)),d=null;o.forEach((e=>{d=_(JSON.parse(JSON.stringify(e.days))),a?(n(e.inputsDias,"semana").model=l,e.days=i.days):(n(e.inputsDias,"semana").model=n(e.inputsDias,"semana").default,e.days=d)}))},oe=()=>{const e=c(K.value).discipline_id,a=c(K.value).location_id;let t=[];a.forEach((e=>{let a=J.value.find((a=>a.locations_id==e)),s=[];a.trainers.forEach((e=>{s.push({staffs_id:e.staffs_id})})),t.push({locations_id:a.locations_id,start_date:a.start_date.model+" "+a.start_time.model,end_date:a.end_date.model+" "+a.end_time.model,capacity:a.capacity.model,recurrence:JSON.stringify(a.recurrence.model),type_of_member:a.type_of_member.model,level:a.level.model,color:a.color.model,trainers:s})})),z.value={dicipline_id:e,status:!0,locations:t},"create"==T.type?(async e=>await M.post("schedule",e))(z.value).then((e=>{d.success("Save Success"),e.data.forEach((e=>{L("addEvent",e),J.value=[],r(K.value)}))})).catch((e=>{for(var a in e.response.data.errores)e.response.data.errores[a].forEach((e=>{d.error(`${a} ${e}`)}))})):(async(e,a)=>{const t=await M.put(`schedule/${e}`,a);return B.value=t.data,t})(B.value.id,z.value).then((e=>{d.success("Success Update"),e.data.forEach((e=>{L("addEvent",e),J.value=[],r(K.value)}))})).catch((e=>{for(var a in e.response.data.errores)e.response.data.errores[a].forEach((e=>{d.error(`${a} ${e}`)}))}))},de=()=>{const e=B.value.id;(async e=>await M.delete(`schedule/${e}`))(e).then((e=>{L("deleteEvent",B.value.id),J.value=[],r(K.value)})).catch((a=>{404==a.response.status&&(console.log("props.idEvent",e),L("deleteEvent",e))}))};return(t,s)=>{const i=e,l=a,n=m,o=p,d=f;return E(),I(q,null,[D(o,{buttons:T.buttons,step:T.step,titles:w(ee),class:"mb-2",onSaveData:oe,color:"warning"},{default:S((()=>["create"!=T.type?(E(),I(l,{key:0,color:"warning"},{default:S((()=>[D("div",P,[D(i,{onClick:de,icon:"fa fa-times",color:"danger",elevated:""},{default:S((()=>[U])),_:1}),Q])])),_:1})):k("",!0),D(n,{"inputs-step":w(K)},null,8,["inputs-step"])])),_:1},8,["buttons","step","titles"]),(E(!0),I(q,null,Y(w(J),((e,a)=>(E(),I(l,{key:`location-${a}`,class:"mb-4"},{default:S((()=>[D("div",X,[D(d,{picture:`${w(A)}storage/${e.image}`},null,8,["picture"]),D("h1",Z,x(e.name),1)]),D(n,{"inputs-step":w(F)},null,8,["inputs-step"]),D(n,{"inputs-step":e.inputsfechas},null,8,["inputs-step"])])),_:2},1024)))),128))],64)}}});export{ee as _,G as g};
