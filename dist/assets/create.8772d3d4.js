import{_ as e}from"./V-Placeload.9f0459f0.js";import{_ as t}from"./V-Button.vue_vue&type=script&setup=true&lang.f850d095.js";import{_ as a}from"./V-Avatar.vue_vue&type=script&setup=true&lang.ace90716.js";import{_ as s}from"./V-Control.41ba379d.js";import{_ as l}from"./V-Field.vue_vue&type=script&setup=true&lang.c73a2a5f.js";import{_ as o}from"./V-Tag.vue_vue&type=script&setup=true&lang.1a6ab0fe.js";import{_ as u}from"./V-FlexTable.vue_vue&type=script&setup=true&lang.d14d3c08.js";import{_ as r}from"./V-PlaceholderSection.vue_vue&type=script&setup=true&lang.58484945.js";import{_ as n}from"./V-Modal.vue_vue&type=script&setup=true&lang.50c44f0e.js";import{_ as i}from"./SidebarLayout.vue_vue&type=script&setup=true&lang.49f33864.js";import{d as p,P as c,O as d,a7 as v,r as f,I as m,b as y,o as _,i as b,j as k,H as g,E as h,k as j,G as x,S as V,U as C,W as P,_ as S,F as w}from"./vendor.d343baf9.js";import{p as U}from"./sidebarLayoutState.5641ebe1.js";import{l as I,a as D,b as K,d as q}from"./Inventory.e8500a08.js";import{g as A,p as F}from"./Products.3214bf9c.js";import{n as T,b as B}from"./index.c9faec89.js";import"./ActivityPanel.vue_vue&type=style&index=0&lang.aef3e716.js";import"./useDropdown.058e23b5.js";import"./inputsLayaut.vue_vue&type=style&index=0&lang.ec9ca61e.js";import"./V-SwitchSegment.vue_vue&type=script&setup=true&lang.66ed88a9.js";import"./V-Checkbox.vue_vue&type=script&setup=true&lang.90661a21.js";import"./V-Card.vue_vue&type=script&setup=true&lang.a76a96a0.js";import"./V-Dropdown.7efd21c7.js";import"./V-Icon.vue_vue&type=script&setup=true&lang.28f32a22.js";import"./Companies.984ea600.js";import"./activePanelState.5861ca88.js";import"./fastpizza.1e58d0ec.js";import"./TaskPanel.vue_vue&type=style&index=0&lang.63db2abf.js";import"./video.f7ef545f.js";import"./SearchPanel.vue_vue&type=style&index=0&lang.f3fcc4ea.js";import"./darkModeState.423a928c.js";import"./AnimatedLogo.3101fbee.js";import"./V-IconBox.vue_vue&type=script&setup=true&lang.8b6033b6.js";import"./V-Block.vue_vue&type=script&setup=true&lang.606db9d9.js";import"./UserPopoverContent.vue_vue&type=script&setup=true&lang.6c35a108.js";import"./userPopovers.f4b9fc60.js";const L={key:0,class:"page-content-inner"},$={class:"title is-4 mb-0"},z={class:"title is-6 mb-0"},E={key:0,class:"title is-6"},M={key:1},N={class:"title is-5"},W={key:2},G={class:"d-flex justify-content-end mb-4 w-100"},H=w("Back"),O=w("Save"),J=j("div",{class:"flex-table-header"},[g(" <span>ID</span> "),j("span",null,"Product"),j("span",null,"SKU"),j("span",null,"Previous stock"),j("span",null,"Current stock"),j("span",null,"Total"),j("span",null,"Providers"),j("span",null,"Date of admission"),j("span",null,"Status")],-1),Q={class:"flex-table-cell","data-th":"product"},R={class:"light-text d-flex align-items-center"},X={class:"flex-table-cell","data-th":"SKU"},Y={class:"flex-table-cell","data-th":"current_stock"},Z={class:"flex-table-cell","data-th":"previous_stock"},ee={class:"flex-table-cell","data-th":"previous_stock"},te={class:"flex-table-cell","data-th":"previous_stock"},ae={class:"flex-table-cell","data-th":"previous_stock"},se={class:"flex-table-cell","data-th":"-"},le={class:"d-flex justify-content-end mt-4 w-100"},oe=w("Save"),ue=w("Confirm");var re=p({expose:[],setup(p){U.value="Inventory Create",c({title:"Inventory"});const w=d(),re=v();f([]),m((()=>{if(de.value=!0,!w.query.locations_id)return T.error("la location es requerida"),void console.error("la locacion es requerida");I.value=w.query.locations_id,A(I.value,"active").then((e=>{D(w.query.id).then((e=>{pe(),de.value=!1}))}))}));const ne=f([]),ie=y((()=>ne.value)),pe=()=>{F.value.forEach((e=>{let t=null,a=null,s=null,l=!1,o=null,u=null;if(null!=K.value.products){const r=K.value.products.find((t=>t.product_id==e.id));console.log("element",e),console.log("product",r),null!=r?(a=r.previous_stock,t=r.current_stock,s=t+a,l=!0,o=r.proveedor,u=r.ingreso):(a=e.stock?e.stock.current_stock:0,s=a)}let r={id:e.id,name:e.name,photo:e.photo,current_stock:t,previous_stock:a,subtotal:s,status:l,sku:e.sku,proveedor:o,ingreso:u};0==K.value.status&&0==r.status||ne.value.push(r)}))},ce=e=>{e.subtotal=parseFloat(e.previous_stock)+parseFloat(e.current_stock)},de=f(!1),ve=f(!1),fe=f("Processing Inventory... Please do not close the browser window until the process is complete"),me=()=>{ve.value=!1,de.value=!0;let e={products:_e.value};q(e).then((e=>{console.log("response.data",e.data),T.success("Data Save"),de.value=!1}))},ye=f({}),_e=f([]),be=()=>{ve.value=!0,ie.value.forEach((e=>{_e.value.push({product_id:e.id,previous_stock:e.previous_stock,current_stock:e.subtotal,proveedor:e.proveedor,ingreso:e.ingreso})})),console.log(_e.value),ye.value=`Do you want to save ${_e.value.length} products out of ${F.value.length}? Products not added in inventory will have stock = 0`},ke=y((()=>null!=K.value.products?K.value.products.length:""));return(p,c)=>{const d=e,v=t,f=a,m=s,y=l,w=o,U=u,I=r,D=n,q=i;return _(),b(q,null,{default:k((()=>[g(" Content Wrapper "),h(K)?(_(),b("div",L,[j("h1",$,"Inventory #"+x(h(K).id),1),j("h1",z," Status: "+x(1==h(K).status?"Active":"Close"),1),h(K)?(_(),b("h1",E," Products: "+x(h(ke)),1)):g("v-if",!0),de.value?(_(),b("div",M,[j("p",N,x(fe.value),1),j(d,{height:"200px"})])):(_(),b("div",W,[j("div",G,[j(v,{raised:"",onClick:c[1]||(c[1]=e=>h(re).back()),class:"mr-3"},{default:k((()=>[H])),_:1}),h(K).status?(_(),b(v,{key:0,color:"success",onClick:be,raised:""},{default:k((()=>[O])),_:1})):g("v-if",!0)]),j(U,null,{header:k((()=>[J])),body:k((()=>[(_(!0),b(V,null,C(ne.value,(e=>(_(),b("div",{key:e.id,class:"flex-table-item"},[g(' <div class="flex-table-cell is-bold" data-th="ID">\r\n                <span class="dark-text">{{ row.id }}</span>\r\n              </div> '),j("div",Q,[j("span",R,[j(f,{picture:`${h(B)}storage/${e.photo}`,color:"primary",size:"medium",class:"mr-3"},null,8,["picture"]),j("div",null,[j("p",null,x(e.name),1)])])]),j("div",X,[j("p",null,[j("small",null,x(e.sku),1)])]),j("div",Y,[j(y,null,{default:k((()=>[j(m,null,{default:k((()=>[P(j("input",{"onUpdate:modelValue":t=>e.previous_stock=t,type:"number",class:"input",readonly:0==h(K).status,onKeyup:t=>ce(e),onChange:t=>ce(e)},null,40,["onUpdate:modelValue","readonly","onKeyup","onChange"]),[[S,e.previous_stock]])])),_:2},1024)])),_:2},1024)]),j("div",Z,[j(y,null,{default:k((()=>[j(m,null,{default:k((()=>[P(j("input",{"onUpdate:modelValue":t=>e.current_stock=t,type:"number",class:"input",readonly:0==h(K).status,onKeyup:t=>ce(e),onChange:t=>ce(e)},null,40,["onUpdate:modelValue","readonly","onKeyup","onChange"]),[[S,e.current_stock]])])),_:2},1024)])),_:2},1024)]),j("div",ee,[j("p",null,x(isNaN(e.subtotal)?0:e.subtotal),1)]),j("div",te,[j(y,null,{default:k((()=>[j(m,null,{default:k((()=>[P(j("input",{"onUpdate:modelValue":t=>e.proveedor=t,type:"text",class:"input",readonly:0==h(K).status},null,8,["onUpdate:modelValue","readonly"]),[[S,e.proveedor]])])),_:2},1024)])),_:2},1024)]),j("div",ae,[j(y,null,{default:k((()=>[j(m,null,{default:k((()=>[P(j("input",{"onUpdate:modelValue":t=>e.ingreso=t,type:"date",class:"input",readonly:0==h(K).status},null,8,["onUpdate:modelValue","readonly"]),[[S,e.ingreso]])])),_:2},1024)])),_:2},1024)]),j("div",se,[e.status?(_(),b(w,{key:0,color:"success",label:"Save",rounded:"",elevated:""})):(_(),b(w,{key:1,color:void 0,label:"Pending",rounded:"",elevated:""}))])])))),128))])),_:1}),j("div",le,[h(K).status?(_(),b(v,{key:0,color:"success",onClick:be,raised:""},{default:k((()=>[oe])),_:1})):g("v-if",!0)])])),j(D,{open:ve.value,actions:"center",onClose:c[2]||(c[2]=e=>ve.value=!1)},{content:k((()=>[j(I,{title:"Are you sure you want to save the changes?",subtitle:"This action will affect the stock of all products and cannot be undone."}),j("p",null,x(ye.value),1)])),action:k((()=>[j(v,{color:"primary",onClick:me,raised:""},{default:k((()=>[ue])),_:1})])),_:1},8,["open"])])):g("v-if",!0)])),_:1})}}});export default re;
