import{_ as W}from"./V-Button.vue_vue_type_script_setup_true_lang.72d178c7.js";import{_ as K}from"./V-Card.vue_vue_type_script_setup_true_lang.f80f1beb.js";import{_ as P}from"./inputsLayaut.vue_vue_type_style_index_0_lang.bc2ca8d6.js";import{_ as z}from"./formLayaut.vue_vue_type_style_index_0_lang.2638a67d.js";import{_ as Q}from"./V-Avatar.vue_vue_type_script_setup_true_lang.b4183814.js";import{r as u,A as k,d as X,a2 as Z,c as ee,m as D,j as te,q as M,g as e,ac as q,h as v,n as S,o as x,e as Y,f as h,w as $,u as w,F,G as ae,k as H,a8 as L,y as se,C as ie,t as ne,i as oe,a7 as le}from"./index.4457215e.js";import{a as ce,d as re}from"./Diciplines.164662a5.js";import{a as de,d as ue,l as A,e as V}from"./Companies.4f645ec0.js";import{g as me,t as pe}from"./Staffs.ad83113a.js";u([]);const c=u([]),fe=async _=>await k.post("schedule",_),_e=u([]),Ce=async _=>{const d=await k.get(`schedule?locations_id=${_}`);return _e.value=d.data,d},o=u(),he=async _=>{const d=await k.get(`schedule/${_}/edit`);return o.value=d.data,d},ve=async(_,d)=>{const n=await k.put(`schedule/${_}`,d);return o.value=n.data,n},ye=async _=>await k.delete(`schedule/${_}`),r=u([{typeInput:"selectDataActionChange",name:"discipline_id",placeholder:"Discipline",values:[""],model:"",required:!0,class:"is-6"},{typeInput:"checkboxGroupSimpleEventInput",name:"location_id",text:"Locations",values:[""],model:[],required:!0,class:"is-12"}]),C=u([{typeInput:"switchEventChangeInput",name:"mismoshorariostrainers",values:["","Mismos horarios para todos los trainers seleccionados"],model:!1,required:!0,class:"is-6",click:function(){},change:function(){}}]);u([{typeInput:"switchEventChangeInput",name:"mismoshorariosdias",values:["","Mismos horarios para todos los dias"],model:!0,required:!0,class:"is-6",click:function(){},change:function(){}}]);const b=u([{typeInput:"switchEventChangeInput",name:"mismasfechas",values:["","Mismas fechas para todas las locaciones"],model:!0,required:!0,class:"is-12",click:function(){},change:function(){}}]),ge=[{typeInput:"date",name:"start_date",placeholder:"Start Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"start_time",placeholder:"Start Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"date",name:"end_date",placeholder:"end Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"end_time",placeholder:"end Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"number",name:"capacity",placeholder:"Capacity people num",values:null,model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"type_of_member",placeholder:"Type of Member",values:["Adults Only","Kids Only","Adult & Kids"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"level",placeholder:"Level",values:["All Levels","Pro","Expert","Medium","Beginner"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"color",name:"color",placeholder:"Color",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"switchEventChangeInput",name:"is_recurrence",placeholder:"Recurrence",values:["","Recurrence"],model:!1,required:!0,class:"is-3",isLabel:!0,change:function(){}},{typeInput:"checkboxGroupSimpleEventInput",name:"recurrence",text:"Dias de la semana",default:[1,2,3,4,5,6,0],values:[{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"},{id:0,name:"Sunday"},{id:"All",name:"All"}],model:[],required:!0,disabled:!0,class:"is-12",click:function(){},change:function(){}}],J=u([{typeInput:"checkboxGroupSimpleEventInput",name:"trainers_id",text:"Trainers",values:[""],model:[],required:!0,class:"is-12"}]),N=u(null),be={class:"d-flex justify-content-between"},Ee=oe(" DELETE"),Ie=h("h3",{class:"title is-5 mb-2"},"Warning Edit",-1),De={class:"d-flex align-items-center"},Se={class:"ml-3 title is-6"};var Te=X({expose:[],props:{type:{type:String,default:"create"},buttons:{type:Array,default:["save"]},step:{type:Number,default:1},selectInfoData:{type:Object,default:null},idEvent:{type:Number,default:null}},emits:["addEvent","deleteEvent"],setup(_,{emit:d}){const n=_;le();const{cookies:y}=Z(),j=ee(()=>n.type=="create"?{title:"Add a new schedule",subtitle:"Add information for a new schedule"}:{title:"Edit schedule",subtitle:"Edit information for a schedule"});D(()=>n.idEvent,()=>{n.type=="edit"&&(c.value=[],L(r.value),he(n.idEvent).then(a=>{e(r.value,"location_id").model.push(o.value.locations_id),e(r.value,"discipline_id").model=o.value.class.dicipline_id,E(o.value.locations_id)}).catch(a=>{console.log(a.response.status),a.response.status==404&&console.log(n.idEvent)}))}),D(()=>V.value,()=>{M(r,"location_id",V.value)}),D(()=>n.selectInfoData,()=>{c.value=[],L(r.value),y.get("locations_id")!=null&&(e(r.value,"location_id").model.push(parseFloat(y.get("locations_id"))),E(y.get("locations_id")))});const O=function(a){typeof a=="object"&&(a=this.model),E(a)};D(()=>e(A.value,"locations_id").model,a=>{E(a)}),te(()=>{de().then(a=>{M(A,"locations_id",ue.value),e(A.value,"locations_id").change=O,y.get("locations_id")!=null&&(e(A.value,"locations_id").model=y.get("locations_id"),O(y.get("locations_id")))}),ce().then(a=>{M(r,"discipline_id",re.value)}),e(r.value,"location_id").change=E,e(r.value,"location_id").click=function(){},e(b.value,"mismasfechas").change=function(){e(b.value,"mismasfechas").model||T()},me().then(a=>{M(J,"trainers_id",pe.value)})});const B=function(a,m){q([this],"trainers_id").forEach(i=>{c.value.find(s=>s.locations_id==this.locations_id).trainers.find(s=>s.staffs_id==i.id)==null?c.value.find(s=>s.locations_id==this.locations_id).trainers.push({locations_id:this.locations_id,staffs_id:i.id,name:i.name}):i.id==a.target.value&&c.value.find(s=>s.locations_id==this.locations_id).trainers.splice(c.value.find(s=>s.locations_id==this.locations_id).trainers.findIndex(s=>s.staffs_id==i.id),1)})};D(()=>e(b.value,"mismasfechas").model,()=>{e(b.value,"mismasfechas").model&&T()});const E=function(a,m){let i=null;typeof a=="object"?i=a.target.value:i=a,q(r.value,"location_id").forEach(s=>{if(c.value.find(t=>t.locations_id==s.id)==null){e(C.value,"mismoshorariostrainers").change=G,e(C.value,"mismoshorariostrainers").locations_id=s.id;let t=u(JSON.parse(JSON.stringify(ge))).value;if(n.selectInfoData&&(e(t,"start_date").model=v(n.selectInfoData.start).format("YYYY-MM-DD"),e(t,"start_time").model=v(n.selectInfoData.start).format("HH:mm:ss"),e(t,"end_date").model=v(n.selectInfoData.end).format("YYYY-MM-DD"),e(t,"end_time").model=v(n.selectInfoData.end).format("HH:mm:ss")),n.type=="edit")if(o.value!=null)e(t,"start_date").model=v(o.value.start_date).format("YYYY-MM-DD"),e(t,"start_time").model=v(o.value.start_date).format("HH:mm:ss"),e(t,"end_date").model=v(o.value.end_date).format("YYYY-MM-DD"),e(t,"end_time").model=v(o.value.end_date).format("HH:mm:ss"),e(t,"capacity").model=o.value.capacity,e(t,"color").model=o.value.color,o.value.recurrence.length>0&&(e(t,"is_recurrence").model=!0,e(t,"recurrence").model=o.value.recurrence,e(t,"recurrence").disabled=!1),e(t,"type_of_member").model=o.value.type_of_member,e(t,"level").model=o.value.level;else{S.error("Error Desconocido"),window.location.reload();return}e(t,"start_date").change=I,e(t,"end_date").change=I,e(t,"capacity").change=I,e(t,"end_time").change=I,e(t,"start_time").change=I,e(t,"is_recurrence").change=function(){e(t,"recurrence").disabled=this.model},e(t,"recurrence").click=function(){},e(t,"recurrence").change=function(){this.model.includes("All")&&(this.model=this.default)};let l=u(JSON.parse(JSON.stringify(J.value[0]))).value;l.change=B,l.click=function(){},l.locations_id=s.id,n.type=="edit"&&o.value.trainers.forEach(p=>{l.model.push(p.staffs_id)}),l.filter=function(p){return p.name+" "+p.last_name},console.log("inputsTrainersw",l),t.push(l),c.value.push({locations_id:s.id,name:s.name,start_date:e(t,"start_date"),start_time:e(t,"start_time"),end_date:e(t,"end_date"),end_time:e(t,"end_time"),capacity:e(t,"capacity"),recurrence:e(t,"recurrence"),inputsfechas:t,type_of_member:e(t,"type_of_member"),level:e(t,"level"),color:e(t,"color"),trainers:[]})}else s.id==i&&c.value.splice(c.value.findIndex(t=>t.locations_id==s.id),1)})},I=function(){e(b.value,"mismasfechas").model&&T()},T=function(){let a=c.value.find(i=>i.locations_id==q(r.value,"location_id")[0].id);c.value.filter(i=>i.locations_id!=q(r.value,"location_id")[0].id).forEach(i=>{e(i.inputsfechas,"start_date").model=e(a.inputsfechas,"start_date").model,e(i.inputsfechas,"end_date").model=e(a.inputsfechas,"end_date").model,e(i.inputsfechas,"end_time").model=e(a.inputsfechas,"end_time").model,e(i.inputsfechas,"start_time").model=e(a.inputsfechas,"start_time").model,e(i.inputsfechas,"capacity").model=e(a.inputsfechas,"capacity").model,e(i.inputsfechas,"color").model=e(a.inputsfechas,"color").model,e(i.inputsfechas,"type_of_member").model=e(a.inputsfechas,"type_of_member").model,e(i.inputsfechas,"level").model=e(a.inputsfechas,"level").model,e(i.inputsfechas,"recurrence").model=e(a.inputsfechas,"recurrence").model})},G=function(a){let m=null,i=null;typeof a=="number"?(i=a,m=e(C.value,"mismoshorariostrainers").model):(i=this.locations_id,m=!e(C.value,"mismoshorariostrainers").model);let s=c.value.find(f=>f.locations_id==i),t=s.trainers[0],l=e(t.inputsDias,"semana").model,p=s.trainers.filter(f=>f.staffs_id!=t.staffs_id),g=null;p.forEach(f=>{g=u(JSON.parse(JSON.stringify(f.days))),m?(e(f.inputsDias,"semana").model=l,f.days=t.days):(e(f.inputsDias,"semana").model=e(f.inputsDias,"semana").default,f.days=g)})},R=()=>{const a=H(r.value).discipline_id,m=H(r.value).location_id;let i=[];m.forEach(s=>{let t=c.value.find(p=>p.locations_id==s),l=[];t.trainers.forEach(p=>{l.push({staffs_id:p.staffs_id})}),i.push({locations_id:t.locations_id,start_date:t.start_date.model+" "+t.start_time.model,end_date:t.end_date.model+" "+t.end_time.model,capacity:t.capacity.model,recurrence:JSON.stringify(t.recurrence.model),type_of_member:t.type_of_member.model,level:t.level.model,color:t.color.model,trainers:l})}),N.value={dicipline_id:a,status:!0,locations:i},n.type=="create"?fe(N.value).then(s=>{S.success("Save Success"),s.data.forEach(t=>{d("addEvent",t),c.value=[],L(r.value)})}).catch(s=>{for(var t in s.response.data.errores)s.response.data.errores[t].forEach(l=>{S.error(`${t} ${l}`)})}):ve(o.value.id,N.value).then(s=>{S.success("Success Update"),s.data.forEach(t=>{d("addEvent",t),c.value=[],L(r.value)})}).catch(s=>{for(var t in s.response.data.errores)s.response.data.errores[t].forEach(l=>{S.error(`${t} ${l}`)})})},U=()=>{const a=o.value.id;ye(a).then(m=>{d("deleteEvent",o.value.id),c.value=[],L(r.value)}).catch(m=>{m.response.status==404&&d("deleteEvent",a)})};return(a,m)=>{const i=W,s=K,t=P,l=z,p=Q;return x(),Y(F,null,[h(l,{buttons:n.buttons,step:n.step,titles:w(j),class:"mb-2",onSaveData:R,color:"warning"},{default:$(()=>[n.type!="create"?(x(),Y(s,{key:0,color:"warning"},{default:$(()=>[h("div",be,[h(i,{onClick:U,icon:"fa fa-times",color:"danger",elevated:""},{default:$(()=>[Ee]),_:1}),Ie])]),_:1})):se("",!0),h(t,{"inputs-step":w(r)},null,8,["inputs-step"])]),_:1},8,["buttons","step","titles"]),(x(!0),Y(F,null,ae(w(c),(g,f)=>(x(),Y(s,{key:`location-${f}`,class:"mb-4"},{default:$(()=>[h("div",De,[h(p,{picture:`${w(ie)}storage/${g.image}`},null,8,["picture"]),h("h1",Se,ne(g.name),1)]),h(t,{"inputs-step":w(b)},null,8,["inputs-step"]),h(t,{"inputs-step":g.inputsfechas},null,8,["inputs-step"])]),_:2},1024))),128))],64)}}});export{Te as _,Ce as g};
