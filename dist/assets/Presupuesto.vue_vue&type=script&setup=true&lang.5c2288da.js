import{_ as e}from"./V-Button.vue_vue&type=script&setup=true&lang.94a80eab.js";import{_ as t}from"./V-Loader.vue_vue&type=script&setup=true&lang.cf9645bd.js";import{_ as a}from"./V-Card.vue_vue&type=script&setup=true&lang.bff7be9b.js";import{_ as s}from"./V-Control.4a6c84b4.js";import{_ as l}from"./V-Field.vue_vue&type=script&setup=true&lang.e3fe440b.js";import{_ as r}from"./V-Modal.vue_vue&type=script&setup=true&lang.ac2f5202.js";import{d as n,r as i,b as u,o,i as m,k as c,j as p,Q as d,F as v,D as b,E as y,R as f,G as h,S as _,Y as g,H as x,w as k,U as j,a8 as C,K as S}from"./vendor.1faf4f77.js";import{m as w,b as $,P,A as M,n as F,g as N,p as q}from"./index.6fffb7e6.js";import{c as A}from"./Companies.6685ae15.js";import{_ as I}from"./MemberCards.vue_vue&type=script&setup=true&lang.00c091fe.js";import{_ as V}from"./V-Placeload.410731c2.js";import{_ as O}from"./signComponent.vue_vue&type=script&setup=true&lang.6b1de5b3.js";import{G as R,q as E,d as T,H as z,I as B,J as D}from"./Members.fd22ffdb.js";const U=c("p",{class:"title is-3"},[c("i",{class:"fas fa-money-bill","aria-hidden":"true"})],-1),G={class:"title is-5"},H=y(" Cash "),L={class:"d-flex mb-4 justify-content-between"},Q={class:"title is-5"},J=y(" Total: "),K={class:"title is-5"},Y=y(" Cash Total: "),W={class:"\n          d-flex\n          justify-content-center\n          align-items-center\n          flex-column\n          mb-4\n        "},X=c("p",{class:"title is-5 mb-4"},"Change Back:",-1),Z={class:"title is-3 mb-0"},ee={class:"d-flex justify-content-center flex-wrap mb-4"},te=c("div",{class:"w-100"},null,-1),ae={class:"d-flex justify-content-center"},se=y("Reset"),le=y("Confirm");var re=n({expose:[],props:{total:{type:[Number,String],default:0},margin:{type:String,default:"mx-2"}},emits:["onPaymentCash"],setup(t,{emit:n}){const x=t,k=i(!1),j=i(0),C=u((()=>{const e=parseFloat(j.value)-parseFloat(x.total/100);return e>0?e:0})),S=()=>{k.value=!1,n("onPaymentCash",{changeBack:C.value,cash:j.value})};return(n,i)=>{const u=a,x=e,$=s,P=l,M=r;return o(),m(d,null,[c(u,{color:"warning",class:["btn-card w-100 justify-content-center column is-4",t.margin],onClick:i[1]||(i[1]=e=>k.value=!0)},{default:p((()=>[U,c("p",G,[H,c("b",null,v(b(w)(t.total/100)),1)])])),_:1},8,["class"]),c(M,{title:"",open:k.value,actions:"center",onClose:i[5]||(i[5]=e=>k.value=!1)},{content:p((()=>[c("div",L,[c("p",Q,[J,c("b",null,v(b(w)(t.total/100)),1)]),c("p",K,[Y,c("b",null,v(b(w)(j.value)),1)])]),c("div",W,[X,c("p",Z,[c("b",null,v(b(w)(b(C))),1)])]),c("div",ee,[c(x,{bold:"",class:"m-3",style:{"font-size":"14px"},onClick:i[2]||(i[2]=e=>j.value=Number.parseFloat(t.total/100).toFixed(2))},{default:p((()=>[y(" Full Payment "+v(b(w)(t.total/100)),1)])),_:1}),te,(o(),m(d,null,f([5,10,20,50,100],((e,t)=>c(x,{key:`calculato-${t}`,bold:"",class:"m-3",style:{"font-size":"14px"},onClick:t=>(e=>{j.value=parseFloat(j.value)+parseFloat(e)})(e)},{default:p((()=>[y(" $"+v(e),1)])),_:2},1032,["onClick"]))),64))]),c("div",ae,[c(P,null,{default:p((()=>[c($,null,{default:p((()=>[h(" <p>{{ Number.parseFloat(cash).toFixed(2)  }}</p> "),_(c("input",{"onUpdate:modelValue":i[3]||(i[3]=e=>j.value=e),type:"text",class:"input text-center",placeholder:"Cash"},null,512),[[g,j.value]])])),_:1})])),_:1})])])),action:p((()=>[c(x,{onClick:i[4]||(i[4]=e=>j.value=0),class:"d-flex justify-content-center",raised:""},{default:p((()=>[se])),_:1}),c(x,{color:"success",onClick:S,disabled:parseFloat(j.value)<parseFloat(parseFloat(t.total/100).toFixed(2)),class:"d-flex justify-content-center",raised:""},{default:p((()=>[le])),_:1},8,["disabled"])])),_:1},8,["open"])],64)}}});const ne={class:"d-flex justify-content-between align-items-start"},ie=c("div",null,[c("p",{class:"title is-3"},[c("i",{class:"fas fa-receipt",style:{color:"white !important"},"aria-hidden":"true"})]),c("p",{class:"title is-5",style:{color:"white !important"}},"View Order")],-1),ue={key:0,class:"title is-6"},oe=c("i",{class:"fas fa-check","aria-hidden":"true"},null,-1);var me=n({expose:[],props:{membership_member:{type:[Number,String],default:0}},setup(e){const t=e,s=i(!1);return x((()=>{})),(e,l)=>{const n=a,i=r;return o(),m(d,null,[c(n,{style:{background:"#388e3c"},class:"mx-2 mx-auto mt-4 is-4 column btn-card justify-content-center",onClick:l[1]||(l[1]=e=>s.value=!0)},{default:p((()=>[c("div",ne,[ie,e.openModalRecibo?(o(),m("p",ue,[oe])):h("v-if",!0)])])),_:1}),c(i,{title:"",open:s.value,actions:"center",onClose:l[2]||(l[2]=e=>s.value=!1)},{content:p((()=>[h(' <iframe id="printf" :src="`${FRONTEND_URL}members/recibo?id=${props.membership_member}`"></iframe> '),c("iframe",{src:`${b($)}ticket_membership/${t.membership_member}?companie_id=${b(A).id}`,width:"100%",height:"500px",frameborder:"0"},null,8,["src"]),c("a",{href:`${b($)}/ticket_membership/${t.membership_member}?companie_id=${b(A).id}`},"Open",8,["href"])])),action:p((()=>[])),_:1},8,["open"])],64)}}});const ce=c("div",{id:"payment-element"},[h("Stripe.js injects the Payment Element")],-1),pe=y("Pay now "),de=c("div",{id:"payment-message",class:"hidden"},null,-1);var ve=n({expose:[],props:{amount:{type:[Number,String],required:!0},id:{type:Number,required:!0},url:{type:String,default:"stripe"},member_membership:{type:Number,default:0},variosMiembros:{type:Boolean,default:!1},miembros:{type:Array,default:[]}},emits:["PaymentAction"],setup(s,{emit:l}){const r=s,n=Stripe(P.value);k((()=>r.id),(e=>{v.value=!0,N()}));const v=i(!0);i({id:r.id,amount:r.amount});const b=i(),y=u((()=>"stripe"!=r.url?{payment_type_id:3,amount:r.amount}:{id:r.id,member_mermship_id:r.member_membership,amount:r.amount,payment_type_id:1}));i(null);const f=i(null),S=i(null),w=i(!1),$=i(null),N=async()=>{let e=await M.post(r.url,y.value).then((e=>{f.value=e.data.clientSecret,$.value=e.data.user_id,b.value=n.elements({clientSecret:f.value,appearance:{theme:"night",rules:{".Input":{boxShadow:"none"}}}}),S.value=b.value.create("card",{classes:{base:"base_card"}}),S.value.mount("#payment-element")})).catch((e=>{v.value=!1}));return v.value=!1,e},q=i(null),A=async e=>{e.preventDefault(),w.value=!0;const{setupIntent:t,error:a}=await n.confirmCardSetup(f.value,{payment_method:{card:S.value,billing_details:{name:q.value}}});if(a)w.value=!1,F.error(a.message);else{const{payment_method:e}=t;r.variosMiembros?r.miembros.forEach((t=>{M.post("paymentStripe",{payment_method:e,user_id:t.idMember,membership_member_id:t.idMemberMembership,payment_type_id:3}).catch((e=>{w.value=!1}))})):await M.post("paymentStripe",{payment_method:e,amount:r.amount,user_id:$.value,membership_member_id:r.member_membership,payment_type_id:3}).catch((e=>{w.value=!1})),y.value&&(l("PaymentAction",y),F.success("Success Payment"))}w.value=!1};return x((()=>{w.value=!1,N()})),(s,l)=>{const r=V,n=e,i=t,u=a;return o(),m(d,null,[v.value?(o(),m(r,{key:0,height:"200px",class:"mt-6"})):h("v-if",!0),_(c(u,{class:"mt-6"},{default:p((()=>[c("form",{onSubmit:C(A,["prevent"]),id:"payment-form"},[_(c("input",{id:"card-holder-name",class:"input mb-3","onUpdate:modelValue":l[1]||(l[1]=e=>q.value=e),placeholder:"Name",type:"text"},null,512),[[g,q.value]]),ce,c(i,{size:"small",active:w.value},{default:p((()=>[c(n,{id:"submit",class:"mt-4",color:"info"},{default:p((()=>[pe])),_:1})])),_:1},8,["active"]),de],40,["onSubmit"])])),_:1},512),[[j,!v.value]])],64)}}});const be={class:"w-100"},ye={class:"my-4"},fe={key:0},he=c("small",null,"Register the principal first",-1),_e=y(" Process Membership "),ge=y(" Process Membership "),xe={key:0,class:"columns is-multiline justify-content-center mt-6"},ke={class:"d-flex justify-content-between align-items-start"},je=c("div",null,[c("p",{class:"title is-3"},[c("i",{class:"fas fa-credit-card","aria-hidden":"true"})]),c("p",{class:"title is-5"},"Debit Automatic")],-1),Ce={key:0,class:"title is-6"},Se=c("i",{class:"fas fa-check","aria-hidden":"true"},null,-1),we={class:"columns is-multiline justify-content-center mt-6"},$e=c("p",{class:"title is-4"},"Payment Success",-1);var Pe=n({expose:[],props:{member:{type:Array,required:!0},member_id:{type:Number,default:0},membresia:{type:Array,required:!0},contact:{type:Array,required:!0},presupuesto_id:{type:String},total:{type:[String,Number],required:!0},categoriesMembers:{type:Object,required:!0},notasInput:{type:Object,required:!0},type:{type:String,default:"create"}},emits:["PaymentAction"],setup(s,{emit:l}){const r=s,n=i(null),d=i(!1),y=i(null),f=i(null);x((()=>{d.value=!1,g.value=!1}));const _=()=>{n.value=null,d.value=!0,y.value=r.member.id,f.value=null;const e=q(r.membresia);e.members_id=r.member_id,e.total=r.total,e.payment_type_id=3,D(e).then((e=>{y.value=e.data.id,f.value=e.data.membership_members_id,F.success("Success"),d.value=!1})).catch((e=>{for(var t in e.response.data.errores)e.response.data.errores[t].forEach((e=>{F.error(`${t}: ${e}`)}))}))},g=i(!1),k=e=>{g.value=!0,l("PaymentAction",e)},j=u((()=>0==N(r.member,"is_family").model)),C=u((()=>!g.value&&!(!j.value&&!R.value))),S=e=>{E(e,f.value).then((e=>{if(e.data.status)F.success("Sign Success");else for(var t in F.error(e.data.mensaje),e.data.errores)e.data.errores[t].forEach((e=>{F.error(`${t} : ${e}`)}))})).catch((e=>{}))},w=e=>{if(n.value=1,f.value){const t={cash:e.cash,payment_type_id:n.value,total:r.total,cash_back:e.changeBack,membership_member_id:f.value};T(f.value,t).then((e=>{k(y.value),F.success("Success Payment")})).catch((e=>{console.log(e.response)}))}else F.error("The membership ID is required. Click on Process Membership to generate it automatically")},$=e=>{d.value=!0,z({payment_method:e,amount:r.total,user_id:y.value,membership_member_id:f.value,payment_type_id:3}).then((e=>{k(y.value),F.success("Success"),d.value=!1})).catch((e=>{for(var t in e.response.data.errores)e.response.data.errores[t].forEach((e=>{F.error(`${t}: ${e}`)}))}))};return(s,l)=>{const i=e,u=t,x=a,P=re,M=me,F=I,q=ve,A=O;return o(),m("div",be,[c("div",ye,[c("p",null,v(b(N)(r.member,"name").model)+" "+v(b(N)(r.member,"last_name").model),1),c("p",null,[c("small",null,v(b(j)?"Main member":"Family"),1)]),b(j)||b(R)?h("v-if",!0):(o(),m("p",fe,[he]))]),c(u,{size:"small",active:d.value},{default:p((()=>["create"==r.type?(o(),m(i,{key:0,color:"success",onClick:l[1]||(l[1]=e=>b(C)?(n.value=null,d.value=!0,y.value=null,f.value=null,B({member:r.member,contact:r.contact,membresia:r.membresia,total:r.total,categoriesMembers:r.categoriesMembers,notasInput:r.notasInput,presupuesto_id:r.presupuesto_id}).then((e=>{y.value=e.data.id,f.value=e.data.membership_members_id})).catch((e=>{})),void(d.value=!1)):null),style:b(C)?{}:{opacity:".5"}},{default:p((()=>[_e])),_:1},8,["style"])):(o(),m(i,{key:1,color:"success",onClick:_},{default:p((()=>[ge])),_:1}))])),_:1},8,["active"]),h(" <p>{{ paymentMethod }}</p> "),y.value&&!g.value?(o(),m("div",xe,[c(x,{color:"info",class:"mx-2 btn-card w-100 column is-4",style:1==n.value?{opacity:"0.4"}:{},onClick:l[2]||(l[2]=e=>n.value=3)},{default:p((()=>[c("div",ke,[je,3==n.value?(o(),m("p",Ce,[Se])):h("v-if",!0)])])),_:1},8,["style"]),c(P,{total:r.total,onOnPaymentCash:w},null,8,["total"])])):h("v-if",!0),c("div",we,[f.value&&g.value?(o(),m(M,{key:0,membership_member:f.value},null,8,["membership_member"])):h("v-if",!0)]),3!=n.value||g.value?h("v-if",!0):(o(),m(F,{key:1,"show-new-card":!1,memberid:y.value,onOnMethodPayment:$},null,8,["memberid"])),3!=n.value||g.value?h("v-if",!0):(o(),m(q,{key:2,amount:r.total,id:y.value,member_membership:f.value,onPaymentAction:l[3]||(l[3]=e=>k(y.value))},null,8,["amount","id","member_membership"])),g.value?(o(),m(x,{key:3,color:"success",class:"my-6"},{default:p((()=>[$e])),_:1})):h("v-if",!0),g.value?(o(),m(A,{key:4,onOnSign:S,"is-sign":!0,contract:`contract_${y.value}_${f.value}_${b(N)(r.member,"personal_identifications").model}.pdf`,"url-contract":`generateContract/${y.value}`},null,8,["contract","url-contract"])):h("v-if",!0)])}}});const Me={class:"table is-hoverable is-striped is-fullwidth"},Fe=c("thead",null,[c("tr",null,[c("th",{scope:"col"},"Membership Name"),c("th",{scope:"col"},"Plan"),c("th",{scope:"col"},"Quantity"),c("th",{scope:"col"},"Cost"),c("th",{scope:"col"},"Import")])],-1),Ne={class:"text-capitalize"},qe={style:{"text-align":"right"}},Ae={style:{"text-align":"right"}},Ie={style:{"text-align":"right"}},Ve=c("td",{colspan:"4",style:{"text-align":"right"}},[c("b",null,"Subtotal")],-1),Oe={key:0,style:{"text-align":"right"}},Re={colspan:"4"},Ee={key:0},Te={key:1},ze={style:{"text-align":"right"}},Be=c("td",{colspan:"4",style:{"text-align":"right"}},"Tax 7%",-1),De={style:{"text-align":"right"}},Ue=c("td",{colspan:"4",style:{"text-align":"right"}},[c("b",null,"Total to pay")],-1),Ge={key:1,style:{"text-align":"right"}},He=c("td",{colspan:"4",style:{"text-align":"right"}},"Recurring total",-1);var Le=n({expose:[],props:{presupuesto:{type:Object,required:!0}},setup:e=>(t,s)=>{const l=a;return e.presupuesto?(o(),m(l,{key:0,class:"mb-4"},{default:p((()=>[h(' <h1 @click="window.print()" class="title is-6">PRINT</h1> '),c("table",Me,[Fe,c("tbody",null,[(o(!0),m(d,null,f(e.presupuesto.membresias,((e,t)=>(o(),m("tr",{key:`membresia-${t}`},[c("td",null,v(e.description),1),c("td",Ne,v(e.type?e.type:"Initiation Fee"),1),c("td",null,v(e.quantity),1),c("td",qe,v(b(w)(e.amount_subtotal/e.quantity/100)),1),c("td",Ae,v(b(w)(e.amount_subtotal/100)),1)])))),128)),c("tr",Ie,[Ve,c("td",null,v(b(w)(e.presupuesto.totales.upfront.amount_subtotal/100)),1)]),e.presupuesto.discount?(o(),m("tr",Oe,[c("td",Re,[y(v(e.presupuesto.discount.name)+" ",1),"percentaje"==e.presupuesto.discount.type?(o(),m("span",Ee," ( "+v(e.presupuesto.discount.value)+"% off ) ",1)):(o(),m("span",Te," ( $"+v(e.presupuesto.discount.value)+" off ) ",1))]),c("td",null," - "+v(b(w)(e.presupuesto.totales.upfront.total_details.amount_discount/100)),1)])):h("v-if",!0),c("tr",ze,[Be,c("td",null,v(b(w)(e.presupuesto.totales.upfront.total_details.amount_tax/100)),1)]),c("tr",De,[Ue,c("td",null,v(b(w)(e.presupuesto.totales.upfront.amount_total/100)),1)]),e.presupuesto.totales.recurring?(o(),m("tr",Ge,[He,c("td",null,v(b(w)(e.presupuesto.totales.recurring.amount_total/100)),1)])):h("v-if",!0)])]),S(t.$slots,"default")])),_:3})):h("v-if",!0)}});export{re as _,Pe as a,Le as b};
