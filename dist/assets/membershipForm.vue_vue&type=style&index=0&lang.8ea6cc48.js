var e=Object.defineProperty,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,l=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,n=(e,n)=>{for(var i in n||(n={}))a.call(n,i)&&l(e,i,n[i]);if(s)for(var i of s(n))t.call(n,i)&&l(e,i,n[i]);return e};import{_ as i}from"./inputsLayaut.vue_vue&type=style&index=0&lang.9a5f1b2d.js";import{_ as o}from"./formLayaut.vue_vue&type=style&index=0&lang.e35c9b92.js";import{d as r,O as c,ad as p,b as u,w as d,r as m,i as f,j as v,F as b,k as h,l as y}from"./vendor.84e48f7c.js";import{i as g,s as j,f as _,c as O,d as E,b as w,n as A}from"./Memberships.107fc9b6.js";import{g as S}from"./Diciplines.37ccd2ec.js";import{a as $,g as x,p as L,h as k,n as P}from"./index.20ca533a.js";const D={class:"columns is-multiline"},q={class:"column is-12"},B={class:"column is-6"},F={class:"column is-6"},I={class:"column is-12"},M={class:"column is-12"};var z=r({expose:[],props:{type:{type:String,default:"create"},buttons:{type:Array,default:["save","back"]},isLoading:{type:Boolean,default:!1}},setup(e){const s=e,a=c(),t=p(),l=u((()=>"create"==s.type?{title:"Add a new membership",subtitle:"Add information for a new club membership"}:{title:"Edit membership",subtitle:"Edit information for a club membership"})),r=u((()=>g.find((e=>"locations_options"==e.name)))),z=u((()=>g.find((e=>"locations"==e.name))));d(z.value,(e=>{C(e)}));const C=e=>{let a=[];e.model.length>0&&(e.model.forEach((t=>{let l=e.values.find((e=>e.id==t));"create"==s.type&&a.push({name:"locationsSaleOrAccess",value:l.id,placeholder:l.name,values:[{placeholder:"Access",name:"access",model:["access"]},{placeholder:"Sale",name:"sale",model:["sale"]}]})})),$(g,"locations_options",a)),S(z.value.model).then((e=>{$(g,"diciplines",e.data),x(g,"diciplines").values.push({id:0,name:"All"})}))};u((()=>g.find((e=>"diciplines"==e.name))));const G=m(!1),H=()=>{G.value=!0;let e=n(n(n(n(n({},L(g)),L(O)),L(E)),L(A)),L(w)),l=[];"create"==s.type&&e.locations.length>0&&(e.locations.forEach((e=>{let s=r.value.values.find((s=>s.value==e));l.push({id:e,access:s.values.find((e=>"access"==e.name)).model.length?1:0,sale:s.values.find((e=>"sale"==e.name)).model.length?1:0})})),e.locations=l,delete e.locations_options),k.value||("create"==s.type?j(e).then((e=>{G.value=!1,t.back()})).catch((e=>{if(G.value=!1,"string"!=typeof e.response.data)for(var s in e.response.data)e.response.data[s].forEach((e=>{P.error(`${e}: ${s}`)}));else P.error(`${e.response.data}`)})):_(a.query.id,e).then((e=>{P.success("Success"),G.value=!1})).catch((e=>{if(G.value=!1,"string"!=typeof e.response.data)for(var s in e.response.data)e.response.data[s].forEach((e=>{P.error(`${e}: ${s}`)}));else P.error(`${e.response.data}`)})))};return(a,t)=>{const n=i,r=o;return f(),v(r,{buttons:s.buttons,titles:b(l),"is-loading":e.isLoading,"is-loader-active":G.value,onSaveData:H},{default:h((()=>[y("div",D,[y("div",q,[y(n,{"inputs-step":b(g)},null,8,["inputs-step"])]),y("div",B,[y(n,{"inputs-step":b(O)},null,8,["inputs-step"])]),y("div",F,[y(n,{"inputs-step":b(E)},null,8,["inputs-step"])]),y("div",I,[y(n,{"inputs-step":b(w)},null,8,["inputs-step"])]),y("div",M,[y(n,{"inputs-step":b(A)},null,8,["inputs-step"])])])])),_:1},8,["buttons","titles","is-loading","is-loader-active"])}}});export{z as _};
