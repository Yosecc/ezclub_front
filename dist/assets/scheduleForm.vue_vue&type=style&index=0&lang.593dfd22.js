import{_ as e}from"./V-Button.vue_vue&type=script&setup=true&lang.e4f3f19e.js";import{_ as a}from"./V-Card.vue_vue&type=script&setup=true&lang.e9093fe9.js";import{a as t,c as s,l as i,d as l,_ as n}from"./Companies.3e33daa5.js";import{_ as o}from"./formLayaut.vue_vue&type=style&index=0&lang.efe54a19.js";import{_ as d}from"./V-Avatar.vue_vue&type=script&setup=true&lang.119fc4d3.js";import{r,d as c,u,b as m,w as p,z as f,o as v,h as _,k as h,j as y,D as g,L as b,N as E,B as I,K as D,J as S,G as j}from"./vendor.685e53b0.js";import{s as w,i as q,j as x,n as Y,p as k,c as L}from"./ActivityPanel.vue_vue&type=style&index=0&lang.40a8aa29.js";import{A as M,a as A}from"./index.b0eaa1f3.js";import{g as $,d as C}from"./Diciplines.ba1311fb.js";import{h as N,t as O}from"./Staffs.be1966bc.js";import{h as H}from"./moment.08a7f518.js";r([]);const J=r([]),T=r([]),G=async e=>{const a=await M.get(`schedule?locations_id=${e}`);return T.value=a.data,a},B=r(),K=r([{typeInput:"selectDataActionChange",name:"discipline_id",placeholder:"Discipline",values:[""],model:"",required:!0,class:"is-6"},{typeInput:"checkboxGroupSimpleEventInput",name:"location_id",text:"Locations",values:[""],model:[],required:!0,class:"is-12"}]),V=r([{typeInput:"switchEventChangeInput",name:"mismoshorariostrainers",values:["","Mismos horarios para todos los trainers seleccionados"],model:!1,required:!0,class:"is-6",click:function(){},change:function(){}}]);r([{typeInput:"switchEventChangeInput",name:"mismoshorariosdias",values:["","Mismos horarios para todos los dias"],model:!0,required:!0,class:"is-6",click:function(){},change:function(){}}]);const F=r([{typeInput:"switchEventChangeInput",name:"mismasfechas",values:["","Mismas fechas para todas las locaciones"],model:!0,required:!0,class:"is-12",click:function(){},change:function(){}}]),P=[{typeInput:"date",name:"start_date",placeholder:"Start Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"start_time",placeholder:"Start Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"date",name:"end_date",placeholder:"end Date",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"time",name:"end_time",placeholder:"end Time",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"number",name:"capacity",placeholder:"Capacity people num",values:null,model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"type_of_member",placeholder:"Type of Member",values:["Adults Only","Kids Only","Adult & Kids"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"select",name:"level",placeholder:"Level",values:["All Levels","Pro","Expert","Medium","Beginner"],model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"color",name:"color",placeholder:"Color",model:"",required:!0,class:"is-3",isLabel:!0},{typeInput:"switchEventChangeInput",name:"is_recurrence",placeholder:"Recurrence",values:["","Recurrence"],model:!1,required:!0,class:"is-3",isLabel:!0,change:function(){}},{typeInput:"checkboxGroupSimpleEventInput",name:"recurrence",text:"Dias de la semana",default:[1,2,3,4,5,6,0],values:[{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"},{id:0,name:"Sunday"},{id:"All",name:"All"}],model:[],required:!0,disabled:!0,class:"is-12",click:function(){},change:function(){}}],R=r([{typeInput:"checkboxGroupSimpleEventInput",name:"trainers_id",text:"Trainers",values:[""],model:[],required:!0,class:"is-12"}]),W=r(null),z={class:"d-flex justify-content-between"},U=j(" DELETE"),Q=h("h3",{class:"title is-5 mb-2"},"Warning Edit",-1),X={class:"d-flex align-items-center"},Z={class:"ml-3 title is-6"};var ee=c({expose:[],props:{type:{type:String,default:"create"},buttons:{type:Array,default:["save"]},step:{type:Number,default:1},selectInfoData:{type:Object,default:null},idEvent:{type:Number,default:null}},emits:["addEvent","deleteEvent"],setup(c,{emit:j}){const T=c;I();const{cookies:G}=u(),ee=m((()=>"create"==T.type?{title:"Add a new schedule",subtitle:"Add information for a new schedule"}:{title:"Edit schedule",subtitle:"Edit information for a schedule"}));p((()=>T.idEvent),(()=>{"edit"==T.type&&(J.value=[],L(K.value),(async e=>{const a=await M.get(`schedule/${e}/edit`);return B.value=a.data,a})(T.idEvent).then((e=>{q(K.value,"location_id").model.push(B.value.locations_id),q(K.value,"discipline_id").model=B.value.class.dicipline_id,se(B.value.locations_id)})).catch((e=>{console.log(e.response.status),404==e.response.status&&console.log(T.idEvent)})))})),p((()=>l.value),(()=>{w(K,"location_id",l.value)})),p((()=>T.selectInfoData),(()=>{J.value=[],L(K.value),null!=G.get("locations_id")&&(q(K.value,"location_id").model.push(parseFloat(G.get("locations_id"))),se(G.get("locations_id")))}));const ae=function(e){"object"==typeof e&&(e=this.model),se(e)};p((()=>q(i.value,"locations_id").model),(e=>{se(e)})),f((()=>{t().then((e=>{w(i,"locations_id",s.value.locations),q(i.value,"locations_id").change=ae,null!=G.get("locations_id")&&(q(i.value,"locations_id").model=G.get("locations_id"),ae(G.get("locations_id")))})),$().then((e=>{w(K,"discipline_id",C.value)})),q(K.value,"location_id").change=se,q(K.value,"location_id").click=function(){},q(F.value,"mismasfechas").change=function(){q(F.value,"mismasfechas").model||le()},N().then((e=>{w(R,"trainers_id",O.value)}))}));const te=function(e,a){x([this],"trainers_id").forEach((a=>{null==J.value.find((e=>e.locations_id==this.locations_id)).trainers.find((e=>e.staffs_id==a.id))?J.value.find((e=>e.locations_id==this.locations_id)).trainers.push({locations_id:this.locations_id,staffs_id:a.id,name:a.name}):a.id==e.target.value&&J.value.find((e=>e.locations_id==this.locations_id)).trainers.splice(J.value.find((e=>e.locations_id==this.locations_id)).trainers.findIndex((e=>e.staffs_id==a.id)),1)}))};p((()=>q(F.value,"mismasfechas").model),(()=>{q(F.value,"mismasfechas").model&&le()}));const se=function(e,a){let t=null;t="object"==typeof e?e.target.value:e,x(K.value,"location_id").forEach((e=>{if(null==J.value.find((a=>a.locations_id==e.id))){q(V.value,"mismoshorariostrainers").change=ne,q(V.value,"mismoshorariostrainers").locations_id=e.id;let a=r(JSON.parse(JSON.stringify(P))).value;if(T.selectInfoData&&(q(a,"start_date").model=H(T.selectInfoData.start).format("YYYY-MM-DD"),q(a,"start_time").model=H(T.selectInfoData.start).format("HH:mm:ss"),q(a,"end_date").model=H(T.selectInfoData.end).format("YYYY-MM-DD"),q(a,"end_time").model=H(T.selectInfoData.end).format("HH:mm:ss")),"edit"==T.type){if(null==B.value)return Y.error("Error Desconocido"),void window.location.reload();q(a,"start_date").model=H(B.value.start_date).format("YYYY-MM-DD"),q(a,"start_time").model=H(B.value.start_date).format("HH:mm:ss"),q(a,"end_date").model=H(B.value.end_date).format("YYYY-MM-DD"),q(a,"end_time").model=H(B.value.end_date).format("HH:mm:ss"),q(a,"capacity").model=B.value.capacity,q(a,"color").model=B.value.color,B.value.recurrence.length>0&&(q(a,"is_recurrence").model=!0,q(a,"recurrence").model=B.value.recurrence,q(a,"recurrence").disabled=!1),q(a,"type_of_member").model=B.value.type_of_member,q(a,"level").model=B.value.level}q(a,"start_date").change=ie,q(a,"end_date").change=ie,q(a,"capacity").change=ie,q(a,"end_time").change=ie,q(a,"start_time").change=ie,q(a,"is_recurrence").change=function(){q(a,"recurrence").disabled=this.model},q(a,"recurrence").click=function(){},q(a,"recurrence").change=function(){this.model.includes("All")&&(this.model=this.default)};let t=r(JSON.parse(JSON.stringify(R.value[0]))).value;t.change=te,t.click=function(){},t.locations_id=e.id,"edit"==T.type&&B.value.trainers.forEach((e=>{t.model.push(e.staffs_id)})),a.push(t),J.value.push({locations_id:e.id,name:e.name,start_date:q(a,"start_date"),start_time:q(a,"start_time"),end_date:q(a,"end_date"),end_time:q(a,"end_time"),capacity:q(a,"capacity"),recurrence:q(a,"recurrence"),inputsfechas:a,type_of_member:q(a,"type_of_member"),level:q(a,"level"),color:q(a,"color"),trainers:[]})}else e.id==t&&J.value.splice(J.value.findIndex((a=>a.locations_id==e.id)),1)}))},ie=function(){q(F.value,"mismasfechas").model&&le()},le=function(){let e=J.value.find((e=>e.locations_id==x(K.value,"location_id")[0].id));J.value.filter((e=>e.locations_id!=x(K.value,"location_id")[0].id)).forEach((a=>{q(a.inputsfechas,"start_date").model=q(e.inputsfechas,"start_date").model,q(a.inputsfechas,"end_date").model=q(e.inputsfechas,"end_date").model,q(a.inputsfechas,"end_time").model=q(e.inputsfechas,"end_time").model,q(a.inputsfechas,"start_time").model=q(e.inputsfechas,"start_time").model,q(a.inputsfechas,"capacity").model=q(e.inputsfechas,"capacity").model,q(a.inputsfechas,"color").model=q(e.inputsfechas,"color").model,q(a.inputsfechas,"type_of_member").model=q(e.inputsfechas,"type_of_member").model,q(a.inputsfechas,"level").model=q(e.inputsfechas,"level").model,q(a.inputsfechas,"recurrence").model=q(e.inputsfechas,"recurrence").model}))},ne=function(e){let a=null,t=null;"number"==typeof e?(t=e,a=q(V.value,"mismoshorariostrainers").model):(t=this.locations_id,a=!q(V.value,"mismoshorariostrainers").model);let s=J.value.find((e=>e.locations_id==t)),i=s.trainers[0],l=q(i.inputsDias,"semana").model,n=s.trainers.filter((e=>e.staffs_id!=i.staffs_id)),o=null;n.forEach((e=>{o=r(JSON.parse(JSON.stringify(e.days))),a?(q(e.inputsDias,"semana").model=l,e.days=i.days):(q(e.inputsDias,"semana").model=q(e.inputsDias,"semana").default,e.days=o)}))},oe=()=>{const e=k(K.value).discipline_id,a=k(K.value).location_id;let t=[];a.forEach((e=>{let a=J.value.find((a=>a.locations_id==e)),s=[];a.trainers.forEach((e=>{s.push({staffs_id:e.staffs_id})})),t.push({locations_id:a.locations_id,start_date:a.start_date.model+" "+a.start_time.model,end_date:a.end_date.model+" "+a.end_time.model,capacity:a.capacity.model,recurrence:JSON.stringify(a.recurrence.model),type_of_member:a.type_of_member.model,level:a.level.model,color:a.color.model,trainers:s})})),W.value={dicipline_id:e,status:!0,locations:t},"create"==T.type?(async e=>await M.post("schedule",e))(W.value).then((e=>{Y.success("Save Success"),e.data.forEach((e=>{j("addEvent",e),J.value=[],L(K.value)}))})).catch((e=>{for(var a in e.response.data.errores)e.response.data.errores[a].forEach((e=>{Y.error(`${a} ${e}`)}))})):(async(e,a)=>{const t=await M.put(`schedule/${e}`,a);return B.value=t.data,t})(B.value.id,W.value).then((e=>{Y.success("Success Update"),e.data.forEach((e=>{j("addEvent",e),J.value=[],L(K.value)}))})).catch((e=>{for(var a in e.response.data.errores)e.response.data.errores[a].forEach((e=>{Y.error(`${a} ${e}`)}))}))},de=()=>{const e=B.value.id;(async e=>await M.delete(`schedule/${e}`))(e).then((e=>{j("deleteEvent",B.value.id),J.value=[],L(K.value)})).catch((a=>{404==a.response.status&&(console.log("props.idEvent",e),j("deleteEvent",e))}))};return(t,s)=>{const i=e,l=a,r=n,c=o,u=d;return v(),_(b,null,[h(c,{buttons:T.buttons,step:T.step,titles:g(ee),class:"mb-2",onSaveData:oe,color:"warning"},{default:y((()=>["create"!=T.type?(v(),_(l,{key:0,color:"warning"},{default:y((()=>[h("div",z,[h(i,{onClick:de,icon:"fa fa-times",color:"danger",elevated:""},{default:y((()=>[U])),_:1}),Q])])),_:1})):D("",!0),h(r,{"inputs-step":g(K)},null,8,["inputs-step"])])),_:1},8,["buttons","step","titles"]),(v(!0),_(b,null,E(g(J),((e,a)=>(v(),_(l,{key:`location-${a}`,class:"mb-4"},{default:y((()=>[h("div",X,[h(u,{picture:`${g(A)}storage/${e.image}`},null,8,["picture"]),h("h1",Z,S(e.name),1)]),h(r,{"inputs-step":g(F)},null,8,["inputs-step"]),h(r,{"inputs-step":e.inputsfechas},null,8,["inputs-step"])])),_:2},1024)))),128))],64)}}});export{ee as _,G as g};
